<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Compressible Euler Equations &mdash; Theoretical Physics Reference v0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Theoretical Physics Reference v0.1 documentation" href="../../index.html" />
    <link rel="up" title="Fluid Dynamics" href="main.html" />
    <link rel="next" title="Quantum Field Theory and Quantum Mechanics" href="../quantum/main.html" />
    <link rel="prev" title="MHD Equations" href="mhd.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../quantum/main.html" title="Quantum Field Theory and Quantum Mechanics"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mhd.html" title="MHD Equations"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Theoretical Physics Reference v0.1 documentation</a> &raquo;</li>
          <li><a href="main.html" accesskey="U">Fluid Dynamics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="index-0"></span><div class="section" id="compressible-euler-equations">
<h1>Compressible Euler Equations<a class="headerlink" href="#compressible-euler-equations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The compressible Euler equations are equations for perfect fluid.
Perfect fluids have no heat conduction (<img class="math" src="../../_images/math/9fdef3ebe8c96dbe81bc688352b54bd598e04fb2.png" alt="T^{i0} = T^{0i} = 0"/>) and no
viscosity (<img class="math" src="../../_images/math/a85470ac36bf63d0d0a95c0f06bb1da24fb8cd9e.png" alt="T^{ij} = p\one"/>), so in the comoving frame the stress energy tensor
is:</p>
<div class="math">
<p><img src="../../_images/math/cf9bcf31176c79bcc8b6ed61a808b758fccc929b.png" alt="T^{\alpha\beta} = \diag(\rho c^2, p, p, p) =
\left(\rho+{p\over c^2}\right)u^\alpha u^\beta + p g^{\alpha\beta}" /></p>
</div><p>(we use <img class="math" src="../../_images/math/1d90982367d8bb46f3556a064f578d0c7cf68966.png" alt="g^{\mu\nu} = \diag(-1, 1, 1, 1)"/>). Relativistic Euler equations are
given by the conservation of the stress energy tensor and the particle number
conservation:</p>
<div class="math">
<p><img src="../../_images/math/1d2e4bb447ab5f65677ef0420617acf3b9b622cb.png" alt="\partial_\nu T^{\mu\nu} = 0

\partial_\mu(nu^\mu) = 0" /></p>
</div><p>By doing the nonrelativistic limit (see <a class="reference external" href="general.html#perfect-fluids"><em>Perfect Fluids</em></a> for a detailed
derivation), we get the following Euler equations:</p>
<div class="math">
<p><img src="../../_images/math/d69b9c659b0cdbefd421e8c361b30d80a78df9fa.png" alt="{\partial\rho\over\partial t} + \nabla\cdot(\rho{\bf u}) = 0

{\partial(\rho{\bf u})\over\partial t} + \nabla\cdot(\rho{\bf u}{\bf u}^T)
    + \nabla p - {\bf f} = 0

{\partial E\over\partial t} + \nabla\cdot({\bf u}(E+p)) = 0" /></p>
</div><p>where</p>
<div class="math">
<p><img src="../../_images/math/1d4a88147849c8ecec3d242d4936a262f9a07e85.png" alt="E = \rho e + \half \rho u^2" /></p>
</div><p>is the total energy per unit volume, composed of the kinetic energy per unit
volume (<img class="math" src="../../_images/math/f8ad6e28ee44455107fd5b1fed09336bef89c843.png" alt="\half \rho u^2"/>) and the internal energy per unit volume (<img class="math" src="../../_images/math/3266e9fbba69cf6f58fdc0025852e3eb26e7f056.png" alt="\rho e"/>),
where <img class="math" src="../../_images/math/a3a59bb1293ee3f6dec19de4019a7178874219ae.png" alt="e"/> is the internal energy per unit mass (<img class="math" src="../../_images/math/6fa3044d505bf62a6173112f964b9723d2d8a0a2.png" alt="e={U\over nM}"/>). The energy
<img class="math" src="../../_images/math/fa2fa899f0afb05d6837885523503a2d4df434f9.png" alt="E"/> doesn&#8217;t contain the rest mass energy, but all other energies are hidden in
the internal energy.</p>
<p>We use the
ideal gas equations, so:</p>
<div class="math">
<p><img src="../../_images/math/01d4141f5e4d6834a69915c7869c4c630d579098.png" alt="e = T c_v

p = {n\over V} \bar RT =
{n M\over V} {\bar R\over M}T =
\rho RT = \rho R {e\over c_v} =
    {R\over c_v} (E-\half \rho u^2)" /></p>
</div><p>where
<img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/> is the number of moles of gas,
<img class="math" src="../../_images/math/5d1e4485dc90c450e8c76826516c1b2ccb8fce16.png" alt="M"/> is the molar mass of the gas (i.e. a mass of one mole of the gas, e.g. for
dry air we get <img class="math" src="../../_images/math/acfe7e7adc55536d7378c1c937167527363013ba.png" alt="M=28.956\rm\,g/mol"/>, as it is mainly composed of 20% of oxygen
with atomic mass 16 and 78% of nitrogen with atomic mass <img class="math" src="../../_images/math/820a20de2847dfdc1bc5cffc8d904933150032bd.png" alt="14"/>, both form
diatomic molecules, so the molecular mass is twice the atomic mass
giving the total of <img class="math" src="../../_images/math/1b8e4ff49812494e41ff1d302c574a282eadfe91.png" alt="0.2\cdot2\cdot16+0.78\cdot2\cdot14 = 28.24"/>, the rest is
given by the other components and one also has to average over all isotopes),
<img class="math" src="../../_images/math/802d91184522bb9c75169bd8b19458edb9700ca1.png" alt="\bar R=N_A k_B\doteq8.3145\rm\,{J\over K\, mol}"/> is the ideal gas constant
(<img class="math" src="../../_images/math/05f91f30ed1f9b369d5d43b8d6d682567c18459b.png" alt="N_A"/> is the Avogadro constant and <img class="math" src="../../_images/math/8ea5849a7b9b2cefcb791dbea7983bea372995d1.png" alt="k_B"/> is the Boltzmann constant),
<img class="math" src="../../_images/math/9b9121ebb1fdd07af1274d199583f2c0e80b81be.png" alt="R={\bar R\over M}"/> is the specific ideal gas constant (e.g. for dry air we get
<img class="math" src="../../_images/math/854b038c464865aec42ff91749fd9526c8ab1d52.png" alt="R = {8.3145\over 28.956}\rm\,{J\over g\,K}\doteq 287.14\rm\,{J\over kg\,K}"/>),
<img class="math" src="../../_images/math/5619e7fd47503bef49fa30cb3f1ce8cdca16e63b.png" alt="\rho={n M\over V}={p\over RT}"/> is the density of the gas (e.g. for dry air at
the pressure <img class="math" src="../../_images/math/77c9cef599eb3a95449aae83b570663d07454841.png" alt="10^5\rm\,Pa"/> and temperature <img class="math" src="../../_images/math/9b84279901fdd5758d3fb3686ae190fedd7056b9.png" alt="22\rm\,^\circ C"/> we get
<img class="math" src="../../_images/math/31e284b5fc1e4f1c8200cf02bb1861c16180c168.png" alt="\rho = {10^5\over 287.14 \cdot (22+273.15)}\rm\,{kg\over m^3}
=1.18\,{kg\over m^3}"/>),
<img class="math" src="../../_images/math/2f3f2daddf38c751bff3c7b6040d1beb8bde6178.png" alt="c_v"/> is the specific heat capacity at constant volume (i.e. the amount of
energy needed to heat one kg by one Kelvin at constant volume, e.g. for dry air
the experimental value is about <img class="math" src="../../_images/math/5a7856bf4c23056758b0b458bc65a43632fb98a8.png" alt="c_v = 717.5\rm\,{J\over kg\,K}"/>),
<img class="math" src="../../_images/math/12d58aa29201da09d8e620f8698e3a37547f6b4a.png" alt="V"/> is the volume
and <img class="math" src="../../_images/math/2554b6496c3b678897e9b060ef00aa9f0a7d7ece.png" alt="T"/> is the temperature of the gas.
Of those, <img class="math" src="../../_images/math/12d58aa29201da09d8e620f8698e3a37547f6b4a.png" alt="V"/>, <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>, <img class="math" src="../../_images/math/5d1e4485dc90c450e8c76826516c1b2ccb8fce16.png" alt="M"/>, <img class="math" src="../../_images/math/eff43e84f8a3bcf7b6965f0a3248bc4d3a9d0cd4.png" alt="R"/>, <img class="math" src="../../_images/math/22344a41e47985033825ea337522a64e707f85ef.png" alt="\bar R"/> are constants, <img class="math" src="../../_images/math/0027034d8a10372a06deaf4f4084c01956587479.png" alt="\rho"/>, <img class="math" src="../../_images/math/a3a59bb1293ee3f6dec19de4019a7178874219ae.png" alt="e"/>, <img class="math" src="../../_images/math/fa2fa899f0afb05d6837885523503a2d4df434f9.png" alt="E"/> and <img class="math" src="../../_images/math/2554b6496c3b678897e9b060ef00aa9f0a7d7ece.png" alt="T"/> are
functions of <img class="math" src="../../_images/math/7bff5231ba7fa776f904320431eabfc7a8253860.png" alt="(t, x, y, z)"/>.</p>
<p>Here are the SI units of the various terms in the Euler equations:</p>
<div class="math">
<p><img src="../../_images/math/f8c5a594a05afc194a4ae8eb11e77f910d90cb52.png" alt="[u] = \rm m\,s^{-1}

[\rho] = \rm kg\,m^{-3}

\rm N = kg \, m \, s^{-2}

\rm J = N\, m = kg \, m^2 \, s^{-2}

[p] = \rm N\, m^{-2} = kg\, m^{-1}\,s^{-2}

[\half \rho u^2] = [\rho][u]^2 = \rm kg\,m^{-3}\,m^2\,s^{-2} = kg\, m^{-1}\,s^{-2}

[E] = \rm J\,m^{-3} = kg\, m^{-1}\,s^{-2}

[R] = \rm J\,kg^{-1}\,K^{-1} = m^2\,s^{-2}\,K^{-1}

[c_v] = \rm J\,kg^{-1}\,K^{-1} = m^2\,s^{-2}\,K^{-1}

[e] = {[E]\over[\rho]} = \rm {kg\,m^{-1}\,s^{-2}\over kg\,m^{-3}} =
    m^2\,s^{-2}" /></p>
</div><p>In order to calculate the specific heat ratio <img class="math" src="../../_images/math/da61bb0fa48fe71269aebf9c8e56b39275813994.png" alt="\kappa"/>, we use <img class="math" src="../../_images/math/121ea9b1d87f0d15d038734cd02544b89c89e297.png" alt="R=c_p-c_v"/>:</p>
<div class="math">
<p><img src="../../_images/math/aed828229d8431648565af4f44511d94fa01958f.png" alt="\kappa = {c_p\over c_v} = {c_v+R\over c_v} = 1 + {R\over c_v}" /></p>
</div><p>and the speed of sound is:</p>
<div class="math">
<p><img src="../../_images/math/d17a24a1599f3742da700b66fa85deb21ffb3f57.png" alt="c = \sqrt{\kappa {p \over \rho}}" /></p>
</div></div>
<div class="section" id="dimensionless-euler-equations">
<h2>Dimensionless Euler Equations<a class="headerlink" href="#dimensionless-euler-equations" title="Permalink to this headline">¶</a></h2>
<p>We choose 3 constants <img class="math" src="../../_images/math/9fbaf37cdf312a79feacdd0d22f1424ed81248d8.png" alt="l_r"/>, <img class="math" src="../../_images/math/59ca6d8c556ddbab115d04ad997cc7ded5fa478c.png" alt="u_r"/> and <img class="math" src="../../_images/math/108c8543e4b443a0d96fa829fe99d46ef44cef53.png" alt="\rho_r"/> - characteristic length of the
domain, velocity and density. Now we multiply the Euler equations with proper
combinations of these constants as follows:</p>
<div class="math">
<p><img src="../../_images/math/d4df14877602100161929030f93c71856f41cf6e.png" alt="\left[{\partial\rho\over\partial t} + \nabla\cdot(\rho{\bf u})\right]
{l_r\over\rho_r u_r}
= 0

\left[{\partial(\rho{\bf u})\over\partial t} + \nabla\cdot(\rho{\bf u}{\bf u}^T)
    + \nabla p - {\bf f}\right]
{l_r\over\rho_r u_r^2}
= 0

\left[{\partial E\over\partial t} + \nabla\cdot({\bf u}(E+p))\right]
{l_r\over\rho_r u_r^3}
= 0" /></p>
</div><p>This is equal to:</p>
<div class="math">
<p><img src="../../_images/math/1b7391c22906d326139ce0412b309b4778d3bb0b.png" alt="{\partial\tilde\rho\over\partial \tilde t} + \tilde\nabla\cdot(\tilde\rho
\tilde{\bf u}) = 0

{\partial(\tilde \rho\tilde{\bf u})\over\partial \tilde t} +
    \tilde\nabla\cdot(\tilde\rho\tilde{\bf u}\tilde{\bf u}^T)
    + \tilde\nabla\tilde p - \tilde{\bf f} = 0

{\partial\tilde E\over\partial\tilde t} + \tilde\nabla\cdot(
\tilde{\bf u}(\tilde E+\tilde p)) = 0" /></p>
</div><p>where:</p>
<div class="math">
<p><img src="../../_images/math/2c1160ce117720f7968f8bed24275c443c4063d3.png" alt="t_r = {l_r\over u_r}

\tilde t = {t\over t_r}

\tilde \rho = {\rho\over\rho_r}

\tilde{\bf u} = {{\bf u}\over u_r}

\tilde\nabla = l_r\nabla

\tilde E = {E\over \rho_r u^2_r}

\tilde p = {p\over \rho_r u^2_r}

\tilde {\bf f} = {\bf f}{l_r\over\rho_r u^2_r}" /></p>
</div><p>In particular, if <img class="math" src="../../_images/math/732af79eefc078ee68704a18a7ececdfab120dc1.png" alt="{\bf f}=(0, 0, -\rho g)"/>, then</p>
<div class="math">
<p><img src="../../_images/math/87770216979ff0e800d28c56d938a17760353409.png" alt="\tilde{\bf f}=(0, 0, -\tilde\rho \tilde g)

\tilde g = g{l_r\over u^2_r} = g{t_r^2\over l_r}" /></p>
</div><p>So the dimensionless Euler equations look exactly the same as the original
ones, we just need to rescale all the quantities using the relations above.</p>
</div>
<div class="section" id="conservative-form-of-the-euler-equations">
<h2>Conservative Form of the Euler Equations<a class="headerlink" href="#conservative-form-of-the-euler-equations" title="Permalink to this headline">¶</a></h2>
<p>We can write the Euler equations as:</p>
<div class="math">
<p><img src="../../_images/math/64496c86e0a6387b7128880337db87b8d33c3019.png" alt="{\partial{\bf w}\over \partial t} +
{\partial{\bf f}_x\over \partial x} +
{\partial{\bf f}_y\over \partial y} +
{\partial{\bf f}_z\over \partial z} +
{\bf g}= 0" /></p>
</div><p>where:</p>
<div class="math">
<p><img src="../../_images/math/fab0c3c35cd4edb24a98ee3d4f2dd9adc1c38c8b.png" alt="{\bf w} =
   \left( \begin{array}{c}
       \varrho\\ \rho u_1\\ \rho u_2\\ \rho u_3\\ E
   \end{array} \right)
   =
   \left( \begin{array}{c}
       w_0 \\
       w_1 \\
       w_2 \\
       w_3 \\
       w_4 \\
   \end{array} \right)

{\bf f}_x =
   \left( \begin{array}{c}
       \rho u_1\\
       \rho u_1^2 + p\\
       \rho u_1 u_2\\
       \rho u_1 u_3\\
       u_1(E+p)
   \end{array} \right)
   =
   \left( \begin{array}{c}
       w_1\\
       \frac{w_1^2}{w_0} + p\\
       \frac{w_1w_2}{w_0}\\
       \frac{w_1w_3}{w_0}\\
       \frac{w_1}{w_0}(w_4+p)
   \end{array} \right)

{\bf f}_y =
   \left( \begin{array}{c}
       \rho u_2\\
       \rho u_2 u_1\\
       \rho u_2^2 + p\\
       \rho u_2 u_3\\
       u_2(E+p)
   \end{array} \right)
   =
   \left( \begin{array}{c}
       w_2\\
       \frac{w_2w_1}{w_0}\\
       \frac{w_2^2}{w_0} + p\\
       \frac{w_2w_3}{w_0}\\
       \frac{w_2}{w_0}(w_4+p)
   \end{array} \right)

{\bf f}_z =
   \left( \begin{array}{c}
       \rho u_3\\
       \rho u_3 u_1\\
       \rho u_3 u_2\\
       \rho u_3^2 + p\\
       u_3(E+p)
   \end{array} \right)
   =
   \left( \begin{array}{c}
       w_3\\
       \frac{w_3w_1}{w_0}\\
       \frac{w_3w_2}{w_0}\\
       \frac{w_3^2}{w_0} + p\\
       \frac{w_3}{w_0}(w_4+p)
   \end{array} \right)

{\bf g} =
   \left( \begin{array}{c}
       0\\
       -f_x\\
       -f_y\\
       -f_z\\
       0\\
   \end{array} \right)

p = {R\over c_v} \left(E-\half \rho\left(u_1^2 + u_2^2 + u_3^3\right)\right)
= {R\over c_v} \left(w_4-{w_1^2+w_2^2+w_3^2\over2w_0}\right)" /></p>
</div><p>We solve for the unknowns <img class="math" src="../../_images/math/eb37b8f84b267a3318413dcd963c9a5872051634.png" alt="w_0"/>, <img class="math" src="../../_images/math/3c352e9db5a7134ca93f9fecce8fe99b0d4e5889.png" alt="w_1"/>, <img class="math" src="../../_images/math/0ce0501dff8a93818a4e5d9ecc570d8ab6472e5b.png" alt="w_2"/>, <img class="math" src="../../_images/math/fae1e827dd08b4d5f16edf752cce814e62a106b4.png" alt="w_3"/> and <img class="math" src="../../_images/math/7f2f75262e3b0f6d95c24064c98fe6e02ce5b265.png" alt="w_4"/> as functions of
<img class="math" src="../../_images/math/7bff5231ba7fa776f904320431eabfc7a8253860.png" alt="(t, x, y, z)"/>, the rest (<img class="math" src="../../_images/math/eff43e84f8a3bcf7b6965f0a3248bc4d3a9d0cd4.png" alt="R"/>, <img class="math" src="../../_images/math/2f3f2daddf38c751bff3c7b6040d1beb8bde6178.png" alt="c_v"/>, <img class="math" src="../../_images/math/77e2657b57cae321de481018d6dc74dd9920abc6.png" alt="f_x"/>, <img class="math" src="../../_images/math/f4e24d769d1159c51257a0aef9390c2ef290a2c6.png" alt="f_y"/>, <img class="math" src="../../_images/math/dbbdd66231f90d86cd4154819a47260c378b7ebe.png" alt="f_z"/>) are either constants
or depend on the unknowns. In order to convert from the physical quantities
<img class="math" src="../../_images/math/0027034d8a10372a06deaf4f4084c01956587479.png" alt="\rho"/>, <img class="math" src="../../_images/math/0559ffc8c62a08ff533f3fcd1a5c1713a520755d.png" alt="u_1"/>, <img class="math" src="../../_images/math/0725e2d5475070ba690e43acfb1adb66de9051fc.png" alt="u_2"/>, <img class="math" src="../../_images/math/b030cd493cf47cb7ba11af2031b2dbd94459e8f8.png" alt="u_3"/>, <img class="math" src="../../_images/math/fa2fa899f0afb05d6837885523503a2d4df434f9.png" alt="E"/> and <img class="math" src="../../_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/> to <img class="math" src="../../_images/math/eb37b8f84b267a3318413dcd963c9a5872051634.png" alt="w_0"/>, ..., <img class="math" src="../../_images/math/7f2f75262e3b0f6d95c24064c98fe6e02ce5b265.png" alt="w_4"/>, we use:</p>
<div class="math">
<p><img src="../../_images/math/b3ee266676118ea74512906217f65582740e0186.png" alt="w_0 = \rho

w_1 = \rho u_1

w_2 = \rho u_2

w_3 = \rho u_3

w_4 = E = p {c_v \over R} + \half \rho \left(u_1^2 + u_2^2 + u_3^2\right)" /></p>
</div><p>the opposite conversion is:</p>
<div class="math">
<p><img src="../../_images/math/6004291841fff169f1f2bead7379d0da1d09040f.png" alt="\rho = w_0

u_1 = {w_1\over w_0}

u_2 = {w_2\over w_0}

u_3 = {w_3\over w_0}

E = w_4

p = {R\over c_v} \left(w_4-{w_1^2+w_2^2+w_3^2\over2w_0}\right)" /></p>
</div><p>Sometimes people also use <img class="math" src="../../_images/math/9ad99798ec4c38e165cf517cb9e02b1c9e824103.png" alt="u"/>, <img class="math" src="../../_images/math/a9f23bf124b6b2b2a993eb313c72e678664ac74a.png" alt="v"/> and <img class="math" src="../../_images/math/9ee4b825a2e36ae093ed7be5e4851ef453b34914.png" alt="w"/> instead of <img class="math" src="../../_images/math/0559ffc8c62a08ff533f3fcd1a5c1713a520755d.png" alt="u_1"/>, <img class="math" src="../../_images/math/0725e2d5475070ba690e43acfb1adb66de9051fc.png" alt="u_2"/> and <img class="math" src="../../_images/math/b030cd493cf47cb7ba11af2031b2dbd94459e8f8.png" alt="u_3"/>.</p>
<p>Note: <img class="math" src="../../_images/math/e3007122968932795480d9e021764aae578a5721.png" alt="\rho {\bf u}\equiv{\bf j}"/>, where <img class="math" src="../../_images/math/2f03ee335cd302ac22c46cb21d5f9c5ddaf9090b.png" alt="{\bf j}"/> is the fluid density current
(it&#8217;s a 3-vector) and also <img class="math" src="../../_images/math/a18ae5344d251543ce240b4553702821b8f7031b.png" alt="w^\mu \equiv j^\mu"/> (here <img class="math" src="../../_images/math/9fbf92107df2b38bd92147dfa4610a1ca3226b82.png" alt="w^\mu"/> is the same as
<img class="math" src="../../_images/math/98bf8a59ca1556a6af9b5bd2a1a447dc7246a133.png" alt="w_\mu"/>, e.g. we are a bit sloppy about the notation), where <img class="math" src="../../_images/math/2ce8c0411ae2c21e0a52190831491721e983a2ab.png" alt="j^\mu"/> is the
density 4-current (e.g. the first 4 components of <img class="math" src="../../_images/math/617e8d9a63e644648e5c0ea450662ac513a01982.png" alt="{\bf w}"/> are exactly the
components of the 4-current <img class="math" src="../../_images/math/2ce8c0411ae2c21e0a52190831491721e983a2ab.png" alt="j^\mu"/>):</p>
<div class="math">
<p><img src="../../_images/math/7d2818944a8ebb6705c28d019819b59bea0f5b96.png" alt="j^\mu =\rho v^\mu = \rho\gamma (c, {\bf u}) =
    \gamma
    \left( \begin{array}{c}
        c\rho\\
        \rho u_1\\
        \rho u_2\\
        \rho u_3\\
    \end{array} \right)" /></p>
</div><p>where as usual <img class="math" src="../../_images/math/fe5def4fb1a4e54a22615dfe561df616755674f6.png" alt="\mu = 0, 1, 2, 3"/> is the relativistic index, <img class="math" src="../../_images/math/3372c1cb6d68cf97c2d231acc0b47b95a9ed04cc.png" alt="c"/> is the speed
of light, and in the nonrelativistic limit (<img class="math" src="../../_images/math/5aed179f587c3ac274cb5c3135b4ec6a8a3e9c80.png" alt="c\to\infty"/>) we get <img class="math" src="../../_images/math/fd87634f51bf39f0d58a4f4fad4b06811548d530.png" alt="\gamma\to1"/>
and the remaining <img class="math" src="../../_images/math/3372c1cb6d68cf97c2d231acc0b47b95a9ed04cc.png" alt="c"/> in <img class="math" src="../../_images/math/4b661724ec110c6979e057a96abf606de0f21a22.png" alt="j^0"/> will cancel with <img class="math" src="../../_images/math/3372c1cb6d68cf97c2d231acc0b47b95a9ed04cc.png" alt="c"/> in
<img class="math" src="../../_images/math/ab56fb5bd9ba2e2e251296afa1d913e44c4555e1.png" alt="\partial_0 = {1\over c}{\partial\over\partial t}"/>,
so it will not be present in the final equations (that involve terms like
<img class="math" src="../../_images/math/0e35888fdeaf118cf2494e17958e6b1d31c6f2af.png" alt="\partial_\mu j^\mu"/>). We can also just set <img class="math" src="../../_images/math/0e4cc644ec8a1c3623c13ed3d14904096a0d87b9.png" alt="c=1"/> as usual in relativistic
physics.</p>
</div>
<div class="section" id="weak-formulation">
<h2>Weak Formulation<a class="headerlink" href="#weak-formulation" title="Permalink to this headline">¶</a></h2>
<p>The Euler equations:</p>
<div class="math">
<p><img src="../../_images/math/64496c86e0a6387b7128880337db87b8d33c3019.png" alt="{\partial{\bf w}\over \partial t} +
{\partial{\bf f}_x\over \partial x} +
{\partial{\bf f}_y\over \partial y} +
{\partial{\bf f}_z\over \partial z} +
{\bf g}= 0" /></p>
</div><p>are nonlinear. The time-derivative is approximated using the implicit Euler
method</p>
<div class="math">
<p><img src="../../_images/math/936006e1e15fb6bfec7e5670a21e2dfa55cafbc2.png" alt="{{\bf w}^{n+1}-{\bf w}^n\over \tau} +
{\partial{\bf f}_x({\bf w}^{n+1})\over \partial x} +
{\partial{\bf f}_y({\bf w}^{n+1})\over \partial y} +
{\partial{\bf f}_z({\bf w}^{n+1})\over \partial z} +
{\bf g}= 0" /></p>
</div><p>The vector-valued test functions for the above system of equations have the
form:</p>
<div class="math">
<p><img src="../../_images/math/3340312bcde8c04c7c4bbc7e1d7d66d9bd30aff1.png" alt="\left( \begin{array}{c}
    \varphi^0 \\
    0 \\
    0 \\
    0 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    \varphi^1 \\
    0 \\
    0 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    0 \\
    \varphi^2 \\
    0 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    0 \\
    0 \\
    \varphi^3 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    0 \\
    0 \\
    0 \\
    \varphi^4 \\
\end{array} \right)" /></p>
</div><p>After multiplying the equation system with the test functions and integrating
over the domain <img class="math" src="../../_images/math/9e2b196e9b7e57d1ec99f6534c581ea9759d2170.png" alt="\Omega"/>, we obtain (here the index <img class="math" src="../../_images/math/a859cf4d934ceb063567af10283152e529a1c7d6.png" alt="i=0, 1, 2, 3, 4"/> is
numbering the 5 equations, so we are <em>not</em> summing over it):</p>
<div class="math">
<p><img src="../../_images/math/432aed4f2da63e31777b0b90f98bc15e7d37b528.png" alt="\int_{\Omega} {w_i^{n+1}-w_i^n\over\tau}\varphi^i
    +{\partial\left({\bf f}_x({\bf w}^{n+1})\right)_i\over \partial x}\varphi^i
    +{\partial\left({\bf f}_y({\bf w}^{n+1})\right)_i\over \partial y}\varphi^i
    +{\partial\left({\bf f}_z({\bf w}^{n+1})\right)_i\over \partial z}\varphi^i
    + g_i \varphi^i
    \ \d^3 x
    =0" /></p>
</div><p>Now we integrate by parts:</p>
<div class="math">
<p><img src="../../_images/math/5f27b0deee80b6c9d7a029c2b06566aa39d6fc39.png" alt="\int_{\Omega} {w_i^{n+1}-w_i^n\over\tau}\varphi^i
    - \left({\bf f}_x({\bf w}^{n+1})\right)_i
      {\partial \varphi^i\over\partial x}
    - \left({\bf f}_y({\bf w}^{n+1})\right)_i
      {\partial \varphi^i\over\partial y}
    - \left({\bf f}_z({\bf w}^{n+1})\right)_i
      {\partial \varphi^i\over\partial z}
    + g_i \varphi^i
    \ \d^3 x
    +

+\int_{\partial\Omega}
    \left({\bf f}_x({\bf w}^{n+1})\right)_i
    \varphi^i\, n_x
+ \left({\bf f}_y({\bf w}^{n+1})\right)_i
    \varphi^i\, n_y
+ \left({\bf f}_z({\bf w}^{n+1})\right)_i
    \varphi^i\, n_z
\ \d^2 x
=0" /></p>
</div><p>where <img class="math" src="../../_images/math/7f2d58d6348e91be0cd7b230edffcdd273170454.png" alt="{\bf n} = (n_x, n_y, n_z)"/> is the outward surface normal to
<img class="math" src="../../_images/math/6720af89712e36d5af405fb7adf80ec1f04b211a.png" alt="\partial\Omega"/>. Rearranging:</p>
<div class="math">
<p><img src="../../_images/math/09ff711307a154629ebfbc05c3fe81dacbe48529.png" alt="\int_{\Omega} {w_i^{n+1}\over\tau}\varphi^i
    - \left({\bf f}_x({\bf w}^{n+1})\right)_i
      {\partial \varphi^i\over\partial x}
    - \left({\bf f}_y({\bf w}^{n+1})\right)_i
      {\partial \varphi^i\over\partial y}
    - \left({\bf f}_z({\bf w}^{n+1})\right)_i
      {\partial \varphi^i\over\partial z}
    \ \d^3 x
    +

+\int_{\partial\Omega}
    \left({\bf f}_x({\bf w}^{n+1})\right)_i
    \varphi^i\, n_x
+ \left({\bf f}_y({\bf w}^{n+1})\right)_i
    \varphi^i\, n_y
+ \left({\bf f}_z({\bf w}^{n+1})\right)_i
    \varphi^i\, n_z
\ \d^2 x
=
\int_{\Omega} {w_i^n\over\tau}\varphi^i
    - g_i\varphi^i
    \ \d^3 x" /></p>
</div><p>We can then linearize this for example by taking the flux jacobians
<img class="math" src="../../_images/math/908dc44dda04ec1205cb439ddd1a25c511151f5c.png" alt="{\bf A}_x({\bf w}^{n+1})"/> on the previous time level
<img class="math" src="../../_images/math/92347ed7f899fe6d57b3efefb6b9b03d875ec86a.png" alt="{\bf A}_x({\bf w}^n)"/>.</p>
<p>The finite element formulation is obtained from here by replacing in the
standard way the unknown solution <img class="math" src="../../_images/math/bc590591e4a3de0ffd202cc3b919af17a55c1d3a.png" alt="w^{n+1}"/> by a piecewise-polynomial unknown
function</p>
<div class="math">
<p><img src="../../_images/math/cb23d5ee09425fc36be8929b644a4892946ed282.png" alt="w_h^{n+1} = \sum_{k=1}^N y_k \psi_k," /></p>
</div><p>where <img class="math" src="../../_images/math/2deaf2ac13e64fefa38f4757390941118ae088cf.png" alt="\psi_k"/> are the basis functions of the piecewise-polynomial finite
element space.  This turns the above weak formulation into a finite number of
nonlinear algebraic equations of the form <img class="math" src="../../_images/math/861ece295ea0fc7a11bc8fe2dbdc99becd8c8aeb.png" alt="F(Y) = 0"/> that will be solved using
the Newton&#8217;s method.</p>
<div class="section" id="explicit-method">
<h3>Explicit Method<a class="headerlink" href="#explicit-method" title="Permalink to this headline">¶</a></h3>
<p>We also derive the weak formulation for the explicit method.
Euler equations:</p>
<div class="math">
<p><img src="../../_images/math/64496c86e0a6387b7128880337db87b8d33c3019.png" alt="{\partial{\bf w}\over \partial t} +
{\partial{\bf f}_x\over \partial x} +
{\partial{\bf f}_y\over \partial y} +
{\partial{\bf f}_z\over \partial z} +
{\bf g}= 0" /></p>
</div><p>The time-derivative is approximated using the explicit Euler
method</p>
<div class="math">
<p><img src="../../_images/math/16955521d7ad0f6e3bd399aa0826099789383f4d.png" alt="{{\bf w}^{n+1}-{\bf w}^n\over \tau} +
{\partial{\bf f}_x({\bf w}^{n})\over \partial x} +
{\partial{\bf f}_y({\bf w}^{n})\over \partial y} +
{\partial{\bf f}_z({\bf w}^{n})\over \partial z} +
{\bf g}= 0" /></p>
</div><p>The vector-valued test functions for the above system of equations have the
form:</p>
<div class="math">
<p><img src="../../_images/math/3340312bcde8c04c7c4bbc7e1d7d66d9bd30aff1.png" alt="\left( \begin{array}{c}
    \varphi^0 \\
    0 \\
    0 \\
    0 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    \varphi^1 \\
    0 \\
    0 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    0 \\
    \varphi^2 \\
    0 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    0 \\
    0 \\
    \varphi^3 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    0 \\
    0 \\
    0 \\
    \varphi^4 \\
\end{array} \right)" /></p>
</div><p>After multiplying the equation system with the test functions and integrating
over the domain <img class="math" src="../../_images/math/9e2b196e9b7e57d1ec99f6534c581ea9759d2170.png" alt="\Omega"/>, we obtain (here the index <img class="math" src="../../_images/math/a859cf4d934ceb063567af10283152e529a1c7d6.png" alt="i=0, 1, 2, 3, 4"/> is
numbering the 5 equations, so we are <em>not</em> summing over it):</p>
<div class="math">
<p><img src="../../_images/math/82448fc16432148b50f02a8f2c71c1ed798caad6.png" alt="\int_{\Omega} {w_i^{n+1}-w_i^n\over\tau}\varphi^i
    +{\partial\left({\bf f}_x({\bf w}^{n})\right)_i\over \partial x}\varphi^i
    +{\partial\left({\bf f}_y({\bf w}^{n})\right)_i\over \partial y}\varphi^i
    +{\partial\left({\bf f}_z({\bf w}^{n})\right)_i\over \partial z}\varphi^i
    + g_i \varphi^i
    \ \d^3 x
    =0" /></p>
</div><p>Now we integrate by parts:</p>
<div class="math">
<p><img src="../../_images/math/2d6cbf79fb4b6f69d6277b68abdf55e71f1227c0.png" alt="\int_{\Omega} {w_i^{n+1}-w_i^n\over\tau}\varphi^i
    - \left({\bf f}_x({\bf w}^{n})\right)_i
      {\partial \varphi^i\over\partial x}
    - \left({\bf f}_y({\bf w}^{n})\right)_i
      {\partial \varphi^i\over\partial y}
    - \left({\bf f}_z({\bf w}^{n})\right)_i
      {\partial \varphi^i\over\partial z}
    + g_i \varphi^i
    \ \d^3 x
    +

+\int_{\partial\Omega}
    \left({\bf f}_x({\bf w}^{n})\right)_i
    \varphi^i\, n_x
+ \left({\bf f}_y({\bf w}^{n})\right)_i
    \varphi^i\, n_y
+ \left({\bf f}_z({\bf w}^{n})\right)_i
    \varphi^i\, n_z
\ \d^2 x
=0" /></p>
</div><p>where <img class="math" src="../../_images/math/7f2d58d6348e91be0cd7b230edffcdd273170454.png" alt="{\bf n} = (n_x, n_y, n_z)"/> is the outward surface normal to
<img class="math" src="../../_images/math/6720af89712e36d5af405fb7adf80ec1f04b211a.png" alt="\partial\Omega"/>. Rearranging:</p>
<div class="math">
<p><img src="../../_images/math/542139146e939d4255314ba4388020a2c5992ee3.png" alt="\int_{\Omega} {w_i^{n+1}\over\tau}\varphi^i
    \ \d^3 x
=
\int_{\Omega}{w_i^n\over\tau}\varphi^i
    + \left({\bf f}_x({\bf w}^{n})\right)_i
      {\partial \varphi^i\over\partial x}
    + \left({\bf f}_y({\bf w}^{n})\right)_i
      {\partial \varphi^i\over\partial y}
    + \left({\bf f}_z({\bf w}^{n})\right)_i
      {\partial \varphi^i\over\partial z}
    - g_i\varphi^i
    \ \d^3 x
    +

-\int_{\partial\Omega}
    \left({\bf f}_x({\bf w}^{n})\right)_i
    \varphi^i\, n_x
+ \left({\bf f}_y({\bf w}^{n})\right)_i
    \varphi^i\, n_y
+ \left({\bf f}_z({\bf w}^{n})\right)_i
    \varphi^i\, n_z
\ \d^2 x" /></p>
</div></div>
</div>
<div class="section" id="flux-jacobians">
<h2>Flux Jacobians<a class="headerlink" href="#flux-jacobians" title="Permalink to this headline">¶</a></h2>
<p>Now we write the spatial derivatives using the so called flux Jacobians
<img class="math" src="../../_images/math/7cd2e4892212a8a5b973e2add40bc4dc5aef0eec.png" alt="{\bf A}_x"/>,
<img class="math" src="../../_images/math/6a55da3074a4683c7d927c5286f49f00100be9c9.png" alt="{\bf A}_y"/>
and
<img class="math" src="../../_images/math/82b183cd47f646636734b8e25ff3fa7d5e04cfac.png" alt="{\bf A}_z"/>:</p>
<div class="math">
<p><img src="../../_images/math/aaa4d41598073ec70289c0a8074cfd7abc006b02.png" alt="{\partial{\bf f}_x\over \partial x} =
{\partial{\bf f}_x\over \partial {\bf w}}
{\partial{\bf w}\over \partial x} \equiv
{\bf A}_x
{\partial{\bf w}\over \partial x}

{\bf A}_x={\bf A}_x({\bf w})\equiv{\partial{\bf f}_x\over \partial {\bf w}}" /></p>
</div><p>Similarly for <img class="math" src="../../_images/math/092e364e1d9d19ad5fffb0b46ef4cc7f2da02c1c.png" alt="y"/> and <img class="math" src="../../_images/math/b13f21416d84e13708696f34dea81026cda583c9.png" alt="z"/>, so we get:</p>
<div class="math">
<p><img src="../../_images/math/7bb2506a2b1bc6ce2ecaa791c977cfed3f22a91e.png" alt="{\partial{\bf w}\over \partial t} +
{\bf A}_x
{\partial{\bf w}\over \partial x} +
{\bf A}_y
{\partial{\bf w}\over \partial y} +
{\bf A}_z
{\partial{\bf w}\over \partial z} +
{\bf g}= 0" /></p>
</div><p>One nice thing about these particular
<img class="math" src="../../_images/math/d195085ac6d735eff88a6561b7c7b41173b64150.png" alt="{\bf f}_x"/>,
<img class="math" src="../../_images/math/b5c9cd8e5a2854dd234d54d5fa1b4642586df2c1.png" alt="{\bf f}_y"/> and
<img class="math" src="../../_images/math/726bc7b2acffee8eafc1526c6ec47c65e3591c69.png" alt="{\bf f}_z"/> functions is that they are homogeneous of degree 1:</p>
<div class="math">
<p><img src="../../_images/math/c017aa9d5409039a01b6cbeb2fbb0a9ee00d7124.png" alt="{\bf f}_x(\lambda{\bf w})
=\lambda\,{\bf f}_x({\bf w})" /></p>
</div><p>so the Euler equation/formula for the homogeneous function is:</p>
<div class="math">
<p><img src="../../_images/math/6fb56119cef89dd097575efc1191dd7090d0fe6c.png" alt="{\bf w}\cdot {\partial {\bf f}_x({\bf w})\over\partial {\bf w}}
={\bf f}_x({\bf w})

{\bf w}\cdot {\bf A}_x ={\bf f}_x({\bf w})" /></p>
</div><p>So both the <img class="math" src="../../_images/math/d195085ac6d735eff88a6561b7c7b41173b64150.png" alt="{\bf f}_x"/> and it&#8217;s derivative can be nicely factored out using
the flux Jacobian:</p>
<div class="math">
<p><img src="../../_images/math/b41533d695b3c28e4bd63a8e700dd67828376cbb.png" alt="{\bf f}_x = {\bf A}_x\, {\bf w}

{\partial{\bf f}_x\over \partial x} =
    {\bf A}_x {\partial{\bf w}\over \partial x}" /></p>
</div><p>by differentiating the first equation and substracting the second, we get:</p>
<div class="math">
<p><img src="../../_images/math/c1f0fd13876c360409dfa027ef430ad4cfd28dd7.png" alt="{\partial {\bf A}_x\over\partial x}\, {\bf w} = 0" /></p>
</div><p>similarly for <img class="math" src="../../_images/math/092e364e1d9d19ad5fffb0b46ef4cc7f2da02c1c.png" alt="y"/> and <img class="math" src="../../_images/math/b13f21416d84e13708696f34dea81026cda583c9.png" alt="z"/>.
To calculate the Jacobians, we&#8217;ll need:</p>
<div class="math">
<p><img src="../../_images/math/b1f2b936423e70cc8e26b474c5654d3d1ed39fce.png" alt="{\partial p\over \partial {\bf w}}=
    {R\over c_v}
    \left( \begin{array}{ccccc}
        {w_1^2+w_2^2+w_3^2\over 2w_0^2} &amp; -{w_1\over w_0} &amp; -{w_2\over w_0}
            &amp; -{w_3\over w_0} &amp; 1\\
    \end{array} \right)" /></p>
</div><p>then we can calculate the Jacobians (and we substitute for <img class="math" src="../../_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/>):</p>
<div class="math">
<p><img src="../../_images/math/e070a869882e91736b9b5578e143bef8afc6e8d4.png" alt="{\bf A}_x({\bf w}) = {\partial{\bf f}_x\over \partial {\bf w}}=
    \left( \begin{array}{ccccc}
        0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\
        -{w_1^2\over w_0^2} +{R\over c_v}{w_1^2+w_2^2+w_3^2\over 2 w_0^2} &amp;
            {2w_1\over w_0}-{R\over c_v}{w_1\over w_0} &amp;
            -{R\over c_v}{w_2\over w_0} &amp;
            -{R\over c_v}{w_3\over w_0} &amp;
            {R\over c_v}\\
        -{w_1w_2\over w_0^2} &amp; {w_2\over w_0} &amp; {w_1\over w_0} &amp; 0 &amp; 0\\
        -{w_1w_3\over w_0^2} &amp; {w_3\over w_0} &amp; 0 &amp; {w_1\over w_0} &amp; 0 \\
            -{w_1w_4\over w_0^2}-{w_1\over w_0^2}{R\over c_v}
                \left(w_4-{w_1^2+w_2^2+w_3^2\over 2 w_0}\right)
                +{w_1\over w_0}{R\over c_v}{w_1^2+w_2^2+w_3^2\over 2 w_0^2}&amp;
            {w_4\over w_0}+{1\over w_0}{R\over c_v}
                \left(w_4-{w_1^2+w_2^2+w_3^2\over 2 w_0}\right)
                -{R\over c_v}{w_1^2\over w_0^2} &amp;
            -{R\over c_v}{w_1w_2\over w_0^2} &amp;
            -{R\over c_v}{w_1w_3\over w_0^2} &amp;
            {w_1\over w_0}+{R\over c_v}{w_1\over w_0} \\
   \end{array} \right)

{\bf A}_y({\bf w}) = {\partial{\bf f}_y\over \partial {\bf w}}=
    \left( \begin{array}{ccccc}
        0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
        -{w_2w_1\over w_0^2} &amp; {w_2\over w_0} &amp; {w_1\over w_0} &amp; 0 &amp; 0\\
        -{w_2^2\over w_0^2} +{R\over c_v}{w_1^2+w_2^2+w_3^2\over 2 w_0^2} &amp;
            -{R\over c_v}{w_1\over w_0} &amp;
            {2w_2\over w_0}-{R\over c_v}{w_2\over w_0} &amp;
            -{R\over c_v}{w_3\over w_0} &amp;
            {R\over c_v}\\
        -{w_2w_3\over w_0^2} &amp; 0 &amp; {w_3\over w_0} &amp; {w_2\over w_0} &amp; 0 \\
            -{w_2w_4\over w_0^2}-{w_2\over w_0^2}{R\over c_v}
                \left(w_4-{w_1^2+w_2^2+w_3^2\over 2 w_0}\right)
                +{w_2\over w_0}{R\over c_v}{w_1^2+w_2^2+w_3^2\over 2 w_0^2}&amp;
            -{R\over c_v}{w_2w_1\over w_0^2} &amp;
            {w_4\over w_0}+{1\over w_0}{R\over c_v}
                \left(w_4-{w_1^2+w_2^2+w_3^2\over 2 w_0}\right)
                -{R\over c_v}{w_2^2\over w_0^2} &amp;
            -{R\over c_v}{w_2w_3\over w_0^2} &amp;
            {w_2\over w_0}+{R\over c_v}{w_2\over w_0} \\
   \end{array} \right)

{\bf A}_z({\bf w}) = {\partial{\bf f}_z\over \partial {\bf w}}=
    \left( \begin{array}{ccccc}
        0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
        -{w_3w_1\over w_0^2} &amp; {w_3\over w_0} &amp; 0 &amp; {w_1\over w_0} &amp; 0 \\
        -{w_3w_2\over w_0^2} &amp; 0 &amp; {w_3\over w_0} &amp; {w_2\over w_0} &amp; 0 \\
        -{w_3^2\over w_0^2} +{R\over c_v}{w_1^2+w_2^2+w_3^2\over 2 w_0^2} &amp;
            -{R\over c_v}{w_1\over w_0} &amp;
            -{R\over c_v}{w_2\over w_0} &amp;
            {2w_3\over w_0} -{R\over c_v}{w_3\over w_0} &amp;
            {R\over c_v}\\
            -{w_3w_4\over w_0^2}-{w_3\over w_0^2}{R\over c_v}
                \left(w_4-{w_1^2+w_2^2+w_3^2\over 2 w_0}\right)
                +{w_3\over w_0}{R\over c_v}{w_1^2+w_2^2+w_3^2\over 2 w_0^2}&amp;
            -{R\over c_v}{w_3w_1\over w_0^2} &amp;
            -{R\over c_v}{w_3w_2\over w_0^2} &amp;
            {w_4\over w_0}+{1\over w_0}{R\over c_v}
                \left(w_4-{w_1^2+w_2^2+w_3^2\over 2 w_0}\right)
                -{R\over c_v}{w_3^2\over w_0^2} &amp;
            {w_3\over w_0}+{R\over c_v}{w_3\over w_0} \\
   \end{array} \right)" /></p>
</div></div>
<div class="section" id="d-version-of-the-equations">
<h2>2D Version of the Equations<a class="headerlink" href="#d-version-of-the-equations" title="Permalink to this headline">¶</a></h2>
<div class="math">
<p><img src="../../_images/math/83ccbbad7b7a3f9803ae7ad36272f3d8f3363caa.png" alt="{\partial{\bf w}\over \partial t} +
{\partial{\bf f}_x\over \partial x} +
{\partial{\bf f}_y\over \partial y} +
{\bf g}= 0" /></p>
</div><p>where:</p>
<div class="math">
<p><img src="../../_images/math/2c517b0035103c903e34e7c4fbbbd42d3c5223da.png" alt="{\bf w} =
   \left( \begin{array}{c}
       \varrho\\ \rho u_1\\ \rho u_2\\ E
   \end{array} \right)
   =
   \left( \begin{array}{c}
       w_0 \\
       w_1 \\
       w_2 \\
       w_3 \\
   \end{array} \right)

{\bf f}_x =
   \left( \begin{array}{c}
       \rho u_1\\
       \rho u_1^2 + p\\
       \rho u_1 u_2\\
       u_1(E+p)
   \end{array} \right)
   =
   \left( \begin{array}{c}
       w_1\\
       \frac{w_1^2}{w_0} + p\\
       \frac{w_1w_2}{w_0}\\
       \frac{w_1}{w_0}(w_3+p)
   \end{array} \right)

{\bf f}_y =
   \left( \begin{array}{c}
       \rho u_2\\
       \rho u_2 u_1\\
       \rho u_2^2 + p\\
       u_2(E+p)
   \end{array} \right)
   =
   \left( \begin{array}{c}
       w_2\\
       \frac{w_2w_1}{w_0}\\
       \frac{w_2^2}{w_0} + p\\
       \frac{w_2}{w_0}(w_3+p)
   \end{array} \right)

{\bf g} =
   \left( \begin{array}{c}
       0\\
       -f_x\\
       -f_y\\
       0\\
   \end{array} \right)

p = {R\over c_v} \left(E-\half \rho\left(u_1^2 + u_2^2\right)\right)
= {R\over c_v} \left(w_3-{w_1^2+w_2^2\over2w_0}\right)" /></p>
</div><p>Discretizing the time derivative:</p>
<div class="math">
<p><img src="../../_images/math/ac7dff78598df7157b76e570dc200b14bc6a41fc.png" alt="{{\bf w}^{n+1}-{\bf w}^n\over \tau} +
{\partial{\bf f}_x({\bf w}^{n+1})\over \partial x} +
{\partial{\bf f}_y({\bf w}^{n+1})\over \partial y} +
{\bf g}= 0" /></p>
</div><p>The vector-valued test functions for the above system of equations have the
form:</p>
<div class="math">
<p><img src="../../_images/math/0a11b33d8a12f0855cf5527e5cbed2b44364817b.png" alt="\left( \begin{array}{c}
    \varphi^0 \\
    0 \\
    0 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    \varphi^1 \\
    0 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    0 \\
    \varphi^2 \\
    0 \\
\end{array} \right),\
\left( \begin{array}{c}
    0 \\
    0 \\
    0 \\
    \varphi^3 \\
\end{array} \right)" /></p>
</div><p>After multiplying the equation system with the test functions and integrating
over the domain <img class="math" src="../../_images/math/9e2b196e9b7e57d1ec99f6534c581ea9759d2170.png" alt="\Omega"/>, we obtain:</p>
<div class="math">
<p><img src="../../_images/math/e321e1e10747c4edcb96305cc9e33a48d5204a5f.png" alt="\int_{\Omega} {w_i^{n+1}-w_i^n\over\tau}\varphi^i
    +{\partial\left({\bf f}_x({\bf w}^{n+1})\right)_i\over \partial x}\varphi^i
    +{\partial\left({\bf f}_y({\bf w}^{n+1})\right)_i\over \partial y}\varphi^i
    + g_i \varphi^i
    \ \d^2 x
    =0" /></p>
</div><p>Now we integrate by parts:</p>
<div class="math">
<p><img src="../../_images/math/6a9633860337c201672e0090ae7c58a0f765c993.png" alt="\int_{\Omega} {w_i^{n+1}-w_i^n\over\tau}\varphi^i
    - \left({\bf f}_x({\bf w}^{n+1})\right)_i
      {\partial \varphi^i\over\partial x}
    - \left({\bf f}_y({\bf w}^{n+1})\right)_i
      {\partial \varphi^i\over\partial y}
    + g_i \varphi^i
    \ \d^2 x
    +

+\int_{\partial\Omega}
    \left({\bf f}_x({\bf w}^{n+1})\right)_i
    \varphi^i\, n_x
+ \left({\bf f}_y({\bf w}^{n+1})\right)_i
    \varphi^i\, n_y
\ \d x
=0" /></p>
</div><p>where <img class="math" src="../../_images/math/e518b5d341251ea72a8065aab4c0c659e8073183.png" alt="{\bf n} = (n_x, n_y)"/> is the outward surface normal to
<img class="math" src="../../_images/math/6720af89712e36d5af405fb7adf80ec1f04b211a.png" alt="\partial\Omega"/>. Rearranging:</p>
<div class="math">
<p><img src="../../_images/math/8318e4313b3d9c0f59a5faedc89488a5866be241.png" alt="\int_{\Omega} {w_i^{n+1}\over\tau}\varphi^i
    - \left({\bf f}_x({\bf w}^{n+1})\right)_i
      {\partial \varphi^i\over\partial x}
    - \left({\bf f}_y({\bf w}^{n+1})\right)_i
      {\partial \varphi^i\over\partial y}
    \ \d^2 x
    +

+\int_{\partial\Omega}
    \left({\bf f}_x({\bf w}^{n+1})\right)_i
    \varphi^i\, n_x
+ \left({\bf f}_y({\bf w}^{n+1})\right)_i
    \varphi^i\, n_y
\ \d x
=
\int_{\Omega} {w_i^n\over\tau}\varphi^i
    - g_i\varphi^i
    \ \d^2 x" /></p>
</div><p>The 2D flux Jacobians are:</p>
<div class="math">
<p><img src="../../_images/math/115ef2997e6a9427c68421cb08d4717683e9866f.png" alt="{\bf A}_x({\bf w}) = {\partial{\bf f}_x\over \partial {\bf w}}=
    \left( \begin{array}{cccc}
        0 &amp; 1 &amp; 0 &amp; 0\\
        -{w_1^2\over w_0^2} +{R\over c_v}{w_1^2+w_2^2\over 2 w_0^2} &amp;
            {2w_1\over w_0}-{R\over c_v}{w_1\over w_0} &amp;
            -{R\over c_v}{w_2\over w_0} &amp;
            {R\over c_v}\\
        -{w_1w_2\over w_0^2} &amp; {w_2\over w_0} &amp; {w_1\over w_0} &amp; 0 \\
            -{w_1w_3\over w_0^2}-{w_1\over w_0^2}{R\over c_v}
                \left(w_3-{w_1^2+w_2^2\over 2 w_0}\right)
                +{w_1\over w_0}{R\over c_v}{w_1^2+w_2^2\over 2 w_0^2} &amp;
            {w_3\over w_0}+{1\over w_0}{R\over c_v}
                \left(w_3-{w_1^2+w_2^2\over 2 w_0}\right)
                -{R\over c_v}{w_1^2\over w_0^2} &amp;
            -{R\over c_v}{w_1w_2\over w_0^2} &amp;
            {w_1\over w_0}+{R\over c_v}{w_1\over w_0} \\
   \end{array} \right)

{\bf A}_y({\bf w}) = {\partial{\bf f}_y\over \partial {\bf w}}=
    \left( \begin{array}{cccc}
        0 &amp; 0 &amp; 1 &amp; 0\\
        -{w_2w_1\over w_0^2} &amp; {w_2\over w_0} &amp; {w_1\over w_0} &amp; 0 \\
        -{w_2^2\over w_0^2} +{R\over c_v}{w_1^2+w_2^2\over 2 w_0^2} &amp;
            -{R\over c_v}{w_1\over w_0} &amp;
            {2w_2\over w_0} -{R\over c_v}{w_2\over w_0} &amp;
            {R\over c_v}\\
        -{w_2w_3\over w_0^2}-{w_2\over w_0^2}{R\over c_v}
                \left(w_3-{w_1^2+w_2^2\over 2 w_0}\right)
                +{w_2\over w_0}{R\over c_v}{w_1^2+w_2^2\over 2 w_0^2}&amp;
            -{R\over c_v}{w_2w_1\over w_0^2} &amp;
            {w_3\over w_0}+{1\over w_0}{R\over c_v}
                \left(w_3-{w_1^2+w_2^2\over 2 w_0}\right)
                -{R\over c_v}{w_2^2\over w_0^2} &amp;
            {w_2\over w_0}+{R\over c_v}{w_2\over w_0} \\
   \end{array} \right)" /></p>
</div></div>
<div class="section" id="sea-breeze-modeling">
<h2>Sea Breeze Modeling<a class="headerlink" href="#sea-breeze-modeling" title="Permalink to this headline">¶</a></h2>
<p>In our 2D model we make the following assumptions:</p>
<div class="math">
<p><img src="../../_images/math/eabbeabedf4e14b93a96e8941c69448d54902035.png" alt="f_x = 0

f_y = -\rho g = -w_0 g" /></p>
</div><p>and the boundary condition is as follows:</p>
<div class="math">
<p><img src="../../_images/math/739dca6def8a32adf089292158681bdf968a46ea.png" alt="T'(x, t) = \left(A\over2\right) \sin \left(\pi (t-t_0)\over 24\right)
    \left(1+\tanh\left(S(x)\over L\right)\right)

T(x) = T_0 + T'(x, t)" /></p>
</div><p>The weak formulation in 2D is (here <img class="math" src="../../_images/math/d28cfb946bbbe3436f712a7ac2052cba8998d079.png" alt="i = 0, 1, 2, 3"/>):</p>
<div class="math">
<p><img src="../../_images/math/4bc90524a97d20cd5fbf110347d27f5835b684bb.png" alt="\int_{\Omega} {w_i^{n+1}\over\tau}\varphi^i
    - \left({\bf A}_x({\bf w}^n)\right)_{ij}
      w_j^{n+1} {\partial \varphi^i\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{ij}
      w_j^{n+1} {\partial \varphi^i\over\partial z}
    \ \d^2 x
    +

+\int_{\partial\Omega}
\left({\bf A}_x({\bf w}^n)\right)_{ij}w_j^{n+1}
    \varphi^i\, n_x
+ \left({\bf A}_z({\bf w}^n)\right)_{ij}w_j^{n+1}
    \varphi^i\, n_z
\ \d x
=
\int_{\Omega} {w_i^n\over\tau}\varphi^i
    - g_i \varphi^i
    \ \d^2 x" /></p>
</div><p>In order to specify the input forms for Hermes, we&#8217;ll write the weak
formulation as:</p>
<div class="math">
<p><img src="../../_images/math/3d7a4742dce6322ae9fda0c99fb2834232042dce.png" alt="B_{00}(w_0, \varphi^0) + B_{01}(w_1, \varphi^0) +
    B_{02}(w_2, \varphi^0)+ B_{03}(w_3, \varphi^0) = l_0(\varphi^0)

B_{10}(w_0, \varphi^1) + B_{11}(w_1, \varphi^1) +
    B_{12}(w_2, \varphi^1)+ B_{13}(w_3, \varphi^1) = l_1(\varphi^1)

B_{20}(w_0, \varphi^2) + B_{21}(w_1, \varphi^2) +
    B_{22}(w_2, \varphi^2)+ B_{23}(w_3, \varphi^2) = l_2(\varphi^2)

B_{30}(w_0, \varphi^3) + B_{31}(w_1, \varphi^3) +
    B_{32}(w_2, \varphi^3)+ B_{33}(w_3, \varphi^3) = l_3(\varphi^3)" /></p>
</div><p>where the forms are (we write <img class="math" src="../../_images/math/535b2bfbb0a587e261a0d0af9b7b53e42629b14d.png" alt="w_i"/> instead of <img class="math" src="../../_images/math/9881757570bbbc448cfa593b5b536968fe73748e.png" alt="w_i^{n+1}"/>):</p>
<div class="math">
<p><img src="../../_images/math/572f560586c0dcfc8a16b3037b6f8d7e75ec20e4.png" alt="l_0(\varphi^0) = \int_\Omega {w_0^n\varphi^0\over\tau} \,\d^2 x

l_1(\varphi^1) = \int_\Omega {w_1^n\varphi^1\over\tau} \,\d^2 x

l_2(\varphi^2) = \int_\Omega {w_2^n\varphi^2\over\tau} + \rho g \varphi^2
    \,\d^2 x

l_3(\varphi^3) = \int_\Omega {w_3^n\varphi^3\over\tau} \,\d^2 x

B_{ij}(w_j, \varphi^i) = \int_{\Omega} {w_i\over\tau}\varphi^i
    \delta_{ij}
    - \left({\bf A}_x({\bf w}^n)\right)_{ij}
      w_j {\partial \varphi^i\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{ij}
      w_j {\partial \varphi^i\over\partial z}
    \ \d^2 x" /></p>
</div><p>In the last expression we do <em>not</em> sum over <img class="math" src="../../_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/> nor <img class="math" src="../../_images/math/8122aa89ea6e80784c6513d22787ad86e36ad0cc.png" alt="j"/>.
In particular:</p>
<div class="math">
<p><img src="../../_images/math/d13d7e10f03bd6a7392c28abf3a96906957c26cd.png" alt="B_{00}(w_0, \varphi^0) = \int_{\Omega} {w_0\over\tau}\varphi^0
    - \left({\bf A}_x({\bf w}^n)\right)_{00}
      w_0 {\partial \varphi^0\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{00}
      w_0 {\partial \varphi^0\over\partial z}
    \ \d^2 x
    =
    \int_{\Omega} {w_0\over\tau}\varphi^0
    \ \d^2 x

B_{01}(w_1, \varphi^0) = \int_{\Omega}
    - \left({\bf A}_x({\bf w}^n)\right)_{01}
      w_1 {\partial \varphi^0\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{01}
      w_1 {\partial \varphi^0\over\partial z}
    \ \d^2 x
    =
    \int_{\Omega}
    - \left({\bf A}_x({\bf w}^n)\right)_{01}
      w_1 {\partial \varphi^0\over\partial x}
    \ \d^2 x

B_{02}(w_2, \varphi^0) = \int_{\Omega}
    - \left({\bf A}_x({\bf w}^n)\right)_{02}
      w_2 {\partial \varphi^0\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{02}
      w_2 {\partial \varphi^0\over\partial z}
    \ \d^2 x
    =
    \int_{\Omega}
    - \left({\bf A}_z({\bf w}^n)\right)_{02}
      w_2 {\partial \varphi^0\over\partial z}
    \ \d^2 x

B_{03}(w_3, \varphi^0) = \int_{\Omega}
    - \left({\bf A}_x({\bf w}^n)\right)_{03}
      w_3 {\partial \varphi^0\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{03}
      w_3 {\partial \varphi^0\over\partial z}
    \ \d^2 x
    =0

B_{10}(w_0, \varphi^1) = \int_{\Omega}
    - \left({\bf A}_x({\bf w}^n)\right)_{10}
      w_0 {\partial \varphi^1\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{10}
      w_0 {\partial \varphi^1\over\partial z}
    \ \d^2 x

B_{11}(w_1, \varphi^1) = \int_{\Omega} {w_1\over\tau}\varphi^1
    - \left({\bf A}_x({\bf w}^n)\right)_{11}
      w_1 {\partial \varphi^1\over\partial x}
    - \left({\bf A}_z({\bf w}^n)\right)_{11}
      w_1 {\partial \varphi^1\over\partial z}
    \ \d^2 x

\cdots" /></p>
</div></div>
<div class="section" id="boundary-conditions">
<h2>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>We rewrite the boundary integral by rotating coordinates, so that
the flow is only in the <img class="math" src="../../_images/math/26eeb5258ca5099acf8fe96b2a1049c48c89a5e6.png" alt="x"/> direction (thus we only have <img class="math" src="../../_images/math/d195085ac6d735eff88a6561b7c7b41173b64150.png" alt="{\bf f}_x"/>):</p>
<div class="math">
<p><img src="../../_images/math/4e0ac78d42e160e718f00680153c054a077d0b5c.png" alt="\int_{\partial\Omega}
\left({\bf f}_x({\bf w})\right)_i
    \varphi^i\, n_x
+ \left({\bf f}_y({\bf w})\right)_i
    \varphi^i\, n_y
+ \left({\bf f}_z({\bf w})\right)_i
    \varphi^i\, n_z
\ \d^2 x
=

=
\int_{\partial\Omega}
T^{-1} {\bf f}_x(T {\bf w}) \varphi^i
\ \d^2 x" /></p>
</div><p>Now we need to approximate <img class="math" src="../../_images/math/a119a1f4461f5f95b8e5998af8828cddc0f0fe7e.png" alt="{\bf f}_x(T {\bf w})"/> somehow.
We do that by solving the following 1D problem (Riemann problem):</p>
<div class="math">
<p><img src="../../_images/math/6049bd2491687386db52dc7c9279622b75b92fea.png" alt="{\partial {\bf w}\over\partial t} + {\partial\over\partial x}
    {\bf f}({\bf w}) = 0" /></p>
</div><p>or:</p>
<div class="math" id="equation-riemann2">
<p><span class="eqno">(1)</span><img src="../../_images/math/6b7ee0414ad852651a46cc28c98c66716d0b8af2.png" alt="{\partial {\bf w}\over\partial t} + {\bf A}({\bf w})
    {\partial{\bf w}\over\partial x} = 0" /></p>
</div><div class="math">
<p><img src="../../_images/math/07cd0dc078b1ec8243d95f79238ed0d55664b813.png" alt="{\bf w}(x, t) = \left( \begin{array}{c}
    w_0 \\
    w_1 \\
    w_2 \\
    w_3 \\
    w_4 \\
\end{array} \right)" /></p>
</div><p>And we approximate <img class="math" src="../../_images/math/c6b1fca2fa1616a11ee31f0fe17a0fb5d86e4c36.png" alt="{\bf f}_x({\bf w})={\bf f}({\bf w}(0, t))"/>. The initial
condition is:</p>
<div class="math">
<p><img src="../../_images/math/919a157ec8807ce0e4565f3c5b70519d07927c65.png" alt="{\bf w}(x, 0) = \begin{cases}{\bf w}_L&amp;x&lt;0\cr {\bf w}_R &amp; x &gt; 0\cr
    \end{cases}
= {\bf w}_L(1-H(x)) + {\bf w}_R H(x)" /></p>
</div><p>Now we write:</p>
<div class="math">
<p><img src="../../_images/math/296ae9d9c9c8a9c9633d8b3eaba446815bbb0fb3.png" alt="{\bf w}(x, t) = \sum_i \xi^i(x, t) {\bf r}_i

{\bf w}_L = \sum_i \alpha_i {\bf r}_i

{\bf w}_R = \sum_i \beta_i {\bf r}_i

\xi^i(x, 0) = \begin{cases}
\alpha_i &amp; x &lt; 0\cr
\beta_i &amp; x &gt; 0\cr
\end{cases}" /></p>
</div><p>and substitute into <a href="#equation-riemann2">(1)</a>:</p>
<div class="math">
<p><img src="../../_images/math/594d2e0e6541749ba7bc5b5e79c24b0b70177ed3.png" alt="\sum_i\left(
{\partial \xi^i\over\partial t} + {\bf A}({\bf w})
    {\partial \xi^i\over\partial x} \right) {\bf r}_i = 0

\sum_i\left(
{\partial \xi^i\over\partial t} + \lambda_i({\bf w})
    {\partial \xi^i\over\partial x} \right) {\bf r}_i = 0" /></p>
</div><p>so we get:</p>
<div class="math">
<p><img src="../../_images/math/fcf303205b15f8f2784b222d255ec553f2435489.png" alt="{\partial \xi^i\over\partial t} + \lambda_i({\bf w})
    {\partial \xi^i\over\partial x} = 0" /></p>
</div><p>This is a nonlinear problem, that cannot be solved exactly. First,
let <img class="math" src="../../_images/math/83c3c7c699d02fb20e6cd05765b0dbfae0444c10.png" alt="{\bf A}"/> doesn&#8217;t depend on <img class="math" src="../../_images/math/617e8d9a63e644648e5c0ea450662ac513a01982.png" alt="{\bf w}"/>. Then also <img class="math" src="../../_images/math/f9092807df2606b64909623baacf32bf722daff7.png" alt="\lambda_i"/>
are a constants:</p>
<div class="math">
<p><img src="../../_images/math/e934d45c496f02402582565696e527a9293825d3.png" alt="{\partial \xi^i\over\partial t} + \lambda_i
    {\partial \xi^i\over\partial x} = 0" /></p>
</div><p>and the solution is constant along the characteristic <img class="math" src="../../_images/math/8b0d3fad76aac0e6de6666da08a1bfdab099d3b2.png" alt="x(t) = \lambda_i t + c"/>
for <img class="math" src="../../_images/math/a027a3809fbe4d5dc820151b567718df14a4e85e.png" alt="t&gt;0"/> and we get:</p>
<div class="math">
<p><img src="../../_images/math/4d37dc697a2b69dc22c1125e1e5a038926c4fc51.png" alt="\xi_i(x, t) = \xi^i(x-\lambda_i t, 0) =
\begin{cases}
\alpha_i &amp; x-\lambda_i t &lt; 0\cr
\beta_i &amp; x-\lambda_i t &gt; 0\cr
\end{cases}
=\alpha_i (1-H(x-\lambda_i t)) + \beta_i H(x-\lambda_i t)" /></p>
</div><p>and</p>
<div class="math">
<p><img src="../../_images/math/aa56a7f4ee00d75a68cf6c1388b4090c77a5968f.png" alt="{\bf w}(x, t)
= \sum_i \xi^i(x, t) {\bf r}_i
= \sum_i \left(
\alpha_i (1-H(x-\lambda_i t)) + \beta_i H(x-\lambda_i t)
\right){\bf r}_i

{\bf w}(0, t)
= \sum_i \left(
\alpha_i (1-H(-\lambda_i t)) + \beta_i H(-\lambda_i t)
\right){\bf r}_i
=

= \sum_i \left(
\alpha_i H(\lambda_i t) + \beta_i H(-\lambda_i t)
\right){\bf r}_i=

= \sum_i \left(
\alpha_i H(\lambda_i) + \beta_i H(-\lambda_i)
\right){\bf r}_i=

= \sum_{i=k+1}^n \alpha_i {\bf r}_i
+ \sum_{i=1}^k \beta_i {\bf r}_i" /></p>
</div><p>so:</p>
<div class="math">
<p><img src="../../_images/math/9bf6df07c25ce703951d908e47286ad41af7b1e7.png" alt="{\bf f}({\bf w}(0, t)) = {\bf A}{\bf w}(0, t)
= \sum_{i=k+1}^n {\bf A}\alpha_i {\bf r}_i
+ \sum_{i=1}^k {\bf A}\beta_i {\bf r}_i

= \sum_{i=k+1}^n \lambda_i\alpha_i {\bf r}_i
+ \sum_{i=1}^k \lambda_i\beta_i {\bf r}_i=

= {\bf A}^+\sum_{i=1}^n \alpha_i {\bf r}_i
+ {\bf A}^-\sum_{i=1}^n \beta_i {\bf r}_i=

= {\bf A}^+{\bf w}_L
+ {\bf A}^-{\bf w}_R" /></p>
</div><p>In the nonlinear case we cannot solve it exactly, but we can approximate the
solution by:</p>
<div class="math">
<p><img src="../../_images/math/30916e7d5781c857350ac387cbe117e72a7a1704.png" alt="{\bf f}({\bf w}(0, t)) = {\bf f}^+({\bf w}_L) + {\bf f}^-({\bf w}_R) =

= {\bf f}({\bf w}_R) - \int_{{\bf w}_L}^{{\bf w}_R}
    {\bf A}^+({\bf w}) \d {\bf w} =

= {\bf f}({\bf w}_L) + \int_{{\bf w}_L}^{{\bf w}_R}
    {\bf A}^-({\bf w}) \d {\bf w} \approx" /></p>
</div><div class="math" id="equation-riemann_sol">
<p><span class="eqno">(2)</span><img src="../../_images/math/68a21160b1fac534b388510b9270fb4b302e7d4d.png" alt="\approx {\bf f}({\bf w}_L) + {\bf A}^-({\bf w}_R) {\bf w}_R -
    {\bf A}^-({\bf w}_L) {\bf w}_L" /></p>
</div><p>Let&#8217;s say the domain is for <img class="math" src="../../_images/math/cd6ee81a7a535d87853e848c77654cc36104a75e.png" alt="x&lt;0"/> and we are applying the BC condition from
<img class="math" src="../../_images/math/02e28efa00c4f2c66d1aa381c0cb1f8e0ef8d6e4.png" alt="x&gt;0"/>. Then <img class="math" src="../../_images/math/e2244a6940160d32a31f30b007daa844d72b571b.png" alt="{\bf w}_L"/> is taken from the solution and <img class="math" src="../../_images/math/dbcf02084d4d862db82c40d65920c36a24f004c2.png" alt="{\bf w}_R"/> is
prescribed, for example at the bottom it could be:</p>
<div class="math">
<p><img src="../../_images/math/b8ee7400c4c24b5181c78f31ce9618fead2e5e37.png" alt="{\bf w}_R = \left( \begin{array}{c}
    \rho \\
    \rho u_1 \\
    0 \\
    0 \\
    E \\
\end{array} \right)" /></p>
</div><p>Now we need to calculate <img class="math" src="../../_images/math/137aa4d85fa78681be420bc6012483d02e62c060.png" alt="{\bf A}^-"/>. First we write:</p>
<div class="math">
<p><img src="../../_images/math/02dfdfa577d01e38596570b0e628473756140bf2.png" alt="{\bf A}_x = {\bf R}{\bf D}_x{\bf R}^{-1}

{\bf A}_x^- = {\bf R}{\bf D}_x^-{\bf R}^{-1}

{\bf D}_x({\bf w}) = {w_1\over w_0}\one +
\diag(-c, 0, 0, 0, c)
=
\left( \begin{array}{ccccc}
    u_1-c &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; u_1 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; u_1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; u_1 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; u_1 + c \\
\end{array} \right)

{\bf D}_x({\bf w})^- =\begin{cases}
\diag({w_1\over w_0}-c, {w_1\over w_0}, {w_1\over w_0}, {w_1\over w_0}, 0)
    &amp; w_1 &lt; 0\cr
\diag({w_1\over w_0}-c, 0, 0, 0, 0) &amp; w_1 &gt; 0\cr
\end{cases}" /></p>
</div><p>Explicit forms of the matrices:</p>
<div class="math">
<p><img src="../../_images/math/77e8417c82cbff47b6d42538f85772b06ceb7638.png" alt="{\bf R} = \left(\begin{smallmatrix}1 &amp; 1 &amp; 1 &amp; 1 &amp; 1\\u - c &amp; u &amp; u &amp; u &amp; c + u\\v &amp; v &amp; v - c &amp; v &amp; v\\w &amp; w &amp; w &amp; w - c &amp; w\\- c u - \frac{c^{2}}{1 - \kappa} + \frac{1}{2} u^{2} + \frac{1}{2} v^{2} + \frac{1}{2} w^{2} &amp; \frac{1}{2} u^{2} + \frac{1}{2} v^{2} + \frac{1}{2} w^{2} &amp; - c v + \frac{1}{2} u^{2} + \frac{1}{2} v^{2} + \frac{1}{2} w^{2} &amp; - c w + \frac{1}{2} u^{2} + \frac{1}{2} v^{2} + \frac{1}{2} w^{2} &amp; c u - \frac{c^{2}}{1 - \kappa} + \frac{1}{2} u^{2} + \frac{1}{2} v^{2} + \frac{1}{2} w^{2}\end{smallmatrix}\right)

{\bf R}^{-1} = {1\over c^2} \left(\begin{smallmatrix}\frac{1}{2} c u - \frac{1}{4} u^{2} - \frac{1}{4} v^{2} - \frac{1}{4} w^{2} + \frac{1}{4} \kappa u^{2} + \frac{1}{4} \kappa v^{2} + \frac{1}{4} \kappa w^{2} &amp; \frac{1}{2} u - \frac{1}{2} c - \frac{1}{2} \kappa u &amp; \frac{1}{2} v - \frac{1}{2} \kappa v &amp; \frac{1}{2} w - \frac{1}{2} \kappa w &amp; - \frac{1}{2} + \frac{1}{2} \kappa\\- c v - c w + c^{2} + \frac{1}{2} u^{2} + \frac{1}{2} v^{2} + \frac{1}{2} w^{2} - \frac{1}{2} \kappa u^{2} - \frac{1}{2} \kappa v^{2} - \frac{1}{2} \kappa w^{2} &amp; - u + \kappa u &amp; c - v + \kappa v &amp; c - w + \kappa w &amp; 1 - \kappa\\c v &amp; 0 &amp; - c &amp; 0 &amp; 0\\c w &amp; 0 &amp; 0 &amp; - c &amp; 0\\- \frac{1}{2} c u - \frac{1}{4} u^{2} - \frac{1}{4} v^{2} - \frac{1}{4} w^{2} + \frac{1}{4} \kappa u^{2} + \frac{1}{4} \kappa v^{2} + \frac{1}{4} \kappa w^{2} &amp; \frac{1}{2} c + \frac{1}{2} u - \frac{1}{2} \kappa u &amp; \frac{1}{2} v - \frac{1}{2} \kappa v &amp; \frac{1}{2} w - \frac{1}{2} \kappa w &amp; - \frac{1}{2} + \frac{1}{2} \kappa\end{smallmatrix}\right)

{\bf D}_x = \left(\begin{smallmatrix}u - c &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; u &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; u &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; u &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; c + u\end{smallmatrix}\right)

{\bf A}_x = \left(\begin{smallmatrix}0 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\- \frac{3}{2} u^{2} - \frac{1}{2} v^{2} - \frac{1}{2} w^{2} + \frac{1}{2} \kappa u^{2} + \frac{1}{2} \kappa v^{2} + \frac{1}{2} \kappa w^{2} &amp; 3 u - \kappa u &amp; v - \kappa v &amp; w - \kappa w &amp; -1 + \kappa\\- u v &amp; v &amp; u &amp; 0 &amp; 0\\- u w &amp; w &amp; 0 &amp; u &amp; 0\\\frac{- 2 u v^{2} - 2 u w^{2} + 2 u c^{2} - u \kappa^{2} v^{2} - u \kappa^{2} w^{2} + 3 \kappa u v^{2} + 3 \kappa u w^{2} - 2 u^{3} - \kappa^{2} u^{3} + 3 \kappa u^{3}}{2 - 2 \kappa} &amp; \frac{v^{2} + w^{2} - 2 c^{2} + 3 u^{2} - \kappa v^{2} - \kappa w^{2} - 5 \kappa u^{2} + 2 \kappa^{2} u^{2}}{2 - 2 \kappa} &amp; u v - \kappa u v &amp; u w - \kappa u w &amp; \kappa u\end{smallmatrix}\right)" /></p>
</div><p>For <img class="math" src="../../_images/math/2345fbac899139900c601486d2cb050e2091d253.png" alt="u_1&lt;0"/>:</p>
<div class="math">
<p><img src="../../_images/math/09394caa21b4d95ed307687c0ea041d6f0dbd8cb.png" alt="{\bf D}_x^- = \left(\begin{smallmatrix}u - c &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; u &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; u &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; u &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\end{smallmatrix}\right)

{\bf A}_x^- = \left(\begin{smallmatrix}\frac{2 c v^{2} + 2 c w^{2} + 2 u v^{2} + 2 u w^{2} + 4 u c^{2} + 6 c u^{2} - 2 c \kappa u^{2} - 2 c \kappa v^{2} - 2 c \kappa w^{2} - 2 \kappa u v^{2} - 2 \kappa u w^{2} + 2 u^{3} - 2 \kappa u^{3}}{8 c^{2}} &amp; \frac{- 2 c u + c \kappa u + c^{2} - u^{2} + \kappa u^{2}}{2 c^{2}} &amp; \frac{- c v - u v + c \kappa v + \kappa u v}{2 c^{2}} &amp; \frac{- c w - u w + c \kappa w + \kappa u w}{2 c^{2}} &amp; \frac{c + u - c \kappa - \kappa u}{2 c^{2}}\\\frac{- 2 c^{2} u^{2} - 2 c^{2} v^{2} - 2 c^{2} w^{2} + 2 u^{2} v^{2} + 2 u^{2} w^{2} - 2 \kappa u^{2} v^{2} - 2 \kappa u^{2} w^{2} + 2 \kappa c^{2} u^{2} + 2 \kappa c^{2} v^{2} + 2 \kappa c^{2} w^{2} + 4 c u v^{2} + 4 c u w^{2} - 4 c \kappa u v^{2} - 4 c \kappa u w^{2} + 4 u c^{3} + 8 c u^{3} - 4 c \kappa u^{3} + 2 u^{4} - 2 \kappa u^{4}}{8 c^{2}} &amp; \frac{- 3 c u^{2} + 3 u c^{2} - \kappa u c^{2} + 2 c \kappa u^{2} - c^{3} - u^{3} + \kappa u^{3}}{2 c^{2}} &amp; \frac{- 2 c u v + 2 c \kappa u v + v c^{2} - v u^{2} + \kappa v u^{2} - \kappa v c^{2}}{2 c^{2}} &amp; \frac{- 2 c u w + 2 c \kappa u w + w c^{2} - w u^{2} + \kappa w u^{2} - \kappa w c^{2}}{2 c^{2}} &amp; \frac{2 c u - 2 c \kappa u + u^{2} - c^{2} + \kappa c^{2} - \kappa u^{2}}{2 c^{2}}\\\frac{- 4 u v c^{2} + 2 c v w^{2} + 2 u v w^{2} + 6 c v u^{2} - 2 c \kappa v u^{2} - 2 c \kappa v w^{2} - 2 \kappa u v w^{2} + 2 c v^{3} + 2 u v^{3} + 2 v u^{3} - 2 c \kappa v^{3} - 2 \kappa u v^{3} - 2 \kappa v u^{3}}{8 c^{2}} &amp; \frac{- 2 c u v + c \kappa u v + v c^{2} - v u^{2} + \kappa v u^{2}}{2 c^{2}} &amp; \frac{- c v^{2} - u v^{2} + 2 u c^{2} + c \kappa v^{2} + \kappa u v^{2}}{2 c^{2}} &amp; \frac{- c v w - u v w + c \kappa v w + \kappa u v w}{2 c^{2}} &amp; \frac{c v + u v - c \kappa v - \kappa u v}{2 c^{2}}\\\frac{- 4 u w c^{2} + 2 c w v^{2} + 2 u w v^{2} + 6 c w u^{2} - 2 c \kappa w u^{2} - 2 c \kappa w v^{2} - 2 \kappa u w v^{2} + 2 c w^{3} + 2 u w^{3} + 2 w u^{3} - 2 c \kappa w^{3} - 2 \kappa u w^{3} - 2 \kappa w u^{3}}{8 c^{2}} &amp; \frac{- 2 c u w + c \kappa u w + w c^{2} - w u^{2} + \kappa w u^{2}}{2 c^{2}} &amp; \frac{- c v w - u v w + c \kappa v w + \kappa u v w}{2 c^{2}} &amp; \frac{- c w^{2} - u w^{2} + 2 u c^{2} + c \kappa w^{2} + \kappa u w^{2}}{2 c^{2}} &amp; \frac{c w + u w - c \kappa w - \kappa u w}{2 c^{2}}\\\frac{- 2 c^{3} u^{2} - 2 c^{3} v^{2} - 2 c^{3} w^{2} + 2 u^{3} v^{2} + 2 u^{3} w^{2} - 6 u c^{2} v^{2} - 6 u c^{2} w^{2} - 4 \kappa u^{3} v^{2} - 4 \kappa u^{3} w^{2} - 2 \kappa c^{3} u^{2} + 2 c v^{2} w^{2} + 2 \kappa c^{3} v^{2} + 2 \kappa c^{3} w^{2} + 2 u v^{2} w^{2} + 2 \kappa^{2} u^{3} v^{2} + 2 \kappa^{2} u^{3} w^{2} + 6 c u^{2} v^{2} + 6 c u^{2} w^{2} - 10 c \kappa u^{2} v^{2} - 10 c \kappa u^{2} w^{2} - 4 c \kappa v^{2} w^{2} - 4 \kappa u v^{2} w^{2} - 2 u c^{2} \kappa^{2} v^{2} - 2 u c^{2} \kappa^{2} w^{2} + 2 c \kappa^{2} v^{2} w^{2} + 2 u \kappa^{2} v^{2} w^{2} + 4 c \kappa^{2} u^{2} v^{2} + 4 c \kappa^{2} u^{2} w^{2} + 8 \kappa u c^{2} v^{2} + 8 \kappa u c^{2} w^{2} - 2 c^{2} u^{3} - 2 c^{2} \kappa^{2} u^{3} + 4 \kappa c^{2} u^{3} + c v^{4} + c w^{4} + u v^{4} + u w^{4} + 4 u c^{4} + 5 c u^{4} + c \kappa^{2} v^{4} + c \kappa^{2} w^{4} + u \kappa^{2} v^{4} + u \kappa^{2} w^{4} - 8 c \kappa u^{4} - 2 c \kappa v^{4} - 2 c \kappa w^{4} - 2 \kappa u v^{4} - 2 \kappa u w^{4} + 3 c \kappa^{2} u^{4} + u^{5} + \kappa^{2} u^{5} - 2 \kappa u^{5}}{8 c^{2} - 8 \kappa c^{2}} &amp; \frac{c^{2} v^{2} + c^{2} w^{2} - u^{2} v^{2} - u^{2} w^{2} + 3 c^{2} u^{2} - \kappa c^{2} v^{2} - \kappa c^{2} w^{2} - \kappa^{2} u^{2} v^{2} - \kappa^{2} u^{2} w^{2} - 5 \kappa c^{2} u^{2} - 2 c u v^{2} - 2 c u w^{2} + 2 \kappa u^{2} v^{2} + 2 \kappa u^{2} w^{2} + 2 c^{2} \kappa^{2} u^{2} - c u \kappa^{2} v^{2} - c u \kappa^{2} w^{2} + 3 c \kappa u v^{2} + 3 c \kappa u w^{2} - 4 c u^{3} + 2 u c^{3} - 3 c \kappa^{2} u^{3} + 7 c \kappa u^{3} - u^{4} - 2 c^{4} - \kappa^{2} u^{4} + 2 \kappa u^{4}}{4 c^{2} - 4 \kappa c^{2}} &amp; \frac{- 6 c v u^{2} - 2 c v w^{2} - 2 u v w^{2} + 8 u v c^{2} - 4 \kappa u v c^{2} + 2 c \kappa v w^{2} + 2 \kappa u v w^{2} + 6 c \kappa v u^{2} - 2 c v^{3} - 2 u v^{3} - 2 v u^{3} + 4 v c^{3} + 2 c \kappa v^{3} + 2 \kappa u v^{3} + 2 \kappa v u^{3}}{8 c^{2}} &amp; \frac{- 6 c w u^{2} - 2 c w v^{2} - 2 u w v^{2} + 8 u w c^{2} - 4 \kappa u w c^{2} + 2 c \kappa w v^{2} + 2 \kappa u w v^{2} + 6 c \kappa w u^{2} - 2 c w^{3} - 2 u w^{3} - 2 w u^{3} + 4 w c^{3} + 2 c \kappa w^{3} + 2 \kappa u w^{3} + 2 \kappa w u^{3}}{8 c^{2}} &amp; \frac{2 c v^{2} + 2 c w^{2} + 2 u v^{2} + 2 u w^{2} + 6 c u^{2} - 6 c \kappa u^{2} - 2 c \kappa v^{2} - 2 c \kappa w^{2} - 2 \kappa u v^{2} - 2 \kappa u w^{2} + 4 \kappa u c^{2} - 4 c^{3} + 2 u^{3} - 2 \kappa u^{3}}{8 c^{2}}\end{smallmatrix}\right)" /></p>
</div><p>For <img class="math" src="../../_images/math/77b7e35d59e7d00b1fda875abee350727bdb3ec8.png" alt="u_1&gt;0"/>:</p>
<div class="math">
<p><img src="../../_images/math/5bb1e45c97fd074aa65261c6b6973814a8451054.png" alt="{\bf D}_x^- = \left(\begin{smallmatrix}u - c &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\end{smallmatrix}\right)

{\bf A}_x^- = \left(\begin{smallmatrix}\frac{- 4 u c^{2} - 2 u v^{2} - 2 u w^{2} + 2 c v^{2} + 2 c w^{2} + 6 c u^{2} - 2 c \kappa u^{2} - 2 c \kappa v^{2} - 2 c \kappa w^{2} + 2 \kappa u v^{2} + 2 \kappa u w^{2} - 2 u^{3} + 2 \kappa u^{3}}{8 c^{2}} &amp; \frac{- 2 c u + c \kappa u + c^{2} + u^{2} - \kappa u^{2}}{2 c^{2}} &amp; \frac{u v - c v + c \kappa v - \kappa u v}{2 c^{2}} &amp; \frac{u w - c w + c \kappa w - \kappa u w}{2 c^{2}} &amp; \frac{c - u + \kappa u - c \kappa}{2 c^{2}}\\\frac{- 10 c^{2} u^{2} - 2 c^{2} v^{2} - 2 c^{2} w^{2} - 2 u^{2} v^{2} - 2 u^{2} w^{2} + 2 \kappa c^{2} u^{2} + 2 \kappa c^{2} v^{2} + 2 \kappa c^{2} w^{2} + 2 \kappa u^{2} v^{2} + 2 \kappa u^{2} w^{2} + 4 c u v^{2} + 4 c u w^{2} - 4 c \kappa u v^{2} - 4 c \kappa u w^{2} + 4 u c^{3} + 8 c u^{3} - 4 c \kappa u^{3} - 2 u^{4} + 2 \kappa u^{4}}{8 c^{2}} &amp; \frac{- 3 c u^{2} + 3 u c^{2} - \kappa u c^{2} + 2 c \kappa u^{2} + u^{3} - c^{3} - \kappa u^{3}}{2 c^{2}} &amp; \frac{- 2 c u v + 2 c \kappa u v + v c^{2} + v u^{2} - \kappa v c^{2} - \kappa v u^{2}}{2 c^{2}} &amp; \frac{- 2 c u w + 2 c \kappa u w + w c^{2} + w u^{2} - \kappa w c^{2} - \kappa w u^{2}}{2 c^{2}} &amp; \frac{2 c u - 2 c \kappa u - c^{2} - u^{2} + \kappa c^{2} + \kappa u^{2}}{2 c^{2}}\\\frac{- 4 u v c^{2} - 2 u v w^{2} + 2 c v w^{2} + 6 c v u^{2} - 2 c \kappa v u^{2} - 2 c \kappa v w^{2} + 2 \kappa u v w^{2} - 2 u v^{3} - 2 v u^{3} + 2 c v^{3} - 2 c \kappa v^{3} + 2 \kappa u v^{3} + 2 \kappa v u^{3}}{8 c^{2}} &amp; \frac{- 2 c u v + c \kappa u v + v c^{2} + v u^{2} - \kappa v u^{2}}{2 c^{2}} &amp; \frac{u v^{2} - c v^{2} + c \kappa v^{2} - \kappa u v^{2}}{2 c^{2}} &amp; \frac{u v w - c v w + c \kappa v w - \kappa u v w}{2 c^{2}} &amp; \frac{c v - u v + \kappa u v - c \kappa v}{2 c^{2}}\\\frac{- 4 u w c^{2} - 2 u w v^{2} + 2 c w v^{2} + 6 c w u^{2} - 2 c \kappa w u^{2} - 2 c \kappa w v^{2} + 2 \kappa u w v^{2} - 2 u w^{3} - 2 w u^{3} + 2 c w^{3} - 2 c \kappa w^{3} + 2 \kappa u w^{3} + 2 \kappa w u^{3}}{8 c^{2}} &amp; \frac{- 2 c u w + c \kappa u w + w c^{2} + w u^{2} - \kappa w u^{2}}{2 c^{2}} &amp; \frac{u v w - c v w + c \kappa v w - \kappa u v w}{2 c^{2}} &amp; \frac{u w^{2} - c w^{2} + c \kappa w^{2} - \kappa u w^{2}}{2 c^{2}} &amp; \frac{c w - u w + \kappa u w - c \kappa w}{2 c^{2}}\\\frac{- 2 c^{3} u^{2} - 2 c^{3} v^{2} - 2 c^{3} w^{2} - 2 u^{3} v^{2} - 2 u^{3} w^{2} - 2 \kappa c^{3} u^{2} - 2 u c^{2} v^{2} - 2 u c^{2} w^{2} - 2 u v^{2} w^{2} - 2 \kappa^{2} u^{3} v^{2} - 2 \kappa^{2} u^{3} w^{2} + 2 c v^{2} w^{2} + 2 \kappa c^{3} v^{2} + 2 \kappa c^{3} w^{2} + 4 \kappa u^{3} v^{2} + 4 \kappa u^{3} w^{2} + 6 c u^{2} v^{2} + 6 c u^{2} w^{2} - 10 c \kappa u^{2} v^{2} - 10 c \kappa u^{2} w^{2} - 4 c \kappa v^{2} w^{2} - 2 u c^{2} \kappa^{2} v^{2} - 2 u c^{2} \kappa^{2} w^{2} - 2 u \kappa^{2} v^{2} w^{2} + 2 c \kappa^{2} v^{2} w^{2} + 4 c \kappa^{2} u^{2} v^{2} + 4 c \kappa^{2} u^{2} w^{2} + 4 \kappa u c^{2} v^{2} + 4 \kappa u c^{2} w^{2} + 4 \kappa u v^{2} w^{2} - 6 c^{2} u^{3} - 2 c^{2} \kappa^{2} u^{3} + 8 \kappa c^{2} u^{3} + c v^{4} + c w^{4} - u v^{4} - u w^{4} + 4 u c^{4} + 5 c u^{4} + c \kappa^{2} v^{4} + c \kappa^{2} w^{4} - u \kappa^{2} v^{4} - u \kappa^{2} w^{4} - 8 c \kappa u^{4} - 2 c \kappa v^{4} - 2 c \kappa w^{4} + 2 \kappa u v^{4} + 2 \kappa u w^{4} + 3 c \kappa^{2} u^{4} - u^{5} - \kappa^{2} u^{5} + 2 \kappa u^{5}}{8 c^{2} - 8 \kappa c^{2}} &amp; \frac{c^{2} v^{2} + c^{2} w^{2} + u^{2} v^{2} + u^{2} w^{2} + 3 c^{2} u^{2} + \kappa^{2} u^{2} v^{2} + \kappa^{2} u^{2} w^{2} - \kappa c^{2} v^{2} - \kappa c^{2} w^{2} - 5 \kappa c^{2} u^{2} - 2 c u v^{2} - 2 c u w^{2} - 2 \kappa u^{2} v^{2} - 2 \kappa u^{2} w^{2} + 2 c^{2} \kappa^{2} u^{2} - c u \kappa^{2} v^{2} - c u \kappa^{2} w^{2} + 3 c \kappa u v^{2} + 3 c \kappa u w^{2} - 4 c u^{3} + 2 u c^{3} - 3 c \kappa^{2} u^{3} + 7 c \kappa u^{3} + u^{4} - 2 c^{4} + \kappa^{2} u^{4} - 2 \kappa u^{4}}{4 c^{2} - 4 \kappa c^{2}} &amp; \frac{- 6 c v u^{2} - 2 c v w^{2} + 2 u v w^{2} - 4 \kappa u v c^{2} - 2 \kappa u v w^{2} + 2 c \kappa v w^{2} + 6 c \kappa v u^{2} - 2 c v^{3} + 2 u v^{3} + 2 v u^{3} + 4 v c^{3} - 2 \kappa u v^{3} - 2 \kappa v u^{3} + 2 c \kappa v^{3}}{8 c^{2}} &amp; \frac{- 6 c w u^{2} - 2 c w v^{2} + 2 u w v^{2} - 4 \kappa u w c^{2} - 2 \kappa u w v^{2} + 2 c \kappa w v^{2} + 6 c \kappa w u^{2} - 2 c w^{3} + 2 u w^{3} + 2 w u^{3} + 4 w c^{3} - 2 \kappa u w^{3} - 2 \kappa w u^{3} + 2 c \kappa w^{3}}{8 c^{2}} &amp; \frac{- 2 u v^{2} - 2 u w^{2} + 2 c v^{2} + 2 c w^{2} + 6 c u^{2} - 6 c \kappa u^{2} - 2 c \kappa v^{2} - 2 c \kappa w^{2} + 2 \kappa u v^{2} + 2 \kappa u w^{2} + 4 \kappa u c^{2} - 4 c^{3} - 2 u^{3} + 2 \kappa u^{3}}{8 c^{2}}\end{smallmatrix}\right)" /></p>
</div><div class="section" id="boundary-conditions-for-the-sea-breeze-model">
<h3>Boundary Conditions for the Sea Breeze Model<a class="headerlink" href="#boundary-conditions-for-the-sea-breeze-model" title="Permalink to this headline">¶</a></h3>
<p>In the boundary (line) integral we prescribe <img class="math" src="../../_images/math/acaefef7ef0b1eecb5966c2ba80f7597bd7f4844.png" alt="w_3^{n+1}"/> using a Dirichlet
condition and calculate it at each iteration using:</p>
<div class="math">
<p><img src="../../_images/math/59918b9d4dc504dd7eb9ea338dbe01589b8556be.png" alt="w_3^{n+1} = E = \rho T c_v + \half \rho u^2 = w_0 T c_v +
    {w_1^2+w_2^2\over 2w_0}" /></p>
</div><p>where <img class="math" src="../../_images/math/03495b3b1b09ec4c6247d56444917a48b790936c.png" alt="T(t)"/> is a known function of time (it changes with the day and night)
and also prescribe <img class="math" src="../../_images/math/581fa65e732777ecfda03d46ec11288dbe036f72.png" alt="w_1^{n+1}=0"/> on the left and right end of the domain and
<img class="math" src="../../_images/math/e93a3c5f0e389f9777f0cd699032dd3f08d74e73.png" alt="w_2^{n+1}=0"/> at the top and bottom.</p>
<p>All the surface integrals turn out to be zero. On the top and bottom edges we
have <img class="math" src="../../_images/math/19d0bf40a608ce22d7108d3a9f0cd30410e11bb6.png" alt="{\bf n} = (n_x, n_y) = (0, \pm 1)"/> respectively and we prescribe <img class="math" src="../../_images/math/3074e1d0a459cbd63eae3a8a1979d72be7ee3fcc.png" alt="w_2=0"/>,
so we get (remember we do not sum over <img class="math" src="../../_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/>):</p>
<div class="math">
<p><img src="../../_images/math/0bbaf18fc841d82cb28441b43c0854eef2c8c3d8.png" alt="\int_{\partial\Omega}
\left({\bf A}_x({\bf w}^n)\right)_{ij}w_j
    \varphi^i\, n_x
+ \left({\bf A}_y({\bf w}^n)\right)_{ij}w_j
    \varphi^i\, n_y
\ \d x
=

=
\int_{\partial\Omega}
\left({\bf f}_x({\bf w}^n)\right)_i
    \varphi^i\, n_x
+ \left({\bf f}_y({\bf w}^n)\right)_i
    \varphi^i\, n_y
\ \d x
=

=
\pm\int_{\partial\Omega}
\left({\bf f}_y({\bf w}^n)\right)_i
    \varphi^i
\ \d x" /></p>
</div><p>where:</p>
<div class="math">
<p><img src="../../_images/math/15f822478d912282aa9bcd807893a8f32918ea1d.png" alt="{\bf f}_y =
   \left( \begin{array}{c}
       w_2\\
       \frac{w_2w_1}{w_0}\\
       \frac{w_2^2}{w_0} + p\\
       \frac{w_2}{w_0}(w_3+p)
   \end{array} \right)
   =
   \left( \begin{array}{c}
       0\\
       0\\
       p\\
       0
   \end{array} \right)" /></p>
</div><p>So all the components <img class="math" src="../../_images/math/ac2672e1a8c8ecccb025d7840b91c293baa618f1.png" alt="i\neq 3"/> of the surface integral are zero, and for <img class="math" src="../../_images/math/a4566e11dab22bafa7c82220f54e440ef4437ff3.png" alt="i=3"/>
the test function <img class="math" src="../../_images/math/2934a49b0a0783f5c9d10777cb991b3715934e8d.png" alt="\varphi^3"/> is not there, because we prescribe the Dirichlet
BC <img class="math" src="../../_images/math/f77f46122a46795b6d010537b8f797ac319f46b2.png" alt="w^3=0"/>, so the surface integral vanishes for all <img class="math" src="../../_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/>.</p>
<p>Similarly on the left and right edges we
have <img class="math" src="../../_images/math/c93da31e0bf66de6aa0b872f1d032c79df9399ee.png" alt="{\bf n} = (n_x, n_y) = (\pm1, 0)"/> respectively and we prescribe <img class="math" src="../../_images/math/b83c811471a225edd7c39a99941731be34f6dfc6.png" alt="w_1=0"/>,
so we get (remember we do not sum over <img class="math" src="../../_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/>):</p>
<div class="math">
<p><img src="../../_images/math/d1b741951e91cf97db97b1dcfaf75c0bda5acd3c.png" alt="\int_{\partial\Omega}
\left({\bf A}_x({\bf w}^n)\right)_{ij}w_j
    \varphi^i\, n_x
+ \left({\bf A}_y({\bf w}^n)\right)_{ij}w_j
    \varphi^i\, n_y
\ \d x
=

=
\int_{\partial\Omega}
\left({\bf f}_x({\bf w}^n)\right)_i
    \varphi^i\, n_x
+ \left({\bf f}_y({\bf w}^n)\right)_i
    \varphi^i\, n_y
\ \d x
=

=
\pm\int_{\partial\Omega}
\left({\bf f}_x({\bf w}^n)\right)_i
    \varphi^i
\ \d x" /></p>
</div><p>where:</p>
<div class="math">
<p><img src="../../_images/math/d90b64a6f6c1c760bb3bed99d116b485a42e8862.png" alt="{\bf f}_x =
   \left( \begin{array}{c}
       w_1\\
       \frac{w_1^2}{w_0} + p\\
       \frac{w_1w_2}{w_0}\\
       \frac{w_1}{w_0}(w_3+p)
   \end{array} \right)
   =
   \left( \begin{array}{c}
       0\\
       p\\
       0\\
       0
   \end{array} \right)" /></p>
</div><p>So all the components <img class="math" src="../../_images/math/16ab72a216b4eca45191b1e7ce387106054a50e8.png" alt="i\neq 1"/> of the surface integral are zero, and for <img class="math" src="../../_images/math/50ed4b89a6aeb4814026a2be01bde8bd7d264b71.png" alt="i=1"/>
the test function <img class="math" src="../../_images/math/1e96a4ba79a4820a81ebde8c109ba0ea3aba296a.png" alt="\varphi^1"/> is not there, because we prescribe the Dirichlet
BC <img class="math" src="../../_images/math/a1465f1b6e0f5aaf7e71db9e688b7a465b0491db.png" alt="w^1=0"/>, so the surface integral vanishes for all <img class="math" src="../../_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/>.</p>
</div>
</div>
<div class="section" id="newton-method">
<h2>Newton Method<a class="headerlink" href="#newton-method" title="Permalink to this headline">¶</a></h2>
<p>The residual is:</p>
<div class="math">
<p><img src="../../_images/math/5db82e5802a7ffd30f5ac98cc5b8307369f39b53.png" alt="F_{i,m}(Y^{n+1}) = \int_\Omega {w_{i,m}(y_m^{n+1}) - w_{i,m}(y^n)\over\tau}
    \varphi_{i, m}
    -f_{x,m}(w(y^n)){\partial \varphi_{i, m}\over\partial x}
    -f_{y,m}(w(y^n)){\partial \varphi_{i, m}\over\partial y}
    +\delta_{3, m} g \varphi_{i, m} \,\d x\, \d y
    +

- \int_{\partial\Omega}
    f_{x,m}(w(y^n))\varphi_{i, m}\nu_x
    +f_{y,m}(w(y^n))\varphi_{i, m}\nu_y
    \,
    \d S = 0" /></p>
</div><p>where <img class="math" src="../../_images/math/131ee29d8a0a2c11b5c024f942ad9778abb9ad3f.png" alt="m = 0, 1, 2, 4"/> numbers the equations, <img class="math" src="../../_images/math/ef63f5c08c018266f9743332483de7145e5827a2.png" alt="i = 1, 2, ..., M"/> numbers the
finite element basis functions, <img class="math" src="../../_images/math/51ee78bf1aed1abd2ed03f955783a7e2da63e00d.png" alt="N = 4M"/>,
<img class="math" src="../../_images/math/1abdf7c42f62575b2a8c042b97ef7ba61250b7f6.png" alt="Y = (y_0^1, y_1^1, y_2^1, y_3^1, y_0^2, y_1^2, ...)"/>.
The Jacobian is:</p>
<div class="math">
<p><img src="../../_images/math/baff1e844f164dbbc7c1dd473b9e65d7536317c8.png" alt="J(Y^n) = {\partial F_{i, m}\over\partial y_{r, s}} (Y^n) =
    \int_\Omega {\varphi_{r, s}\over\tau} \varphi_{i, m}
    -A_{x, m, s}(w(y^n)) \varphi_{r, s} {\partial\varphi_{i,
    m}\over\partial x}
    -A_{y, m, s}(w(y^n)) \varphi_{r, s} {\partial\varphi_{i,
    m}\over\partial y}
    \,\d x\,\d y

    +
    \int_{\partial\Omega}
    A_{x, m, s}(w(y^n)) \varphi_{r, s} \varphi_{i, m}\nu_x
    +
    A_{y, m, s}(w(y^n)) \varphi_{r, s} \varphi_{i, m}\nu_y
    \,\d S" /></p>
</div><p>And the Newton method then is:</p>
<div class="math">
<p><img src="../../_images/math/c18e6abad3aefd253c5ac07b89f851d30dd8494b.png" alt="J(Y^n) \delta Y^{n+1} = -F(Y^n)" /></p>
</div></div>
<div class="section" id="older-notes">
<h2>Older notes<a class="headerlink" href="#older-notes" title="Permalink to this headline">¶</a></h2>
<p>Author: Pavel Solin</p>
<div class="section" id="governing-equations-and-boundary-conditions">
<h3>Governing Equations and Boundary Conditions<a class="headerlink" href="#governing-equations-and-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<div class="math" id="equation-one">
<p><span class="eqno">(3)</span><img src="../../_images/math/84910087e1617188944538f5d757c90d81fc5785.png" alt="\frac{\partial}{\partial t} \left( \begin{array}{c} \varrho\\ U\\ W\\
   \theta \end{array} \right) + \frac{\partial}{\partial x} \left(
   \begin{array}{c} U\\ \frac{U^2}{\varrho} + R\theta\\
   \frac{UW}{\varrho}\\ \frac{\theta U}{\varrho} \end{array} \right) +
   \frac{\partial}{\partial z} \left( \begin{array}{c} W\\
   \frac{UW}{\varrho}\\ \frac{W^2}{\varrho} + R\theta\\ \frac{\theta
   W}{\varrho} \end{array} \right) + \left( \begin{array}{c} 0\\ 0\\
   \varrho g\\ \frac{R\theta}{c_v}\mbox{div}{\bf v} \end{array} \right) =
   \left( \begin{array}{c} 0\\ 0\\ 0\\ 0 \end{array} \right)," /></p>
</div><p>where <img class="math" src="../../_images/math/e7fe4fc87a1b38d0b6f1f34da3c84a3fd3cb64c6.png" alt="\varrho"/> is the air density, <img class="math" src="../../_images/math/87fa0e09e02d0d3cc96225398eb8850c3f1c7fd6.png" alt="{\bf v} = (u,w)"/> is the velocity, <img class="math" src="../../_images/math/61674d0577c296d0ed7f1cc23e172a57edf53359.png" alt="U =
\varrho u"/>, <img class="math" src="../../_images/math/55a73be8b9941ee57f23caef9446c140de378265.png" alt="W = \varrho w"/>, <img class="math" src="../../_images/math/2554b6496c3b678897e9b060ef00aa9f0a7d7ece.png" alt="T"/> is the temperature, <img class="math" src="../../_images/math/99a3bc63af573497d219fecea2ca37f2e3a20aa0.png" alt="\theta = \varrho T"/>, and
<img class="math" src="../../_images/math/311cabda3a9b09f0dde217303ca9d1cd9201dcf6.png" alt="g"/> is the gravitational acceleration constant.  We use the perfect gas state
equation <img class="math" src="../../_images/math/006343386334ce6bcdfad73d55ae1b3a60cf0ccd.png" alt="p = \varrho R T = R \theta"/> for the pressure.</p>
<p>Boundary conditions are prescribed as follows:</p>
<ul class="simple">
<li>edge <img class="math" src="../../_images/math/c7d457e388298246adb06c587bccd419ea67f7e8.png" alt="a"/>: <img class="math" src="../../_images/math/6cb80fe754c6dfa660a36f4a57196463bae3955c.png" alt="\partial \varrho / \partial \nu = 0"/>, <img class="math" src="../../_images/math/d0699a49e53c981f14be767867e4e1a089867618.png" alt="\partial U / \partial \nu = 0"/>, <img class="math" src="../../_images/math/d4ed02db4183787cd4b4756285f255e4a8fba0e3.png" alt="W = 0"/>, <img class="math" src="../../_images/math/259d735eb5a364c387c84fe64a49db4dd1c6a4ca.png" alt="\theta = \mbox{tanh}(x)*\mbox{sin}(\pi t /86400)"/></li>
<li>edges <img class="math" src="../../_images/math/8c9b1452aab72a3897a7921688449e11bf3dff28.png" alt="b, c"/>: <img class="math" src="../../_images/math/6cb80fe754c6dfa660a36f4a57196463bae3955c.png" alt="\partial \varrho / \partial \nu = 0"/>, <img class="math" src="../../_images/math/f822bdbce36011ce7b7af7ccd327c4388c9e313a.png" alt="U = 0"/>, <img class="math" src="../../_images/math/1c6d4b32aae386bd12f81f49dfcc6fcd2f3b7a20.png" alt="\partial W / \partial \nu = 0"/>, <img class="math" src="../../_images/math/52e6e9517ebf15977d5c5c77e3b8304d19cb4664.png" alt="\partial \theta/ \partial \nu = 0"/></li>
<li>edge <img class="math" src="../../_images/math/96ab646de7704969b91c76a214126b45f2b07b25.png" alt="d"/>: <img class="math" src="../../_images/math/6cb80fe754c6dfa660a36f4a57196463bae3955c.png" alt="\partial \varrho / \partial \nu = 0"/>, <img class="math" src="../../_images/math/d0699a49e53c981f14be767867e4e1a089867618.png" alt="\partial U / \partial \nu = 0"/>, <img class="math" src="../../_images/math/d4ed02db4183787cd4b4756285f255e4a8fba0e3.png" alt="W = 0"/>, <img class="math" src="../../_images/math/52e6e9517ebf15977d5c5c77e3b8304d19cb4664.png" alt="\partial \theta/ \partial \nu = 0"/></li>
</ul>
<p>Initial conditions have the form</p>
<div class="math">
<p><img src="../../_images/math/241829fb9bf6b59f3dc315f268f4614dd7ae021d.png" alt="\begin{eqnarray*} p(z) &amp;=&amp; p_0 - 11476\frac{z}{1000}  + 529.54 \left(\frac{z}{1000} \right)^2 - 9.38 \left(\frac{z}{1000} \right)^3,\\ T(z) &amp;=&amp; T_0 - 8.3194 \frac{z}{1000} + 0.2932 \left(\frac{z}{1000} \right)^2 - 0.0109 \left(\frac{z}{1000} \right)^3,\\ \varrho(z) &amp;=&amp; \frac{p(z)}{R T(z)},\\ \theta(z) &amp;=&amp; \varrho(z)T(z),\\ U(z) &amp;=&amp; 0, \\  W(z) &amp;=&amp; 0. \end{eqnarray*}" /></p>
</div></div>
<div class="section" id="discretization-and-the-newton-s-method">
<h3>Discretization and the Newton&#8217;s Method<a class="headerlink" href="#discretization-and-the-newton-s-method" title="Permalink to this headline">¶</a></h3>
<p>We will use the implicit Euler method in time, i.e.,</p>
<div class="math">
<p><img src="../../_images/math/9f8c7a43f132f7cc976ddc8438fa584d4d4f835b.png" alt="\frac{\partial \varrho}{\partial t} \approx \frac{\varrho^{n+1} - \varrho^n}{\tau}" /></p>
</div><p>etc. Let&#8217;s discuss one equation of <a href="#equation-one">(3)</a> at a time:</p>
<p><cite>Continuity equation</cite>:
The weak formulation of</p>
<div class="math">
<p><img src="../../_images/math/4707dce66688218c2d2a9b0fbea231d7ab2f1eec.png" alt="\frac{\varrho^{n+1} - \varrho^n}{\tau} + \frac{\partial U^{n+1}}{\partial x} + \frac{\partial W^{n+1}}{\partial z} = 0" /></p>
</div><p>reads</p>
<div class="math" id="equation-cont">
<p><span class="eqno">(4)</span><img src="../../_images/math/a6fd7af7049ddc562ff0e4f62334625f2448d15b.png" alt="F_i^{\varrho}(Y^{n+1}) = \int_{\Omega} \frac{\varrho^{n+1}}{\tau}
\varphi^{\varrho}_i
- \int_{\Omega} \frac{\varrho^{n}}{\tau} \varphi^{\varrho}_i
  + \int_{\Omega} \frac{\partial U^{n+1}}{\partial x} \varphi^{\varrho}_i
    + \int_{\Omega} \frac{\partial W^{n+1}}{\partial z} \varphi^{\varrho}_i = 0" /></p>
</div><p>The global coefficient vector <img class="math" src="../../_images/math/56261d82e783c9407fd48363dc4b78473da85b99.png" alt="Y^{n+1}"/> consists of four parts <img class="math" src="../../_images/math/eb7db6f57badbdb64fb8fc4a7e2c020fc87a17d2.png" alt="Y^{\varrho}"/>, <img class="math" src="../../_images/math/87ab5595e0f587c4dfdd5e50ff2de4c7cfbf6fae.png" alt="Y^{U}"/>, <img class="math" src="../../_images/math/33e3570558a112c849285e6b6e85765b1ec95995.png" alt="Y^{W}"/>
and <img class="math" src="../../_images/math/a291318ca6b35df3736f2d34893d4c83d27c59bd.png" alt="Y^{\theta}"/> corresponding to the fields <img class="math" src="../../_images/math/e7fe4fc87a1b38d0b6f1f34da3c84a3fd3cb64c6.png" alt="\varrho"/>, <img class="math" src="../../_images/math/e2bbebb3bd73f1ae5c64098ab0244f739abf7ca4.png" alt="U"/>, <img class="math" src="../../_images/math/10cb764f88509fb1c8012366993fdbee98f31bc5.png" alt="W"/> and <img class="math" src="../../_images/math/52e8ed7a3ba22130ad3984eb2cd413406475a689.png" alt="\theta"/>, respectively.
The same holds for the vector function <img class="math" src="../../_images/math/a055f405829e64a3b70253ab67cb45ed6ed5bb29.png" alt="F"/> which consists of four parts <img class="math" src="../../_images/math/fca9492caabae6de933463451e1cd5d4cd1838de.png" alt="F^{\varrho}"/>, <img class="math" src="../../_images/math/323b03c4e39800cc407cc8ad31cf288cd0603940.png" alt="F^{U}"/>, <img class="math" src="../../_images/math/0652fc66a530ad4d7b2b44d75fd7ff1d9184a5f7.png" alt="F^{W}"/>
and <img class="math" src="../../_images/math/f87ec54913ce4edb6b0705a8a9e4c75b43f6fed0.png" alt="F^{\theta}"/>. Thus the global Jacobi matrix will have a four-by-four block structure. We
denote</p>
<div class="math" id="equation-two">
<p><span class="eqno">(5)</span><img src="../../_images/math/14df39249e67c08adfdecfa5f375f6522e690e94.png" alt="\varrho^{n+1} = \sum_{k=1}^{N^{\varrho}} y^{\varrho}_k \varphi^{\varrho}_k, \ \
\
U^{n+1} = \sum_{k=1}^{N^{U}} y^{U}_k \varphi^{U}_k, \ \ \
W^{n+1} = \sum_{k=1}^{N^{W}} y^{W}_k \varphi^{W}_k, \ \ \
\theta^{n+1} = \sum_{k=1}^{N^{\theta}} y^{\theta}_k \varphi^{\theta}_k." /></p>
</div><p>It follows from <a href="#equation-cont">(4)</a> and <a href="#equation-two">(5)</a> that</p>
<div class="math">
<p><img src="../../_images/math/20b6654c05d4f49c306e032dcccb520c23a2a18f.png" alt="\frac{\partial F^{\varrho}_i}{\partial y^{\varrho}_j} = \int_{\Omega} \frac{\varphi^{\varrho}_j}{\tau} \varphi^{\varrho}_i, \ \ \ \frac{\partial F^{\varrho}_i}{\partial y^{U}_j} = \int_{\Omega} \frac{\partial \varphi^{U}_j}{\partial x} \varphi^{\varrho}_i, \ \ \ \frac{\partial F^{\varrho}_i}{\partial y^{W}_j} = \int_{\Omega} \frac{\partial \varphi^{W}_j}{\partial z} \varphi^{\varrho}_i, \ \ \ \frac{\partial F^{\varrho}_i}{\partial y^{W}_j} = 0." /></p>
</div><p><cite>First momentum equation</cite>: The second equation of <a href="#equation-one">(3)</a> has the form</p>
<div class="math">
<p><img src="../../_images/math/33cb83966ed9529e8a35af88ad3a01f90044dc3c.png" alt="\frac{\partial U}{\partial t} + \frac{2U}{\varrho}\frac{\partial U}{\partial x}  - \frac{U^2}{\varrho^2} \frac{\partial \varrho}{\partial x} + R\frac{\partial \theta}{\partial x} + \frac{W}{\varrho}\frac{\partial U}{\partial z} + \frac{U}{\varrho}\frac{\partial W}{\partial z} - \frac{UW}{\varrho^2}\frac{\partial \varrho}{\partial z} = 0." /></p>
</div><p>After applying the implicit Euler method, we obtain</p>
<div class="math">
<p><img src="../../_images/math/06c77e692cd600a13ed2975f611bfcb341ad0e42.png" alt="\frac{\partial U^{n+1}}{\tau} - \frac{\partial U^{n}}{\tau} + \frac{2U^{n+1}}{\varrho^{n+1}}\frac{\partial U^{n+1}}{\partial x}  - \frac{(U^{n+1})^2}{(\varrho^{n+1})^2} \frac{\partial \varrho^{n+1}}{\partial x} + R\frac{\partial \theta^{n+1}}{\partial x}" /></p>
</div><div class="math">
<p><img src="../../_images/math/ba015ce6c73b09d41c420a7f117fa92e77eb2166.png" alt="+ \frac{W^{n+1}}{\varrho^{n+1}}\frac{\partial U^{n+1}}{\partial z} + \frac{U^{n+1}}{\varrho^{n+1}}\frac{\partial W^{n+1}}{\partial z} - \frac{U^{n+1}W^{n+1}}{(\varrho^{n+1})^2}\frac{\partial \varrho^{n+1}}{\partial z} = 0." /></p>
</div><p>Thus we obtain</p>
<div class="math">
<p><img src="../../_images/math/5d90d16e21dfbf3a6741ef8ef79e4f97a0869b2e.png" alt="\frac{\partial F^{U}_i}{\partial y^{\varrho}_j} =  - \int_{\Omega}\frac{2U}{\varrho^2}\frac{\partial U}{\partial x} \varphi^{\varrho}_j \varphi^{U}_i  -  \int_{\Omega} U^2 \left[(-2)\frac{1}{\varrho^3}\frac{\partial \varrho}{\partial x} \varphi^{\varrho}_j  + \frac{1}{\varrho^2}\frac{\partial \varphi^{\varrho}_j}{\partial x}\right] \varphi^U_i" /></p>
</div><div class="math">
<p><img src="../../_images/math/05ee7307d6b8ab4999e104ea8d7708a17dbcaa1b.png" alt="+ \int_{\Omega} \frac{W}{\varrho^2}\frac{\partial U}{\partial z}(-1)\varphi^{\varrho}_j \varphi^U_i + \int_{\Omega} \frac{U}{\varrho^2}\frac{\partial W}{\partial z}(-1)\varphi^{\varrho}_j \varphi^U_i - \int_{\Omega} UW \left[(-2)\frac{1}{\varrho^3}\frac{\partial \varrho}{\partial z} \varphi^{\varrho}_j + \frac{1}{\varrho^2}\frac{\partial \varphi^{\varrho}_j}{\partial z} \right] \varphi^{U}_i." /></p>
</div><p>Analogously,</p>
<div class="math">
<p><img src="../../_images/math/b8699582395cf5566bcf10c9e90bfb7f12b9a61a.png" alt="\frac{\partial F^{U}_i}{\partial y^{U}_j} =  \int_{\Omega}\frac{\varphi^U_j}{\tau}\varphi^U_i + \int_{\Omega}\frac{2}{\varrho} \left[ \frac{\partial U}{\partial x}\varphi^U_j + U \frac{\partial \varphi^U_j}{\partial x} \right] \varphi^U_i - \int_{\Omega} \frac{2U}{\varrho^2}\frac{\partial \varrho}{\partial x} \varphi^U_j \varphi^U_i" /></p>
</div><div class="math">
<p><img src="../../_images/math/57045db9d573d34f04bb5301bc3dcfaf50feb759.png" alt="+ \int_{\Omega} \frac{W}{\varrho}\frac{\partial \varphi^U_j}{\partial z} \varphi^U_i  + \int_{\Omega} \frac{1}{\varrho}\frac{\partial W}{\partial z} \varphi^U_j \varphi^U_i  - \int_{\Omega} \frac{W}{\varrho^2}\frac{\partial \varrho}{\partial z} \varphi^U_j \varphi^U_i," /></p>
</div><div class="math">
<p><img src="../../_images/math/cc8b01a1baae61f322f7fcf422514171aee7b023.png" alt="\frac{\partial F^{U}_i}{\partial y^{W}_j} =  \int_{\Omega} \frac{1}{\varrho}\frac{\partial U}{\partial z} \varphi^W_j \varphi^U_i + \int_{\Omega} \frac{U}{\varrho}\frac{\partial \varphi^W_j}{\partial z} \varphi^U_i - \int_{\Omega} \frac{U}{\varrho^2}\frac{\partial \varrho}{\partial z} \varphi^W_j \varphi^U_i," /></p>
</div><div class="math">
<p><img src="../../_images/math/c1626ae12542c0fd5103c4029b83b93d85818995.png" alt="\frac{\partial F^{U}_i}{\partial y^{\theta}_j} =  \int_{\Omega} R \frac{\partial \varphi^{\theta}_j}{\partial x} \varphi^U_i." /></p>
</div><p><cite>Second momentum equation</cite>: The third equation of <a href="#equation-one">(3)</a> reads</p>
<div class="math">
<p><img src="../../_images/math/7da88d263f3b665872ad66e10e2cb66586fd84d6.png" alt="\frac{\partial W}{\partial t}  + \frac{W}{\varrho}\frac{\partial U}{\partial x} + \frac{U}{\varrho}\frac{\partial W}{\partial x} - \frac{UW}{\varrho^2}\frac{\partial \varrho}{\partial x}  + \frac{2W}{\varrho}\frac{\partial W}{\partial z}  - \frac{W^2}{\varrho^2} \frac{\partial \varrho}{\partial x} + R\frac{\partial \theta}{\partial z} + \varrho g= 0." /></p>
</div><p>After applying the implicit Euler method, we obtain</p>
<div class="math">
<p><img src="../../_images/math/307aaf82ac6672ce67d39601300c382aa9466d58.png" alt="\frac{\partial W^{n+1}}{\tau} - \frac{\partial W^{n}}{\tau}  + \frac{W^{n+1}}{\varrho^{n+1}}\frac{\partial U^{n+1}}{\partial x} + \frac{U^{n+1}}{\varrho^{n+1}}\frac{\partial W^{n+1}}{\partial x} - \frac{U^{n+1}W^{n+1}}{(\varrho^{n+1})^2}\frac{\partial \varrho^{n+1}}{\partial x}" /></p>
</div><div class="math">
<p><img src="../../_images/math/1fa73e8b0beb2660782fe6124e1a3e37af00e616.png" alt="+ \frac{2W^{n+1}}{\varrho^{n+1}}\frac{\partial W^{n+1}}{\partial z}  - \frac{(W^{n+1})^2}{(\varrho^{n+1})^2} \frac{\partial \varrho^{n+1}}{\partial x} + R\frac{\partial \theta^{n+1}}{\partial z} + \varrho^{n+1} g= 0." /></p>
</div><p>Thus we obtain</p>
<div class="math">
<p><img src="../../_images/math/c534b798c6789f9cabc77da40d12b4e17e181366.png" alt="\frac{\partial F^{W}_i}{\partial y^{\varrho}_j} =  + \int_{\Omega} \frac{W}{\varrho^2}\frac{\partial U}{\partial x}(-1)\varphi^{\varrho}_j \varphi^W_i + \int_{\Omega} \frac{U}{\varrho^2}\frac{\partial W}{\partial x}(-1)\varphi^{\varrho}_j \varphi^W_i - \int_{\Omega}\frac{2W}{\varrho^2}\frac{\partial W}{\partial x} \varphi^{\varrho}_j \varphi^{W}_i" /></p>
</div><div class="math">
<p><img src="../../_images/math/ccaea5d0d618e61561383df8afc48884925cf459.png" alt="- \int_{\Omega} UW \left[(-2)\frac{1}{\varrho^3}\frac{\partial \varrho}{\partial x} \varphi^{\varrho}_j  + \frac{1}{\varrho^2}\frac{\partial \varphi^{\varrho}_j}{\partial x} \right] \varphi^{W}_i -  \int_{\Omega} W^2 \left[(-2)\frac{1}{\varrho^3}\frac{\partial \varrho}{\partial z} \varphi^{\varrho}_j  + \frac{1}{\varrho^2}\frac{\partial \varphi^{\varrho}_j}{\partial z}\right] \varphi^W_i  + \int_{\Omega}g \varphi^{\varrho}_j \varphi^{W}_i." /></p>
</div><p>Analogously,</p>
<div class="math">
<p><img src="../../_images/math/a4d7facaea588881e37d9c27707a3d11ed8fe4bf.png" alt="\frac{\partial F^{W}_i}{\partial y^{U}_j} =  \int_{\Omega} \frac{W}{\varrho}\frac{\partial \varphi^U_j}{\partial x} \varphi^W_i + \int_{\Omega} \frac{1}{\varrho}\frac{\partial W}{\partial x} \varphi^U_j \varphi^W_i - \int_{\Omega} \frac{W}{\varrho^2}\frac{\partial \varrho}{\partial x} \varphi^U_j \varphi^W_i," /></p>
</div><div class="math">
<p><img src="../../_images/math/36da6e4eb2af16d5cd8a95f1cdb76b043e449e2d.png" alt="\frac{\partial F^{W}_i}{\partial y^{W}_j} =  \int_{\Omega}\frac{\varphi^W_j}{\tau}\varphi^W_i + \int_{\Omega} \frac{1}{\varrho}\frac{\partial U}{\partial x} \varphi^W_j \varphi^W_i  + \int_{\Omega} \frac{U}{\varrho}\frac{\partial \varphi^W_j}{\partial x} \varphi^W_i  - \int_{\Omega} \frac{U}{\varrho^2}\frac{\partial \varrho}{\partial x} \varphi^W_j \varphi^W_i" /></p>
</div><div class="math">
<p><img src="../../_images/math/3ac10c20dfc5194ca78cb17fa77188cac386acda.png" alt="+ \int_{\Omega}\frac{2}{\varrho} \left[ \frac{\partial W}{\partial z}\varphi^W_j + W \frac{\partial \varphi^W_j}{\partial z} \right] \varphi^W_i  - \int_{\Omega} \frac{2W}{\varrho^2}\frac{\partial \varrho}{\partial z} \varphi^W_j \varphi^W_i," /></p>
</div><div class="math">
<p><img src="../../_images/math/9777eca4c3eb7b92fd3c6007614e7ee4ef92d9b1.png" alt="\frac{\partial F^{W}_i}{\partial y^{\theta}_j} =  \int_{\Omega} R \frac{\partial \varphi^{\theta}_j}{\partial z} \varphi^W_i." /></p>
</div><p><cite>Internal energy equation</cite>: The last equation of <a href="#equation-one">(3)</a> has the form</p>
<div class="math">
<p><img src="../../_images/math/9cbd5a3ad1a9ca17ad3233b7728ed5acc91798e4.png" alt="\frac{\partial \theta}{\partial t} + \mbox{div}(\theta {\bf v}) + \frac{R
\theta}{c_v} \mbox{div}{\bf v} = 0" /></p>
</div><p>where <img class="math" src="../../_images/math/99a3bc63af573497d219fecea2ca37f2e3a20aa0.png" alt="\theta = \varrho T"/>. This can be written equivalently as</p>
<div class="math">
<p><img src="../../_images/math/68a611fafdc16eb74de89499dd4b31c66c157e15.png" alt="\frac{\partial \theta}{\partial t} + \nabla \theta \cdot {\bf v} + \gamma
\theta \mbox{div} {\bf v} = 0." /></p>
</div><p>Written in terms of single derivatives, this is</p>
<div class="math">
<p><img src="../../_images/math/8a72905cd1cf1e4ebaba9e4d35fed3cb364172e9.png" alt="\frac{\partial \theta}{\partial t} + \frac{\partial \theta}{\partial x} \frac{U}{\varrho} + \frac{\partial \theta}{\partial z} \frac{W}{\varrho}  + \gamma \theta \frac{\partial}{\partial x}\left(\frac{U}{\varrho}  \right) + \gamma \theta \frac{\partial}{\partial z}\left(\frac{W}{\varrho}  \right) = 0," /></p>
</div><p>i.e.,</p>
<div class="math">
<p><img src="../../_images/math/35345c221685f7861a71c3e9d0a71d9ce9322c26.png" alt="\frac{\partial \theta}{\partial t}  + \frac{\partial \theta}{\partial x} \frac{U}{\varrho} + \frac{\partial \theta}{\partial z} \frac{W}{\varrho}  + \gamma \frac{\theta}{\varrho} \frac{\partial U}{\partial x} - \gamma \frac{\theta U}{\varrho^2}\frac{\partial \varrho}{\partial x} + \gamma \frac{\theta}{\varrho} \frac{\partial W}{\partial z} - \gamma \frac{\theta W}{\varrho^2}\frac{\partial \varrho}{\partial z} = 0." /></p>
</div><p><cite>Weak formulation</cite>:</p>
<div class="math">
<p><img src="../../_images/math/a1d46ecdf154632b674ef5f6e9b1377fcd0ac820.png" alt="F^{\theta}_i(Y) =  \int_{\Omega} \frac{\theta^{n+1}}{\tau} \varphi^{\theta}_i - \int_{\Omega} \frac{\theta^{n}}{\tau} \varphi^{\theta}_i + \int_{\Omega} \frac{\partial \theta^{n+1}}{\partial x} \frac{U^{n+1}}{\varrho^{n+1}}\varphi^{\theta}_i + \int_{\Omega} \frac{\partial \theta^{n+1}}{\partial z} \frac{W^{n+1}}{\varrho^{n+1}} \varphi^{\theta}_i" /></p>
</div><div class="math">
<p><img src="../../_images/math/e586303277cfa7728aba8595befbcdc4d48c4d29.png" alt="+ \int_{\Omega} \gamma \frac{\theta^{n+1}}{\varrho^{n+1}} \frac{\partial U^{n+1}}{\partial x}\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta^{n+1} U^{n+1}}{(\varrho^{n+1})^2}\frac{\partial \varrho^{n+1}}{\partial x}\varphi^{\theta}_i + \int_{\Omega} \gamma \frac{\theta^{n+1}}{\varrho^{n+1}} \frac{\partial W^{n+1}}{\partial z}\varphi^{\theta}_i -\int_{\Omega}  \gamma \frac{\theta^{n+1} W^{n+1}}{(\varrho^{n+1})^2}\frac{\partial \varrho^{n+1}}{\partial z} \varphi^{\theta}_i= 0." /></p>
</div><p>For the derivatives of the weak form we obtain:</p>
<div class="math">
<p><img src="../../_images/math/7588d3eaaa984152f77d474fce78b3142154fea1.png" alt="\frac{\partial F^{\theta}_i}{\partial y^{\varrho}_j} =  - \int_{\Omega} \frac{\partial \theta}{\partial x} \frac{U}{\varrho^2}\varphi^{\varrho}_j\varphi^{\theta}_i - \int_{\Omega} \frac{\partial \theta}{\partial z} \frac{W}{\varrho^2}\varphi^{\varrho}_j\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta}{\varrho^2} \frac{\partial U}{\partial x}\varphi^{\varrho}_j\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta}{\varrho^2} \frac{\partial W}{\partial z}\varphi^{\varrho}_j\varphi^{\theta}_i" /></p>
</div><div class="math">
<p><img src="../../_images/math/068e40fd96502bc810e45763ad1c3ab98a34ae5a.png" alt="+ \int_{\Omega} 2\gamma \frac{\theta U}{\varrho^3}\frac{\partial \varrho}{\partial x}\varphi^{\varrho}_j\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta U}{\varrho^2}\frac{\varphi^{\varrho}_j}{\partial x}\varphi^{\theta}_i + \int_{\Omega} 2\gamma \frac{\theta W}{\varrho^3}\frac{\partial \varrho}{\partial z}\varphi^{\varrho}_j\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta W}{\varrho^2}\frac{\varphi^{\varrho}_j}{\partial z}\varphi^{\theta}_i." /></p>
</div><div class="math">
<p><img src="../../_images/math/ad4b4e4b96bf5be1fd987e1df488f86ef1389de5.png" alt="\frac{\partial F^{\theta}_i}{\partial y^{U}_j} =  \int_{\Omega} \frac{\partial \theta}{\partial x} \frac{1}{\varrho} \varphi^{U}_j\varphi^{\theta}_i + \int_{\Omega} \gamma \frac{\theta}{\varrho}\frac{\varphi^{U}_j}{\partial x}\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta}{\varrho^2}\frac{\partial \varrho}{\partial x}\varphi^{U}_j\varphi^{\theta}_i." /></p>
</div><div class="math">
<p><img src="../../_images/math/c0a39203e69ec3706c7e32795f21e62418dd42b7.png" alt="\frac{\partial F^{\theta}_i}{\partial y^{W}_j} =  \int_{\Omega} \frac{\partial \theta}{\partial z} \frac{1}{\varrho} \varphi^{W}_j\varphi^{\theta}_i + \int_{\Omega} \gamma \frac{\theta}{\varrho}\frac{\varphi^{W}_j}{\partial z}\varphi^{\theta}_i - \int_{\Omega} \gamma \frac{\theta}{\varrho^2}\frac{\partial \varrho}{\partial z}\varphi^{W}_j\varphi^{\theta}_i." /></p>
</div><div class="math">
<p><img src="../../_images/math/6d4dd9f4fd2bbd38d45aace759dd9c4cf2954b81.png" alt="\frac{\partial F^{\theta}_i}{\partial y^{\theta}_j} =  \int_{\Omega} \frac{1}{\tau} \varphi^{\theta}_j\varphi^{\theta}_i + \int_{\Omega} \frac{U}{\varrho}\frac{\varphi^{\theta}_j}{\partial x}\varphi^{\theta}_i + \int_{\Omega} \frac{W}{\varrho}\frac{\varphi^{\theta}_j}{\partial z}\varphi^{\theta}_i" /></p>
</div><div class="math">
<p><img src="../../_images/math/83c8e7530ae6007d591294f6bb9e5d6639571876.png" alt="+ \int_{\Omega} \frac{\gamma}{\varrho} \frac{\partial U}{\partial x} \varphi^{\theta}_j\varphi^{\theta}_i + \int_{\Omega} \frac{\gamma}{\varrho} \frac{\partial W}{\partial z} \varphi^{\theta}_j\varphi^{\theta}_i - \int_{\Omega} \frac{\gamma U}{\varrho^2} \frac{\partial \varrho}{\partial x} \varphi^{\theta}_j\varphi^{\theta}_i - \int_{\Omega} \frac{\gamma W}{\varrho^2} \frac{\partial \varrho}{\partial z} \varphi^{\theta}_j\varphi^{\theta}_i." /></p>
</div></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">Compressible Euler Equations</a><ul>
<li><a class="reference external" href="#introduction">Introduction</a></li>
<li><a class="reference external" href="#dimensionless-euler-equations">Dimensionless Euler Equations</a></li>
<li><a class="reference external" href="#conservative-form-of-the-euler-equations">Conservative Form of the Euler Equations</a></li>
<li><a class="reference external" href="#weak-formulation">Weak Formulation</a><ul>
<li><a class="reference external" href="#explicit-method">Explicit Method</a></li>
</ul>
</li>
<li><a class="reference external" href="#flux-jacobians">Flux Jacobians</a></li>
<li><a class="reference external" href="#d-version-of-the-equations">2D Version of the Equations</a></li>
<li><a class="reference external" href="#sea-breeze-modeling">Sea Breeze Modeling</a></li>
<li><a class="reference external" href="#boundary-conditions">Boundary Conditions</a><ul>
<li><a class="reference external" href="#boundary-conditions-for-the-sea-breeze-model">Boundary Conditions for the Sea Breeze Model</a></li>
</ul>
</li>
<li><a class="reference external" href="#newton-method">Newton Method</a></li>
<li><a class="reference external" href="#older-notes">Older notes</a><ul>
<li><a class="reference external" href="#governing-equations-and-boundary-conditions">Governing Equations and Boundary Conditions</a></li>
<li><a class="reference external" href="#discretization-and-the-newton-s-method">Discretization and the Newton&#8217;s Method</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="mhd.html"
                                  title="previous chapter">MHD Equations</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../quantum/main.html"
                                  title="next chapter">Quantum Field Theory and Quantum Mechanics</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/src/fluid-dynamics/euler.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../quantum/main.html" title="Quantum Field Theory and Quantum Mechanics"
             >next</a> |</li>
        <li class="right" >
          <a href="mhd.html" title="MHD Equations"
             >previous</a> |</li>
        <li><a href="../../index.html">Theoretical Physics Reference v0.1 documentation</a> &raquo;</li>
          <li><a href="main.html" >Fluid Dynamics</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009, Ondřej Čertík.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.
    </div>
  </body>
</html>