

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Density Functional Theory (DFT) &mdash; Theoretical Physics Reference 0.5 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Theoretical Physics Reference 0.5 documentation" href="../../index.html" />
    <link rel="up" title="Quantum Field Theory and Quantum Mechanics" href="main.html" />
    <link rel="next" title="Hartree-Fock (HF) Method" href="hf.html" />
    <link rel="prev" title="Radial Schrödinger and Dirac Equations" href="radial.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="hf.html" title="Hartree-Fock (HF) Method"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="radial.html" title="Radial Schrödinger and Dirac Equations"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Theoretical Physics Reference 0.5 documentation</a> &raquo;</li>
          <li><a href="main.html" accesskey="U">Quantum Field Theory and Quantum Mechanics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="density-functional-theory-dft">
<h1>Density Functional Theory (DFT)<a class="headerlink" href="#density-functional-theory-dft" title="Permalink to this headline">¶</a></h1>
<div class="section" id="many-body-schrodinger-equation">
<h2>Many Body Schrödinger Equation<a class="headerlink" href="#many-body-schrodinger-equation" title="Permalink to this headline">¶</a></h2>
<p>We use (Hartree) atomic units in this whole section about DFT.
We use the Born-Oppenheimer approximation, which says that the nuclei of the
treated atoms are seen as fixed. A stationary electronic state (for <img class="math" src="../../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/>
electrons) is then described by a wave function
<img class="math" src="../../_images/math/a924df24f9f024d26fc63eaa76eb4350c045d4b4.png" alt="\Psi({\bf r_1},{\bf r_2},\cdots,{\bf r}_N)"/>
fulfilling the many-body Schrödinger equation</p>
<div class="math">
<p><img src="../../_images/math/f139cc38f45283b8993338807c386e181ad8f732.png" alt="\hat H\ket\Psi=(\hat T+\hat U+\hat V)\ket\Psi=E\ket\Psi"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../../_images/math/090e5c1749877fa5347cd5b08bee3efbd888b59a.png" alt="\hat T = \sum_i^N -{1\over2}\nabla_i^2"/></p>
</div><p>is the kinetic term,</p>
<div class="math">
<p><img src="../../_images/math/90ac0c132a3a97adbf408f64eab56146e9c2174e.png" alt="\hat U = \sum_{i&lt;j}U({\bf r_i},{\bf r_j})= {1\over2}\sum_{i,j}U({\bf r_i},{\bf r_j})

U({\bf r_i},{\bf r_j})=U({\bf r_j},{\bf r_i})={1\over|{\bf r_i}-{\bf r_j}|}"/></p>
</div><p>is the electron-electron interaction term and</p>
<div class="math">
<p><img src="../../_images/math/5ef02a709ce1a0b6af53b0f1db24635141a443b0.png" alt="\hat V = \sum_i^N v({\bf r_i})

v({\bf r_i})=\sum_k -{Z_k\over|{\bf r_i}-{\bf R_k}|}"/></p>
</div><p>is the interaction term between electrons and nuclei, where <img class="math" src="../../_images/math/ca8af7f8731100bfd459a326f1aedd079f5b806b.png" alt="R_k"/> are positions
of nuclei and <img class="math" src="../../_images/math/49010f70d55ea1181d53d565da36013c9b2b94ed.png" alt="Z_k"/> the number of nucleons in each nucleus (we are using atomic
units). So for one atomic calculation with the atom nucleus in the origin, we
have just <img class="math" src="../../_images/math/97f7c5d89ddaec7fc2aea790df9a1e18b6b14975.png" alt="v({\bf r_i})=-{Z\over|{\bf r_i}|}"/>.</p>
<p><img class="math" src="../../_images/math/ef13347db9fee2d9e389a21bd2d1f3f1ea0a948e.png" alt="|\Psi|^2=\Psi^*\Psi"/> gives the probability density of measuring the first
electron at the position <img class="math" src="../../_images/math/2ecc6a8919bfc1280124fea824bf3ed6178f19e8.png" alt="\bf r_1"/>, the second at <img class="math" src="../../_images/math/e8d54bae0ab424931d6fee3ab5f69e52689c5a0e.png" alt="\bf r_2"/>, dots and the Nth
electron at the position <img class="math" src="../../_images/math/bf5be9c922081c024cd0cd305a1c828a908bc804.png" alt="{\bf r}_N"/>. The normalization is such that
<img class="math" src="../../_images/math/94de8aaef0a2d09ef78e00bcf569e7a8a17fbbfe.png" alt="\int|\Phi|^2\d^3 r_1\d^3 r_2\dots\d^3 r_N=1"/>. The <img class="math" src="../../_images/math/866f0204648be9ca6b10e14dd72295295dd53a79.png" alt="\Psi"/> is antisymmetric,
i.e.  <img class="math" src="../../_images/math/ff10013d17ca821e53335635a5d5bd504d8ad6db.png" alt="\Psi({\bf r_1},{\bf r_2},\cdots,{\bf r}_N)= -\Psi({\bf r_2},{\bf
r_1},\cdots,{\bf r}_N)= -\Psi({\bf r_1},{\bf r}_N,\cdots,{\bf r_2})"/> etc.</p>
<p>Integrating <img class="math" src="../../_images/math/de071aa6568ee034367d984e5480a1d89f2d6eac.png" alt="|\Psi|^2"/> over the first <img class="math" src="../../_images/math/a256c70ad4c46ec1127c5be68f8bb3075e9ced31.png" alt="N-1"/> electrons is the probability
density that the <img class="math" src="../../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/>-th electron is at the position <img class="math" src="../../_images/math/bf5be9c922081c024cd0cd305a1c828a908bc804.png" alt="{\bf r}_N"/>. Thus the
probability density <img class="math" src="../../_images/math/88bee3c8b92c428acf748ffb1a42363c7a23ac37.png" alt="n({\bf r})"/> that any of the N electrons (i.e the first, or
the second, or the third, dots, or the <img class="math" src="../../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/>-th) is at the position <img class="math" src="../../_images/math/2d671c8502873792085d5a0571d9eef1d3b4fb0b.png" alt="\bf r"/> is
called the particle (or number) density and is therefore given by:</p>
<div class="math">
<p><img src="../../_images/math/ab1a76695112d629c540e8f63ae28c96a478656c.png" alt="n({\bf r})= \int \Psi^*({\bf r},{\bf r}_2,\cdots,{\bf r}_N) \Psi ({\bf r},{\bf r}_2,\cdots,{\bf r}_N) \,\d^3 r_2\,\d^3 r_3\cdots\d^3 r_N+

+\int \Psi^*({\bf r}_1,{\bf r},\cdots,{\bf r}_N) \Psi ({\bf r}_1,{\bf r},\cdots,{\bf r}_N) \,\d^3 r_1\,\d^3 r_3\cdots\d^3 r_N+\cdots

+\int \Psi^*({\bf r}_1,{\bf r}_2,\cdots,{\bf r}) \Psi ({\bf r}_1,{\bf r}_2,\cdots,{\bf r}) \,\d^3 r_1\,\d^3 r_2\,\d^3 r_3\cdots\d^3 r_{N-1}=

=\int(\delta({\bf r}-{\bf r}_1)+\delta({\bf r}-{\bf r}_2)+\cdots+\delta({\bf r}-{\bf r}_N))

\Psi^*({\bf r}_1,{\bf r}_2,\cdots,{\bf r}_N) \Psi ({\bf r}_1,{\bf r}_2,\cdots,{\bf r}_N) \,\d^3 r_1\,\d^3 r_2\,\d^3 r_3\cdots\d^3 r_{N}=

=\sum_{i=1}^N\int \braket{\Psi|{\bf r}_1,{\bf r}_2,\cdots,{\bf r}_N}\delta({\bf r}-{\bf r}_i) \braket{{\bf r}_1,{\bf r}_2,\cdots,{\bf r}_N|\Psi} \,\d^3 r_1\,\d^3 r_2\,\d^3 r_3\cdots\d^3 r_{N}=

=N\int \braket{\Psi|{\bf r}_1,{\bf r}_2,\cdots,{\bf r}_N}\delta({\bf r}-{\bf r}_1) \braket{{\bf r}_1,{\bf r}_2,\cdots,{\bf r}_N|\Psi} \,\d^3 r_1\,\d^3 r_2\,\d^3 r_3\cdots\d^3 r_{N}="/></p>
</div><div class="math" id="equation-chargedensity">
<p><span class="eqno">(1)</span><img src="../../_images/math/950f6c89ea24a55ed1a5551ecadd5cd58feee1f6.png" alt="=N\int \Psi^*({\bf r},{\bf r}_2,\cdots,{\bf r}_N) \Psi ({\bf r},{\bf r}_2,\cdots,{\bf r}_N) \,\d^3 r_2\,\d^3 r_3\cdots\d^3 r_N"/></p>
</div><p>Thus <img class="math" src="../../_images/math/799fa53644973daa09f1828a84b76d4b346c8b7f.png" alt="\int_\Omega n({\bf r})\,\d^3r"/> gives the number of particles
in the region of integration <img class="math" src="../../_images/math/9e2b196e9b7e57d1ec99f6534c581ea9759d2170.png" alt="\Omega"/>. Obviously <img class="math" src="../../_images/math/04de2d08093e61846f552018cc526295bab94b97.png" alt="\int
n({\bf r})\,\d^3r=N"/>.</p>
<p>Note that the number density <img class="math" src="../../_images/math/88bee3c8b92c428acf748ffb1a42363c7a23ac37.png" alt="n({\bf r})"/> and potential <img class="math" src="../../_images/math/dc9ba5d56d05cab72d028bc2c89e4ae4b66ae862.png" alt="V({\bf r})"/> in the
Schroedinger equation is related to the electron charge density <img class="math" src="../../_images/math/c308801745db9ba7922d22ff3bc24618fb9bf91d.png" alt="\rho({\bf r})"/>
and electrostatic potential energy <img class="math" src="../../_images/math/ccde77c35ba827edb98a2c14635136af7170e838.png" alt="\phi({\bf r})"/> by:</p>
<div class="math">
<p><img src="../../_images/math/5d868154a2d398a991f43b2a71b14023bc0dfb66.png" alt="\rho({\bf r}) = q n({\bf r})

q\phi({\bf r}) = V({\bf r})"/></p>
</div><p>where <img class="math" src="../../_images/math/0615acc3725de21025457e7d6f7694dab8e2f758.png" alt="q"/> is the particle elementary charge,
which for electrons is <img class="math" src="../../_images/math/ea326ca23c5e0c114249d0dbfdd25fe72b5103f9.png" alt="q=-e=-1"/> in atomic units.
The amount of electronic charge in the region <img class="math" src="../../_images/math/9e2b196e9b7e57d1ec99f6534c581ea9759d2170.png" alt="\Omega"/> is given by:</p>
<div class="math">
<p><img src="../../_images/math/6262ef35e6c40f5794c1e4521763ac15c907806d.png" alt="Q
    = \int_\Omega \rho({\bf r})\,\d^3r
    = q\int_\Omega n({\bf r})\,\d^3r
    = -\int_\Omega n({\bf r})\,\d^3r"/></p>
</div><p>The energy of the system is given by</p>
<div class="math" id="equation-Emanybody">
<p><span class="eqno">(2)</span><img src="../../_images/math/9f5664ebf2f8cae8c33afc42d7df98ea700eec7c.png" alt="E=\braket{\Psi|\hat H|\Psi}= \braket{\Psi|\hat T|\Psi}+\braket{\Psi|\hat U|\Psi}+\braket{\Psi|\hat V|\Psi}= T+U+V"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../../_images/math/d0eaa57f46f5676922f7346b686df81ab80c096d.png" alt="T=\braket{\Psi|\hat T|\Psi}=\sum_i^N\int \Psi^*({\bf r_1},{\bf r_2},\cdots,{\bf r_N})(-\half\nabla_i^2) \Psi({\bf r_1},{\bf r_2},\cdots,{\bf r_N})\,\d^3 r_1\,\d^3 r_2\cdots\d^3 r_N

U=\braket{\Psi|\hat U|\Psi}

V=\braket{\Psi|\hat V|\Psi}=\sum_i^N\int \Psi^*({\bf r_1},{\bf r_2},\cdots,{\bf r_N})v({\bf r_i}) \Psi({\bf r_1},{\bf r_2},\cdots,{\bf r_N})\,\d^3 r_1\,\d^3 r_2\cdots\d^3 r_N=

=\sum_i^N\int \Psi^*({\bf r_1},{\bf r_2},\cdots,{\bf r_N})v({\bf r_1}) \Psi({\bf r_1},{\bf r_2},\cdots,{\bf r_N})\,\d^3 r_1\,\d^3 r_2\cdots\d^3 r_N=

=N\int \Psi^*({\bf r_1},{\bf r_2},\cdots,{\bf r_N})v({\bf r_1}) \Psi({\bf r_1},{\bf r_2},\cdots,{\bf r_N})\,\d^3 r_1\,\d^3 r_2\cdots\d^3 r_N="/></p>
</div><div class="math" id="equation-V[n]">
<p><span class="eqno">(3)</span><img src="../../_images/math/ab3224ab67e8761cad72af62ddad6b4be027156f.png" alt="=\int v({\bf r}) n({\bf r})\d^3 r=V[n]"/></p>
</div><p>It needs to be stressed, that <img class="math" src="../../_images/math/fa2fa899f0afb05d6837885523503a2d4df434f9.png" alt="E"/> generally is <em>not</em> a functional of <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>
alone, only the <img class="math" src="../../_images/math/16a3ec972c7a23ad2299075d3ca4b8045b71be9c.png" alt="V[n]"/> is. In the next section we show however, that if the
<img class="math" src="../../_images/math/81705426f06f78e5103187739c4dfd003cd89e50.png" alt="\ket{\Psi}"/> is a ground state (of any system), then <img class="math" src="../../_images/math/fa2fa899f0afb05d6837885523503a2d4df434f9.png" alt="E"/> becomes a functional
of <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>.</p>
</div>
<div class="section" id="the-hohenberg-kohn-theorem">
<h2>The Hohenberg-Kohn Theorem<a class="headerlink" href="#the-hohenberg-kohn-theorem" title="Permalink to this headline">¶</a></h2>
<p>The Schrödinger equation gives the map</p>
<div class="math">
<p><img src="../../_images/math/e9eab186058c9c586a20aad3316610f239c660a6.png" alt="C: V \to \Psi"/></p>
</div><p>where <img class="math" src="../../_images/math/866f0204648be9ca6b10e14dd72295295dd53a79.png" alt="\Psi"/> is the ground state. C is bijective (one-to-one correspondence),
because to every <img class="math" src="../../_images/math/12d58aa29201da09d8e620f8698e3a37547f6b4a.png" alt="V"/> we can compute the corresponding <img class="math" src="../../_images/math/866f0204648be9ca6b10e14dd72295295dd53a79.png" alt="\Psi"/> from Schrödinger
equation and two different <img class="math" src="../../_images/math/12d58aa29201da09d8e620f8698e3a37547f6b4a.png" alt="V"/> and <img class="math" src="../../_images/math/153922b5d53dfe63544ac7bc5c7b3ea8e21d6610.png" alt="V'"/> (differing by more than a constant)
give two different <img class="math" src="../../_images/math/866f0204648be9ca6b10e14dd72295295dd53a79.png" alt="\Psi"/>, because if <img class="math" src="../../_images/math/12d58aa29201da09d8e620f8698e3a37547f6b4a.png" alt="V"/> and <img class="math" src="../../_images/math/153922b5d53dfe63544ac7bc5c7b3ea8e21d6610.png" alt="V'"/> gave the same <img class="math" src="../../_images/math/866f0204648be9ca6b10e14dd72295295dd53a79.png" alt="\Psi"/>, then
by substracting</p>
<div class="math">
<p><img src="../../_images/math/5f172c34118fddcf0ed22fb8490a6c978ba37cbf.png" alt="\hat H\ket{\Psi}=E_{gs}\ket{\Psi}"/></p>
</div><p>from</p>
<div class="math">
<p><img src="../../_images/math/61cc4b8137bdcc9c2d5fb9962c4652aed626f14e.png" alt="\hat H'\ket{\Psi}=(\hat H-\hat V+\hat V')\ket{\Psi}=E_{gs}'\ket{\Psi}"/></p>
</div><p>we would get <img class="math" src="../../_images/math/2221661e02fca8e30294cbac9752a46cfe5c53a1.png" alt="V-V'=E-E'"/>, which is a contradiction with the assumption that <img class="math" src="../../_images/math/12d58aa29201da09d8e620f8698e3a37547f6b4a.png" alt="V"/> and <img class="math" src="../../_images/math/153922b5d53dfe63544ac7bc5c7b3ea8e21d6610.png" alt="V'"/> differ by more than a constant.</p>
<p>Similarly, from the ground state wavefunction <img class="math" src="../../_images/math/866f0204648be9ca6b10e14dd72295295dd53a79.png" alt="\Psi"/> we can compute the charge
density <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/> giving rise to the map</p>
<div class="math">
<p><img src="../../_images/math/05400df9aa8199fbb57b7c176653253c3d0df96c.png" alt="D: \Psi \to n"/></p>
</div><p>which is also bijective, because to every <img class="math" src="../../_images/math/866f0204648be9ca6b10e14dd72295295dd53a79.png" alt="\Psi"/> we can compute <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/> from
<a href="#equation-chargedensity">(1)</a> and two different <img class="math" src="../../_images/math/866f0204648be9ca6b10e14dd72295295dd53a79.png" alt="\Psi"/> and <img class="math" src="../../_images/math/db2d658bbbea9ab63ecadb79df99212a327bf177.png" alt="\Psi'"/> give two different
<img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/> and <img class="math" src="../../_images/math/c6bed33114d0579936e00565024dad5a983cbac1.png" alt="n'"/>, because different <img class="math" src="../../_images/math/866f0204648be9ca6b10e14dd72295295dd53a79.png" alt="\Psi"/> and <img class="math" src="../../_images/math/db2d658bbbea9ab63ecadb79df99212a327bf177.png" alt="\Psi'"/> give</p>
<div class="math">
<p><img src="../../_images/math/4fc1caa957015727a14843f8eacbdbffb714ecea.png" alt="E_{gs}=\braket{\Psi|\hat H|\Psi}&lt;\braket{\Psi'|\hat H|\Psi'}= \braket{\Psi'|\hat H'+\hat V-\hat V'|\Psi'}=E_{gs}'+\int n'({\bf r}) (v({\bf r})-v'({\bf r}))\,\d^3 r

E_{gs}'=\braket{\Psi'|\hat H'|\Psi'}&lt;\braket{\Psi|\hat H'|\Psi}= \braket{\Psi|\hat H+\hat V'-\hat V|\Psi}=E_{gs}+\int n({\bf r}) (v'({\bf r})-v({\bf r}))\,\d^3 r"/></p>
</div><p>adding these two inequalities together gives</p>
<div class="math">
<p><img src="../../_images/math/5c2ead404812a79500f5089b4b279f4f0d4373d8.png" alt="0&lt;\int n'({\bf r}) (v({\bf r})-v'({\bf r}))\,\d^3 r + \int n({\bf r}) (v'({\bf r})-v({\bf r}))\,\d^3 r= \int (n({\bf r})-n'({\bf r}))(v'({\bf r})-v({\bf r}))\,\d^3 r"/></p>
</div><p>which for <img class="math" src="../../_images/math/21253a445f3ff7dc323a2e3e532becbecd344bef.png" alt="n=n'"/> gives <img class="math" src="../../_images/math/3f2c077a4a5da8f1ae69e049d30c50903e19634d.png" alt="0&lt;0"/>, which is nonsense, so <img class="math" src="../../_images/math/0ff7082ec95732c7d049e618001ff75b79e2382d.png" alt="n\neq n'"/>.</p>
<p>So we have proved that for a given ground state density <img class="math" src="../../_images/math/14741dd4fd8788f9f52969a20eb2e3e7639e02f0.png" alt="n_0({\bf r})"/>
(generated by a potential <img class="math" src="../../_images/math/a4f15806bf0e2a3b4a6b48f1343810a79212d942.png" alt="\hat V_0"/>) it is possible to calculate the
corresponding ground state wavefunction <img class="math" src="../../_images/math/1b7535a46640cb394251bdcbb540a06797642b41.png" alt="\Psi_0({\bf r_1},{\bf r_2},\cdots,{\bf
r_N})"/>, in other words, <img class="math" src="../../_images/math/7d1919245b3cd2b8fccbdd84d03b1a86e34e8e00.png" alt="\Psi_0"/> is a unique functional of <img class="math" src="../../_images/math/b2f0c6d216bb63a89845904c513ec0007b6b3e7a.png" alt="n_0"/>:</p>
<div class="math">
<p><img src="../../_images/math/d513351119846bcfbfef0b06bf7299fe171b1316.png" alt="\Psi_0=\Psi_0[n_0]"/></p>
</div><p>so the ground state energy <img class="math" src="../../_images/math/8a52f40afedf1c8727d71b0ad5a7ea0a7119b088.png" alt="E_0"/> is also a functional of <img class="math" src="../../_images/math/b2f0c6d216bb63a89845904c513ec0007b6b3e7a.png" alt="n_0"/></p>
<div class="math">
<p><img src="../../_images/math/3015b7db8b726114da0443f09a6f60016286a7c9.png" alt="E_0=\braket{\Psi_0[n_0]|\hat T+\hat U+\hat V_0|\Psi_0[n_0]}=E[n_0]"/></p>
</div><p>We define an energy functional</p>
<div class="math" id="equation-Efunct">
<p><span class="eqno">(4)</span><img src="../../_images/math/61b41d1cf813b23e22676f0ab98d7acf6b1eb454.png" alt="E_{v_0}[n]=\braket{\Psi[n]|\hat T+\hat U+\hat V_0|\Psi[n]}= \braket{\Psi[n]|\hat T+\hat U|\Psi[n]}+\int v_0({\bf r})n({\bf r})\d^3r"/></p>
</div><p>where <img class="math" src="../../_images/math/f5e3b4594448281c959c2d93e38fdaef85c19c59.png" alt="\ket{\Psi[n]}"/> is any ground state wavefunction (generated by an
arbitrary potential), that is, <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/> is a ground state density belonging to an
arbitrary system. <img class="math" src="../../_images/math/8a52f40afedf1c8727d71b0ad5a7ea0a7119b088.png" alt="E_0"/> which is generated by the potential <img class="math" src="../../_images/math/b4df5a1be0fe6fc35e2bcd0bf4b7e1733edcfd36.png" alt="V_0"/> can then be
expressed as</p>
<div class="math">
<p><img src="../../_images/math/28023b70413372b01ab4feee2c6247f41ba0882a.png" alt="E_0=E_{v_0}[n_0]"/></p>
</div><p>and for <img class="math" src="../../_images/math/dc436d9d7bf0e9f61ebc9bf047c21de6514def59.png" alt="n\neq n_0"/> we have (from the Ritz principle)</p>
<div class="math">
<p><img src="../../_images/math/f7f2ffc1b18f5dfceb000bc8b8f57d3301d8b201.png" alt="E_0&lt;E_{v_0}[n]"/></p>
</div><p>and one has to minimize the functional <img class="math" src="../../_images/math/05426827acbb2ed9389b990ae1caba069b19438e.png" alt="E_{v_0}[n]"/>:</p>
<div class="math" id="equation-Emin">
<p><span class="eqno">(5)</span><img src="../../_images/math/9b2915822a7e828e9a1435e974d44d7af558ae01.png" alt="E_0=\min_n E_{v_0}[n]"/></p>
</div><p>The term</p>
<div class="math">
<p><img src="../../_images/math/5850c3641742dce4892098438e9cc2eaf6966ddf.png" alt="\braket{\Psi[n]|\hat T+\hat U|\Psi[n]}\equiv F[n]"/></p>
</div><p>in <a href="#equation-Efunct">(4)</a> is universal in the sense that it doesn&#8217;t depend on <img class="math" src="../../_images/math/9303793773753f6b4fdb341e98cb8471336559cc.png" alt="\hat
V_0"/>. It can be proven <a class="reference internal" href="#dft">[DFT]</a>, that <img class="math" src="../../_images/math/bba4cdb965199558e715ee20309f3740b9a9f6c1.png" alt="F[n]"/> is a functional of <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/> for
degenerated ground states too, so <a href="#equation-Emin">(5)</a> stays true as well.</p>
<p>The ground state densities in <a href="#equation-Efunct">(4)</a> and <a href="#equation-Emin">(5)</a> are called
<em>pure-state v-representable</em> because they are the densities of (possible
degenerate) ground state of the Hamiltonian with some local potential <img class="math" src="../../_images/math/e856d0fc05006e0d8c7369881d3a2a7a518d9612.png" alt="v({\bf
r})"/>. One may ask a question if all possible functions are v-representable
(this is called the v-representability problem). The question is relevant,
because we need to know which functions to take into account in the
minimization process <a href="#equation-Emin">(5)</a>. Even though not every function is
v-representable <a class="reference internal" href="#dft">[DFT]</a>, every density defined on a grid (finite of
infinite) which is strictly positive, normalized and consistent with the Pauli
principle is ensemble v-representable. Ensemble v-representation is just a
simple generalization of the above, for details see <a class="reference internal" href="#dft">[DFT]</a>.</p>
<p>The functional <img class="math" src="../../_images/math/05426827acbb2ed9389b990ae1caba069b19438e.png" alt="E_{v_0}[n]"/> in <a href="#equation-Emin">(5)</a> depends on the particle number <img class="math" src="../../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/>,
so in order to get <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>, we need to solve the variational formulation</p>
<div class="math">
<p><img src="../../_images/math/bf9759f23547ecee1d36365462b366df3e75867b.png" alt="{\delta\over\delta n}\left(E_v[n]-\mu(N)\int n(\bf r)\d^3r\right)=0"/></p>
</div><p>so</p>
<div class="math" id="equation-euler">
<p><span class="eqno">(6)</span><img src="../../_images/math/3844cfaf15ad66ccbcbdbef366be754ad37952f4.png" alt="{\delta E_v[n]\over\delta n}=\mu(N)"/></p>
</div><p>Let the <img class="math" src="../../_images/math/73f11ddf2bce67bfd3b39f9cb3a5e5ed6ca396cf.png" alt="n_N(\bf r)"/> be the solution of <a href="#equation-euler">(6)</a> with a particle number
<img class="math" src="../../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/> and the energy <img class="math" src="../../_images/math/412c1b109e57b8cd9da91ae8a1af3eae6822f2ca.png" alt="E_N"/>:</p>
<div class="math">
<p><img src="../../_images/math/5a63ccd8fec01e37e76d1c3ea354013700c7f574.png" alt="E_N=E_v[n_N]"/></p>
</div><p>The Lagrangian multiplier <img class="math" src="../../_images/math/2d8c833ed800824727cd7bd2fb9de1a12ad7e674.png" alt="\mu"/> is the exact chemical potential of the system</p>
<div class="math">
<p><img src="../../_images/math/ed7658f8bb50158d38d25a8d88f2a199f29666aa.png" alt="\mu(N)={\partial E_N\over\partial N}"/></p>
</div><p>becuase</p>
<div class="math">
<p><img src="../../_images/math/532eeb65834ff7248ec1146d556ce79caf447406.png" alt="E_{N+\epsilon}-E_N=E_v[n_{N+\epsilon}]-E_v[n_N] =\int {\delta E_v\over\delta n} (n_{N+\epsilon}-n_N)\d^3r=

=\int \mu(N) (n_{N+\epsilon}-n_N)\d^3r =\mu(N)(N+\epsilon-N)=\mu(N)\epsilon"/></p>
</div><p>so</p>
<div class="math">
<p><img src="../../_images/math/2c6c734fd1b90ef25ec549d99c0a1b18f8b4678c.png" alt="\mu(N)={E_{N+\epsilon}-E_N\over\epsilon} \ \longrightarrow \ {\partial E_N\over\partial N}"/></p>
</div></div>
<div class="section" id="the-kohn-sham-equations">
<h2>The Kohn-Sham Equations<a class="headerlink" href="#the-kohn-sham-equations" title="Permalink to this headline">¶</a></h2>
<p>Consider an auxiliary system of <img class="math" src="../../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/> noninteracting electrons (noninteracting
gas):</p>
<div class="math">
<p><img src="../../_images/math/36c3309d9c73a85d44dd67c7cbc5131ef6ac7b1f.png" alt="\hat H_s=\hat T+\hat V_s"/></p>
</div><p>the Schrödinger then becomes:</p>
<div class="math">
<p><img src="../../_images/math/6171fa37fd4dbf3bd75d3717ac25f002e558be2e.png" alt="(-\half\nabla^2+v_s({\bf r}))\psi_i({\bf r}) =\epsilon_i\psi_i({\bf r})

n_s({\bf r})=\sum_i^N|\psi_i({\bf r})|^2"/></p>
</div><p>and the total energy is:</p>
<div class="math">
<p><img src="../../_images/math/92667b42a9c110759329eed9dace3d2b1222fb07.png" alt="E_s[n]=T_s[\{\psi_i[n]\}]+V_s[n]"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../../_images/math/f7ce25dfa857e3954fd3c677075e49aa344000a4.png" alt="T_s[n]=\braket{\Psi[n]|\hat T|\Psi[n]}= \sum_i\braket{\psi_i|-\half\nabla^2|\psi_i}

V_s[n]=\braket{\Psi[n]|\hat V|\Psi[n]}=\int v_s({\bf r})n({\bf r})\d^3r"/></p>
</div><p>So:</p>
<div class="math">
<p><img src="../../_images/math/a80729daa732ae9ec0e7a96d77438e4a60d73a5e.png" alt="E_s[n] = \sum_i\braket{\psi_i|-\half\nabla^2|\psi_i} +
    \int v_s({\bf r})n({\bf r})\d^3r
    =

    = \sum_i\int \psi_i^* \left(-\half\nabla^2\right)\psi_i\,\d^3 r +
        \int v_s({\bf r})\sum_i\psi_i^* \psi_i\, \d^3r
    =

    = \sum_i\int \psi_i^* \left(-\half\nabla^2 + v_s({\bf r})\right)
        \psi_i\,\d^3 r
    =

    = \sum_i \epsilon_i\int \psi_i^* \psi_i\,\d^3 r =

    = \sum_i \epsilon_i"/></p>
</div><p>The total energy is the sum of eigenvalues (energies of the individual
independent particles) as expected. From the last equation it follows:</p>
<div class="math">
<p><img src="../../_images/math/15091c09e66dfa095676d249c264a2d0d95399f7.png" alt="T_s[n] = \sum_i\braket{\psi_i|-\half\nabla^2|\psi_i}
    = \sum_i \epsilon_i -\int v_s({\bf r})n({\bf r})\d^3r"/></p>
</div><p>In other words, the kinetic energy of the noninteracting particles is equal to
the sum of eigenvalues minus the potential energy coming from the total
effective potential <img class="math" src="../../_images/math/7d0220e2a0c12c2a6048f99e473516e1a4efab88.png" alt="v_s"/> used to construct the single particle orbitals
<img class="math" src="../../_images/math/75b7bc3d0bbe11946d21dabacfde02b7d0978b3f.png" alt="\psi_i"/>.</p>
<p>From <a href="#equation-euler">(6)</a> we get</p>
<div class="math" id="equation-noninteract">
<p><span class="eqno">(7)</span><img src="../../_images/math/6513b7dafed08c0a54c7839fbf198f22675bc95d.png" alt="\mu={\delta E_s[n]\over\delta n({\bf r})}= {\delta T_s[n]\over\delta n({\bf r})}+{\delta V_s[n]\over\delta n({\bf r})}= {\delta T_s[n]\over\delta n({\bf r})}+v_s({\bf r})"/></p>
</div><p>Solution to this equation gives the density <img class="math" src="../../_images/math/e67d506d841d6b0b63cb299e0635e9118f3f6969.png" alt="n_s"/>.</p>
<p>Now we want to express the energy in <a href="#equation-Emanybody">(2)</a> using <img class="math" src="../../_images/math/43b3aabcb88e217357a0b38741411a9357bf238f.png" alt="T_s"/> and <img class="math" src="../../_images/math/98221fab89b1690eb98d0f1dbba30e97c9c36c10.png" alt="E_H"/>
for convenience, where <img class="math" src="../../_images/math/98221fab89b1690eb98d0f1dbba30e97c9c36c10.png" alt="E_H"/> is the classical electrostatic interaction energy
of the charge distribution <img class="math" src="../../_images/math/c308801745db9ba7922d22ff3bc24618fb9bf91d.png" alt="\rho({\bf r})"/>, defined using following relations
- we start with a Poisson equation in atomic units</p>
<div class="math">
<p><img src="../../_images/math/d27bc553d9f47c7e975f966e240db0fd5d041411.png" alt="\nabla^2 \phi_H({\bf r})=-4\pi \rho({\bf r})"/></p>
</div><p>and substitute <img class="math" src="../../_images/math/9d4914a10a7b3417270bafaccaae542867c91600.png" alt="\rho({\bf r}) = q n({\bf r})"/>,
<img class="math" src="../../_images/math/60a703c7679c3883184f04c639228a85970304de.png" alt="V_H({\bf r}) = q \phi_H({\bf r})"/> and we use the fact that <img class="math" src="../../_images/math/6758e63811698087b82800b0f4166a23d9af2d2e.png" alt="q^2=1"/> in atomic
units:</p>
<div class="math">
<p><img src="../../_images/math/cc0b1c63af2cfc26246df816e252e37b6a01e8d0.png" alt="\nabla^2 V_H({\bf r})=-4\pi q^2 n({\bf r}) = -4\pi n({\bf r})"/></p>
</div><p>or equivalently by expressing <img class="math" src="../../_images/math/0783030b7db37589c2fa4d4657fa9663d6bfea19.png" alt="V_H"/> using the Green function:</p>
<div class="math" id="equation-V_H">
<p><span class="eqno">(8)</span><img src="../../_images/math/f86ea01d43263d04384109bbec5c7524140f23fe.png" alt="V_H({\bf r})
    = -{1\over 4\pi} \int {-4\pi n({\bf r'})\over|{\bf r}-{\bf r'}|} \d^3r'
    = \int {n({\bf r'})\over|{\bf r}-{\bf r'}|} \d^3r'"/></p>
</div><p>and finally <img class="math" src="../../_images/math/98221fab89b1690eb98d0f1dbba30e97c9c36c10.png" alt="E_H"/> is related to <img class="math" src="../../_images/math/0783030b7db37589c2fa4d4657fa9663d6bfea19.png" alt="V_H"/> using:</p>
<div class="math">
<p><img src="../../_images/math/fbb5c548178243190c00ddb914340b9def376945.png" alt="V_H({\bf r})={\delta E_H\over\delta n({\bf r})}"/></p>
</div><p>so we get:</p>
<div class="math">
<p><img src="../../_images/math/a9ad5e5b20d9301dcdce74f135071cfbd6b902c3.png" alt="E_H[n]=\half\int\int {n({\bf r})n({\bf r'})\over|{\bf r}-{\bf r'}|} \d^3r\d^3r'"/></p>
</div><p>Using the rules for functional differentiation, we can check that:</p>
<div class="math">
<p><img src="../../_images/math/2ca58060a3765d1f6706d4be1d78cc1d7191a3a2.png" alt="V_H({\bf r})
    ={\delta E_H\over\delta n({\bf r})}
    ={\delta \over\delta n({\bf r})}
        \half\int\int {n({\bf r'})n({\bf r''})\over|{\bf r'}-{\bf r''}|}
        \d^3r'\d^3r''
    =

    =\int {n({\bf r'})\over|{\bf r}-{\bf r'}|}
        \d^3r'"/></p>
</div><p>Using the above relations, we can see that</p>
<div class="math">
<p><img src="../../_images/math/c9a2a48f4d3c981440303cc74e9f9a8eaeaf3884.png" alt="E_H[n]=\half\int V_H({\bf r}) n({\bf r}) \d^3r"/></p>
</div><p>So from <a href="#equation-Efunct">(4)</a> we get</p>
<div class="math" id="equation-Efunctxc">
<p><span class="eqno">(9)</span><img src="../../_images/math/db144f4d778508608c4a1fe3768d0575acd3d99d.png" alt="E[n]=(T+U)[n]+V[n]=T_s[n]+E_H[n]+(T-T_s+U-E_H)[n]+V[n]=

=T_s[n]+E_H[n]+E_{xc}[n]+V[n]"/></p>
</div><p>The rest of the energy is denoted by <img class="math" src="../../_images/math/b3f7dfcefce9f0b2e6bb3ed4814557b1f012d993.png" alt="E_{xc}=U-E_H+T-T_s"/> and it is called is
the exchange and correlation energy functional. From <a href="#equation-euler">(6)</a></p>
<div class="math">
<p><img src="../../_images/math/394e4f50434ab42b41b34e44d2683cebc37c3de7.png" alt="\mu={\delta E[n]\over\delta n({\bf r})}= {\delta T_s[n]\over\delta n({\bf r})}+ {\delta E_H[n]\over\delta n({\bf r})}+ {\delta E_{xc}[n]\over\delta n({\bf r})}+ {\delta V[n]\over\delta n({\bf r})}"/></p>
</div><p>From <a href="#equation-V_H">(8)</a> we have</p>
<div class="math">
<p><img src="../../_images/math/a26cfa41e129322c65e6e2026ea35f1c937cf728.png" alt="{\delta E_H\over\delta n({\bf r})}=V_H({\bf r})"/></p>
</div><p>from <a href="#equation-V[n]">(3)</a> we get</p>
<div class="math">
<p><img src="../../_images/math/0c25a474a8beefbfe84b663284a3773c753774a9.png" alt="{\delta V[n]\over\delta n({\bf r})}=v({\bf r})"/></p>
</div><p>we define</p>
<div class="math" id="equation-Vxcpot">
<p><span class="eqno">(10)</span><img src="../../_images/math/94ba6e8ede176e3f58d377155b7cb69fccfd17dd.png" alt="{\delta E_{xc}[n]\over\delta n({\bf r})}=V_{xc}({\bf r})"/></p>
</div><p>so we arrive at</p>
<div class="math" id="equation-interact">
<p><span class="eqno">(11)</span><img src="../../_images/math/4d2dd770037d98541f91ce3ec1fdfb590d711502.png" alt="\mu={\delta E[n]\over\delta n({\bf r})}= {\delta T_s[n]\over\delta n({\bf r})}+V_H({\bf r})+V_{xc}({\bf r})+v({\bf r})"/></p>
</div><p>Solution to this equation gives the density <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>. Comparing <a href="#equation-interact">(11)</a> to
<a href="#equation-noninteract">(7)</a> we see that if we choose</p>
<div class="math" id="equation-V_in">
<p><span class="eqno">(12)</span><img src="../../_images/math/0220e85c55319caafa2f1b9b07b9ef81e060c022.png" alt="v_s\equiv V_H+V_{xc}+v"/></p>
</div><p>then <img class="math" src="../../_images/math/245cfd7ac224be63e6855b55b5e163c0f06d5dc3.png" alt="n_s({\bf r})\equiv n({\bf r})"/>. So we solve the Kohn-Sham equations of
this auxiliary non-interacting system</p>
<div class="math" id="equation-KSeq">
<p><span class="eqno">(13)</span><img src="../../_images/math/07bcd3699b8b68595a47300a3d675b1063b53cdd.png" alt="(-\half\nabla^2+v_s({\bf r}))\psi_i({\bf r}) \equiv(-\half\nabla^2+V_H({\bf
r})+V_{xc}({\bf r})+v({\bf r}))\psi_i({\bf r}) =\epsilon_i\psi_i({\bf r})"/></p>
</div><p>which yield the orbitals <img class="math" src="../../_images/math/75b7bc3d0bbe11946d21dabacfde02b7d0978b3f.png" alt="\psi_i"/> that reproduce the density <img class="math" src="../../_images/math/88bee3c8b92c428acf748ffb1a42363c7a23ac37.png" alt="n({\bf r})"/> of the original interacting system</p>
<div class="math" id="equation-KSdensity">
<p><span class="eqno">(14)</span><img src="../../_images/math/6a7df5c10ff75f5b28f12de441c067a7a3eb852b.png" alt="n({\bf r})\equiv n_s({\bf r})=\sum_i^N|\psi_i({\bf r})|^2"/></p>
</div><p>The sum is taken over the lowest <img class="math" src="../../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/> energies. Some of the <img class="math" src="../../_images/math/75b7bc3d0bbe11946d21dabacfde02b7d0978b3f.png" alt="\psi_i"/> can be
degenerated, but it doesn&#8217;t matter - the index <img class="math" src="../../_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/> counts every eigenfunction
including all the degenerated. In plain words, the trick is in realizing, that
the ground state energy can be found by minimizing the energy functional
<a href="#equation-Efunct">(4)</a> and in rewriting this functional into the form <a href="#equation-Efunctxc">(9)</a>,
which shows that the interacting system can be treated as a noninteracting one
with a special potential.</p>
</div>
<div class="section" id="the-xc-term">
<h2>The XC Term<a class="headerlink" href="#the-xc-term" title="Permalink to this headline">¶</a></h2>
<p>The exchange and correlation functional</p>
<div class="math">
<p><img src="../../_images/math/2558ff623d773bbff23c9a32188e2b057288a8ca.png" alt="E_{xc}[n]=(T+U)[n]-E_H[n]-T_S[n]"/></p>
</div><p>can always be written in the form</p>
<div class="math">
<p><img src="../../_images/math/9b610ad030c8356ef4cda50540887ff8dd894ad4.png" alt="E_{xc}[n]=\int n({\bf r}')\epsilon_{xc}({\bf r}';n)\d^3r'"/></p>
</div><p>where the <img class="math" src="../../_images/math/d9f8c376278e0040e38bf4736e2c59dc3020e31b.png" alt="\epsilon_{xc}({\bf r}';n)"/> is called the XC energy density.
The XC potential is defined as:</p>
<div class="math">
<p><img src="../../_images/math/8008cfcefbeab60ff49a61f0098fd174c898746c.png" alt="V_{xc}({\bf r};n) = {\delta E_{xc}[n]\over\delta n({\bf r})}
    = \epsilon_{xc}({\bf r};n)+ \int n({\bf r}')
        {\delta \epsilon_{xc}({\bf r}';n)\over\delta n({\bf r})}\d^3r'"/></p>
</div></div>
<div class="section" id="total-energy">
<h2>Total Energy<a class="headerlink" href="#total-energy" title="Permalink to this headline">¶</a></h2>
<p>We already derived all the necessary things above, so we just summarize it here.
The total energy is given by:</p>
<div class="math">
<p><img src="../../_images/math/db144f4d778508608c4a1fe3768d0575acd3d99d.png" alt="E[n]=(T+U)[n]+V[n]=T_s[n]+E_H[n]+(T-T_s+U-E_H)[n]+V[n]=

=T_s[n]+E_H[n]+E_{xc}[n]+V[n]"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../../_images/math/ac5cbab36160ed5ba3df280c117c400b7299af0f.png" alt="T_s[n] = \sum_i \epsilon_i -\int v_s({\bf r})n({\bf r})\d^3r

E_H[n] = \half\int V_H({\bf r}) n({\bf r}) \d^3r

E_{xc}[n]=\int \epsilon_{xc}({\bf r};n) n({\bf r}) \d^3r

V[n]=\int v({\bf r}) n({\bf r}) \d^3r"/></p>
</div><p>This is the correct, quadratically convergent expression for the total energy.
We use the whole input potential <img class="math" src="../../_images/math/a389c44b1b6e6fb107e79af358a2bd55f87220c1.png" alt="V_{in}\equiv v_s"/> and its associated
eigenvalues <img class="math" src="../../_images/math/319593f7ae7122d7910bdf87a156b25f7588f1ad.png" alt="\epsilon_i"/> to calculate the kinetic energy <img class="math" src="../../_images/math/07c6b8a10e002df3e8f11024d99cab7ae30e1470.png" alt="T_s[n]"/>, this follows
from the derivation of the expression for <img class="math" src="../../_images/math/07c6b8a10e002df3e8f11024d99cab7ae30e1470.png" alt="T_s[n]"/>. Then we use the calculated
charge density to express <img class="math" src="../../_images/math/b0028f8a44f7e664713a38890a4de82c7a981a9b.png" alt="E_H[n]"/>, <img class="math" src="../../_images/math/2a228b0cfab82ec33a38319373cd61cb202205ee.png" alt="E_{xc}[n]"/> and <img class="math" src="../../_images/math/16a3ec972c7a23ad2299075d3ca4b8045b71be9c.png" alt="V[n]"/>.</p>
<p>If one is not careful about the potential associated with the eigenvalues,
i.e., confusing <img class="math" src="../../_images/math/16fc4b65029f2cadd229a56b4e62ecd1efbf69b2.png" alt="V_{in}"/> with <img class="math" src="../../_images/math/ee78831cb96266640a51dc11abb890488808a944.png" alt="V_{out}"/>, one gets a slowly converging formula
for the total energy. By expanding <img class="math" src="../../_images/math/7d0220e2a0c12c2a6048f99e473516e1a4efab88.png" alt="v_s"/> using <a href="#equation-V_in">(12)</a>:</p>
<div class="math">
<p><img src="../../_images/math/ddac1a3ec1ccdaad32b74ed6893bbf096b562c3a.png" alt="\int v_s n({\bf r})\d^3 r
    = \int (V_H + V_{xc} + v) n({\bf r})\d^3 r
    = 2 \half\int V_H n({\bf r})\d^3 r
    + \int V_{xc} n({\bf r})\d^3 r
    + \int v n({\bf r})\d^3 r =

    = 2 E_H[n] + \int V_{xc} n({\bf r})\d^3 r + V[n]"/></p>
</div><p>So <img class="math" src="../../_images/math/43b3aabcb88e217357a0b38741411a9357bf238f.png" alt="T_s"/> is equal to:</p>
<div class="math">
<p><img src="../../_images/math/170c36a754485f793ebef6e97ebf03d73e21234b.png" alt="T_s[n] = \sum_i \epsilon_i -\int v_s({\bf r})n({\bf r})\d^3r =

    = \sum_i \epsilon_i - 2 E_H[n] - \int V_{xc} n({\bf r})\d^3 r - V[n]"/></p>
</div><p>And then the slowly converging form of total energy is:</p>
<div class="math">
<p><img src="../../_images/math/e3ca4c2178265a7c5fd846458aa1d17e03d04637.png" alt="E[n] = T_s[n]+E_H[n]+E_{xc}[n]+V[n]
    = \sum_i \epsilon_i - 2 E_H[n] - \int V_{xc} n({\bf r})\d^3 r - V[n]
        +E_H[n]+E_{xc}[n]+V[n] =

    = \sum_i \epsilon_i - E_H[n] + E_{xc}[n]
        -\int V_{xc}({\bf r};n) n({\bf r}) \d^3r"/></p>
</div><p>The reason it is slowly converging is because the new formula for kinetic
energy is mixing <img class="math" src="../../_images/math/16fc4b65029f2cadd229a56b4e62ecd1efbf69b2.png" alt="V_{in}"/> with <img class="math" src="../../_images/math/ee78831cb96266640a51dc11abb890488808a944.png" alt="V_{out}"/>, so it is not as precise (see above)
and converges much slower with SCF iterations. Once self-consistency has been
achieved (i.e. <img class="math" src="../../_images/math/a239911f815a293a9a49c5684b49b89033e2acb1.png" alt="V_{in}=V_{out}"/>), the two expressions for total energy are
equivalent.</p>
</div>
<div class="section" id="xc-approximations">
<h2>XC Approximations<a class="headerlink" href="#xc-approximations" title="Permalink to this headline">¶</a></h2>
<p>All the expressions above are exact (no approximation has been made so far).
Unfortunately, no one knows <img class="math" src="../../_images/math/d9f8c376278e0040e38bf4736e2c59dc3020e31b.png" alt="\epsilon_{xc}({\bf r}';n)"/> exactly (yet). As such,
various approximations for it exist.</p>
<div class="section" id="lda">
<h3>LDA<a class="headerlink" href="#lda" title="Permalink to this headline">¶</a></h3>
<p>The most
simple approximation is the <em>local density approximation</em> (LDA), for which the
xc energy density <img class="math" src="../../_images/math/c2f25bc635cc1f6b90da2c9d7f4f6100aa6b82ce.png" alt="\epsilon_{xc}"/> at <img class="math" src="../../_images/math/2d671c8502873792085d5a0571d9eef1d3b4fb0b.png" alt="\bf r"/> is taken as that of a homogeneous
electron gas (the nuclei are replaced by a uniform positively charged
background, density <img class="math" src="../../_images/math/6a67645f769bfcb051c8867906346e6648d2123f.png" alt="n=\rm const"/>) with the same local density:</p>
<div class="math">
<p><img src="../../_images/math/d5adce8982f9b3a142e0ff364d6b1926ae7b85f0.png" alt="\epsilon_{xc}({\bf r};n)\approx\epsilon_{xc}^{LD}(n({\bf r}))"/></p>
</div><p>The xc potential <img class="math" src="../../_images/math/3b0d3c19f8504e0f1d73a9958fa041f8b9d05328.png" alt="V_{xc}"/> defined by <a href="#equation-Vxcpot">(10)</a> is then</p>
<div class="math">
<p><img src="../../_images/math/f73aa1ffdd053df6a4ac7ed7a4f169256903e9f3.png" alt="V_{xc}({\bf r};n)={\delta E_{xc}[n]\over\delta n({\bf r})}= \epsilon_{xc}({\bf r};n)+ \int n({\bf r}'){\delta \epsilon_{xc}({\bf r}';n)\over\delta n({\bf r})}\d^3r'"/></p>
</div><p>which in the LDA becomes</p>
<div class="math" id="equation-Vxcld">
<p><span class="eqno">(15)</span><img src="../../_images/math/fcd1ad920ffbaef979b1ea65a1940a9699b3e80e.png" alt="V_{xc}({\bf r};n) =\epsilon_{xc}^{LD}(n)+n{\d \epsilon_{xc}^{LD}(n)\over \d n}= {\d \over \d n}\left(n\epsilon_{xc}^{LD}(n)\right)= V_{xc}^{LD}(n)"/></p>
</div><p>The xc energy density <img class="math" src="../../_images/math/b0122a5284def13da5c83f6c111df01679559680.png" alt="\epsilon_{xc}^{LD}"/> of the homogeneous gas can be
computed exactly:</p>
<div class="math">
<p><img src="../../_images/math/9cafc38c7cd272d575776b160a14f86440fe1fcf.png" alt="\epsilon_{xc}^{LD}(n)=\epsilon_x^{LD}(n)+\epsilon_c^{LD}(n)"/></p>
</div><p>where the <img class="math" src="../../_images/math/346ef87b4ad265fbea53cdfcf62686e186f5bb5a.png" alt="\epsilon_x^{LD}"/> is the electron gas exchange term given
by</p>
<div class="math">
<p><img src="../../_images/math/f0b7068f28abc507f530f89fced1f1698807bd77.png" alt="\epsilon_x^{LD}(n)=-{3\over4\pi}(3\pi^2 n)^{1\over3}"/></p>
</div><p>the rest of <img class="math" src="../../_images/math/b0122a5284def13da5c83f6c111df01679559680.png" alt="\epsilon_{xc}^{LD}"/> is hidden in <img class="math" src="../../_images/math/ce8bd4762d95aaca897f57d11b7b08443b8a1841.png" alt="\epsilon_c^{LD}(n)"/> for which
there doesn&#8217;t exist an analytic formula, but the correlation energies are known
exactly from quantum Monte Carlo (QMC) calculations by Ceperley and
Alder <a class="reference internal" href="#pickett">[pickett]</a>. The energies were fitted by Vosko, Wilkes and Nussair
(VWN) with <img class="math" src="../../_images/math/ce8bd4762d95aaca897f57d11b7b08443b8a1841.png" alt="\epsilon_c^{LD}(n)"/> and they got accurate results with errors less
than <img class="math" src="../../_images/math/f1310894a14b373cfb3557a8d14e85c6ec61b3dc.png" alt="0.05\rm\,mRy"/> in <img class="math" src="../../_images/math/45beda0e4c86ffa29c04fc82100ef55714a6338b.png" alt="\epsilon_c^{LD}"/>, which means that <img class="math" src="../../_images/math/ce8bd4762d95aaca897f57d11b7b08443b8a1841.png" alt="\epsilon_c^{LD}(n)"/>
is virtually known exactly. VWN result:</p>
<div class="math">
<p><img src="../../_images/math/8841ea3eceef33e012a9a9cc1f9436e0706c33a4.png" alt="\epsilon_c^{LD}(n)\approx {A\over2}\left\{ \ln\left(y^2\over Y(y)\right)+{2b\over Q}\arctan\left(Q\over 2y+b\right)+ \right.

\left. -{by_0\over Y(y_0)}\left[\ln\left((y-y_0)^2\over Y(y)\right) +{2(b+2y_0)\over Q}\arctan\left(Q\over 2y+b\right) \right] \right\}"/></p>
</div><p>where <img class="math" src="../../_images/math/cf7c35dcc737d953692e3ef8b8f003487b7d738f.png" alt="y=\sqrt{r_s}"/>, <img class="math" src="../../_images/math/7af1c8406206d92f86695f40075552dadf110f8a.png" alt="Y(y)=y^2+by+c"/>, <img class="math" src="../../_images/math/8ea47fd8c5e2bfc4c28e63174dd73c02b32658e1.png" alt="Q=\sqrt{4c-b^2}"/>, <img class="math" src="../../_images/math/8eb59f2ad74b4d866df61bb2cda326e151fa36cf.png" alt="y_0=-0.10498"/>,
<img class="math" src="../../_images/math/ae1d610974c3bc0d706c799a86cb9eb1dd3d9803.png" alt="b=3.72744"/>, <img class="math" src="../../_images/math/b7ceacfcf7c295143a97a5eee32a345117251f9d.png" alt="c=12.9352"/> (note that the value of <img class="math" src="../../_images/math/3372c1cb6d68cf97c2d231acc0b47b95a9ed04cc.png" alt="c"/> is wrong in
<a class="reference internal" href="#pickett">[pickett]</a>), <img class="math" src="../../_images/math/f8943f43dddeb3427c8cb3147b93ab84e3a6ecdc.png" alt="A=0.0621814"/> and <img class="math" src="../../_images/math/7233796caa633cd296d9fee90f9ee4baa2bc7b60.png" alt="r_s"/> is the electron gas
parameter, which gives the mean distance between electrons (in atomic units):</p>
<div class="math">
<p><img src="../../_images/math/dfb9f4617e327f7931b983cf62e0907dbd301db5.png" alt="r_s=\left(3\over4\pi n\right)^{1\over3}"/></p>
</div><p>The xc potential is then computed from <a href="#equation-Vxcld">(15)</a>:</p>
<div class="math">
<p><img src="../../_images/math/52483aa71c6d51b8518bd9a411bc1a294a0fff42.png" alt="V_{xc}^{LD}=V_x^{LD}+V_c^{LD}

V_x^{LD}=-{1\over\pi}(3\pi^2 n)^{1\over3} = {4\over 3}\epsilon_x^{LD}

V_c^{LD}={A\over2}\left\{ \ln\left(y^2\over Y(y)\right)+{2b\over Q}\arctan\left(Q\over 2y+b\right)+ \right.

\left. -{by_0\over Y(y_0)}\left[\ln\left((y-y_0)^2\over Y(y)\right) +{2(b+2y_0)\over Q}\arctan\left(Q\over 2y+b\right) \right] \right\}+

-{A\over6}{c(y-y_0)-by_0y\over (y-y_0)Y(y)}"/></p>
</div><p>Some people also use Perdew and Zunger formulas, but they give essentially the
same results. The LDA, although very simple, is surprisingly successful. More
sophisticated approximations exist, for example the generalized gradient
approximation (GGA), which sometimes gives better results than the LDA, but is
not perfect either. Other options include orbital-dependent (implicit) density
functionals or a linear response type functionals, but this topic is still
evolving. The conclusion is, that the LDA is a good approximation to start
with, and only when we are not satisfied, we will have to try some more
accurate and modern approximation.</p>
</div>
<div class="section" id="rlda">
<h3>RLDA<a class="headerlink" href="#rlda" title="Permalink to this headline">¶</a></h3>
<p>Relativistic corrections to the energy-density functional (RLDA) were proposed
by MacDonald and Vosko:</p>
<div class="math">
<p><img src="../../_images/math/3fddddcf1c03262e4c07de4a0d093f8bd39e7144.png" alt="\epsilon_x^{RLD}(n) = \epsilon_x^{LD}(n)R

R = 1-{3\over2}\left(\beta\mu-\ln(\beta+\mu)\over\beta^2\right)^2
= 1-{3\over2} A^2"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../../_images/math/faaf0b5ef1db046ba9699d480593ed5add4d8e80.png" alt="\mu=\sqrt{1+\beta^2}

\beta={(3\pi^2n)^{1\over3}\over c} = -{4\pi\over 3c} \epsilon_x^{LD}

A = {\beta\mu-\log(\beta+\mu)\over\beta^2}"/></p>
</div><p>We now calculate <img class="math" src="../../_images/math/941aa4a67faa50046a316947ca4c3a1e0c2a4cdc.png" alt="V_x^{RLD}"/>:</p>
<div class="math" id="equation-RLDA">
<p><span class="eqno">(16)</span><img src="../../_images/math/3fa581bc937b3a1ac86a3e14888ff209f1623566.png" alt="V_x^{RLD}
=\epsilon_x^{LD}R+n{\d \epsilon_x^{LD}R\over\d n}=

=\epsilon_x^{LD}R+n{\d \epsilon_x^{LD}\over\d n}R
    +n\epsilon_x^{LD}{\d R\over\d n}
    =

=\epsilon_x^{LD}R+n{\d \epsilon_x^{LD}\over\d n}R
    +n\epsilon_x^{LD}{\d R\over\d \beta}{\d\beta\over\d n}"/></p>
</div><p>where the derivative <img class="math" src="../../_images/math/d8cc4736dbcb0fe896b26067b40fd71ec909197b.png" alt="{\d\beta\over\d n}"/> can be evaluated as follows:</p>
<div class="math">
<p><img src="../../_images/math/5a54bec2244c262bf438a419fe9a41058c90762e.png" alt="{\d \beta\over\d n}
    = {\d \over \d n}{(3\pi^2n)^{1\over3}\over c}
    = {1 \over 3n}{(3\pi^2n)^{1\over3}\over c}
    = {\beta\over 3n}"/></p>
</div><p>And <img class="math" src="../../_images/math/47156340dca81d9de156837e110f8b54c074eb2a.png" alt="{\d \epsilon_x^{LD}\over\d n}"/> in exactly the same manner:</p>
<div class="math">
<p><img src="../../_images/math/bbb1357b6d2b66e7a25df95b8b03586ac13c9233.png" alt="{\d \epsilon_x^{LD}\over\d n} = ... = {\epsilon_x^{LD}\over 3n}"/></p>
</div><p>So we can write</p>
<div class="math">
<p><img src="../../_images/math/e65144fc0062e676b43ddab945d677b0a0547145.png" alt="V_x^{RLD}
=\epsilon_x^{LD}R+n{\d \epsilon_x^{LD}\over\d n}R
    +n\epsilon_x^{LD}{\d R\over\d \beta}{\d\beta\over\d n}
=

=\epsilon_x^{LD}R+n{\epsilon_x^{LD}\over 3n}R
    +n\epsilon_x^{LD}{\d R\over\d \beta}{\beta\over 3n}
=

=
{4\over3}\epsilon_x^{LD}R+{1\over3}\epsilon_x^{LD}{\d R\over\d\beta}\beta
=

=
{4\over3}\epsilon_x^{LD}\left(R+{1\over4}\beta{\d R\over\d\beta}\right)
=

=
V_x^{LD}\left(R+{1\over4}\beta{\d R\over\d\beta}\right)"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../../_images/math/e8ca866e24a0e1d001fe54c520647861e776ae1d.png" alt="{\d R\over\d \beta}= -{3\over 2} 2 A A' = -3AA'
=

=-6 A \left({1\over\mu} - {A\over\beta}\right)"/></p>
</div><p>where we used the derivative of <img class="math" src="../../_images/math/8612059b73b3b878ffd2916c4f115532549e459f.png" alt="A(\beta)"/>, which after a tedious, but
straightforward differentiation is:</p>
<div class="math">
<p><img src="../../_images/math/82a01d33fe313436d4ce35f13bc1713714b5f9b1.png" alt="A'(\beta) = \cdots = 2\left({1\over\mu} - {A\over\beta}\right)"/></p>
</div><p>Plugging this back in, we get:</p>
<div class="math">
<p><img src="../../_images/math/c073207826149998bbc88b77e3d4475409ac1ff1.png" alt="V_x^{RLD} = V_x^{LD}\left(R+{1\over4}\beta{\d R\over\d\beta}\right)
=

=
V_x^{LD}\left(1-{3\over 2}A^2 +{1\over4}\beta(-6A)
\left({1\over\mu} - {A\over\beta}\right)
\right)
=

=
V_x^{LD}\left(1-{3\over 2}A^2 + {6\over4} A^2-{6\over4}\beta {A\over\mu}
\right)
=

=
V_x^{LD}\left(1-{3\over2}{\beta\over\mu} A
\right)
=

=
V_x^{LD}\left(1-{3\over2}{\beta\over\mu} \left(
    \beta\mu - \log(\beta+\mu) \over \beta^2\right)
\right)
=

=
V_x^{LD}\left(1-{3\over2} \left(
    \beta\mu - \log(\beta+\mu) \over \beta\mu\right)
\right)
=

= V_x^{LD}\left({3\log(\beta+\mu) \over 2\beta\mu}-\half\right)"/></p>
</div><p>For <img class="math" src="../../_images/math/5aed179f587c3ac274cb5c3135b4ec6a8a3e9c80.png" alt="c\to\infty"/> we get <img class="math" src="../../_images/math/7c78eb6e1ead9d23cea6d65d9ca3094a2bdcf0f0.png" alt="\beta\to0"/>, <img class="math" src="../../_images/math/cae1b543f4b609e25fe004bdbfd6bd51eca06d4a.png" alt="R\to1"/> and <img class="math" src="../../_images/math/6e2eca925c5d712db6ae11b61c2dd2aa7d30eb52.png" alt="V_x^{RLD}\to
{4\over3}\epsilon_x^{LD}=V_x^{LD}"/> as expected, because</p>
<div class="math">
<p><img src="../../_images/math/d992658e765fc3bbf1192789c4d5d30495d74e27.png" alt="\lim_{\beta\to0}{\beta\sqrt{1+\beta^2}-\ln(\beta+\sqrt{1+\beta^2})\over \beta^2} = 0"/></p>
</div><p>Code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">limit</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&quot;beta&quot;</span><span class="p">)</span>
<span class="go">beta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span><span class="p">((</span><span class="n">beta</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">beta</span><span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="n">beta</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="radial-dft-problem">
<h2>Radial DFT Problem<a class="headerlink" href="#radial-dft-problem" title="Permalink to this headline">¶</a></h2>
<div class="section" id="kohn-sham-equations">
<h3>Kohn-Sham Equations<a class="headerlink" href="#kohn-sham-equations" title="Permalink to this headline">¶</a></h3>
<p>For spherically symmetric potentials, we write all eigenfunctions as:</p>
<div class="math">
<p><img src="../../_images/math/78147c8dbdfe5303faa2be11d11cd03ec9cb4d27.png" alt="\psi_{nlm} = R_{nl} Y_{lm}"/></p>
</div><p>and we need to solve the following Kohn-Sham equations:</p>
<div class="math">
<p><img src="../../_images/math/e0189b80227ca61963e2324e3c8c42ac03375189.png" alt="-{1\over2}R_{nl}'' - {1\over r}R_{nl}' +
    \left(V + {l(l+1)R\over2 r^2}\right)R_{nl} = \epsilon_{nl} R_{nl}"/></p>
</div><p>With normalization:</p>
<div class="math">
<p><img src="../../_images/math/0e31da0821d3b159019dcf983668e3645c95a900.png" alt="\int R_{nl}^2 \,r^2 \,\d r = 1"/></p>
</div><p>For Schroedinger equation, the charge density is calculated by adding all &#8220;(n,
l, m)&#8221; states together, counting each one twice (for spin up and spin
down):</p>
<div class="math">
<p><img src="../../_images/math/75bb41d3f4e80ec50d21d64261545dfaef78fd69.png" alt="n({\bf r}) = \sum_{nlm}2|\psi_{nlm}|^2
    = \sum_{nlm}R_{nl}^2 2|Y_{lm}|^2
    = \sum_{nl}R_{nl}^2 2\sum_m|Y_{lm}|^2
    = {1\over 4\pi}\sum_{nl}f_{nl} R_{nl}^2"/></p>
</div><p>where we have introduced the occupation numbers <img class="math" src="../../_images/math/e8d1d1630bc2e021ff5cfe63a9b2762c09e56ba0.png" alt="f_{nl}"/> by</p>
<div class="math">
<p><img src="../../_images/math/60b244c68bfb763c06aedea21cc9744584873039.png" alt="f_{nl} = 4\pi\,2\sum_m |Y_{lm}|^2"/></p>
</div><p>Normalization of the charge density is:</p>
<div class="math">
<p><img src="../../_images/math/980032e02c9751c28131842095f481a7605df1ec.png" alt="Z = \int n({\bf r}) \d^3 x
    = \int n(r) \, r^2\d\Omega \d r
    = 4\pi\int n(r) \, r^2 \d r
    =

    = 4\pi\int {1\over 4\pi} \sum_{nl} f_{nl} R_{nl}^2\, r^2\d\Omega \d r
    =

    = \sum_{nl} f_{nl}\int R_{nl}^2\, r^2 \d r
    =

    = \sum_{nl} f_{nl}"/></p>
</div><p>So we can see, that it must hold:</p>
<div class="math">
<p><img src="../../_images/math/d0376bb5c5cbb2c3d8006f1028584d2a9df7ff60.png" alt="\sum_{nl} f_{nl} = Z"/></p>
</div><p>where <img class="math" src="../../_images/math/3ead47fb9fb4a4c273feee398f72ff2a09702b84.png" alt="Z"/> is the atomic number (number of electrons), and as such, <img class="math" src="../../_images/math/e8d1d1630bc2e021ff5cfe63a9b2762c09e56ba0.png" alt="f_{nl}"/> are
indeed the occupation numbers (integers). The factor <img class="math" src="../../_images/math/a72a1caa0cb9e0f72f414ebd8180ea676808568f.png" alt="4\pi"/> is
explicitly factored out, as it cancels with the spherical harmonics:
assuming all <img class="math" src="../../_images/math/f5047d1e0cbb50ec208923a22cd517c55100fa7b.png" alt="m"/> states are occupied, this can be simplified to:</p>
<div class="math">
<p><img src="../../_images/math/963da352c6c768f431571c2f8ea1c502dbcf6733.png" alt="f_{nl} = 4\pi\,2\sum_m |Y_{lm}|^2
    = 4\pi\,2{2l+1\over 4\pi}
    = 2(2l+1)"/></p>
</div><p>We can also use this machinery to prescribe &#8220;chemical occupation numbers&#8221;, that
don&#8217;t necessarily correspond to the DFT ground state. For example for <img class="math" src="../../_images/math/e2bbebb3bd73f1ae5c64098ab0244f739abf7ca4.png" alt="U"/> atom
we get:</p>
<div class="math">
<p><img src="../../_images/math/930311633e2812d8b0c64de8fb4162ac75aad692.png" alt="f_{1l} = 2 (2l+1)

f_{2l} = 2 (2l+1)

f_{3l} = 2 (2l+1)

f_{4l} = 2 (2l+1)

f_{5l} = 2 (2l+1)\quad\quad l\le2

f_{53} = 3

f_{60} = 2

f_{61} = 6

f_{62} = 1

f_{70} = 2"/></p>
</div><p>By summing all these <img class="math" src="../../_images/math/e8d1d1630bc2e021ff5cfe63a9b2762c09e56ba0.png" alt="f_{nl}"/>, we get 92 as expected:</p>
<div class="math">
<p><img src="../../_images/math/29aeca32f72a63ba49169ba211b1f9468844d004.png" alt="\sum_{nl} f_{nl} = 2 + (2+6) + (2+6+10) + (2+6+10+14) + (2+6+10) +

    + 3 + 2 + 6 + 1 + 2 = 92"/></p>
</div><p>But this isn&#8217;t the DFT ground state, because some KS energies are skipped, for
example there is only one state for <img class="math" src="../../_images/math/2f2a6991d2108f237ee451bf37db91cacaf4134e.png" alt="n=6"/>, <img class="math" src="../../_images/math/e6fbb515c22e2b4d5f4b9a2b164b626a4e3e2a72.png" alt="l=2"/>, but there are nine more
states with the same energy &#8212; instead two more states are occupied in <img class="math" src="../../_images/math/f7f0f830b5b25ea929198068e407e8c9f62f56c4.png" alt="n=7"/>,
<img class="math" src="../../_images/math/f5644099294a33bf6ea99f64e0eba8cb70bbc020.png" alt="l=0"/>, but those have higher energy. So this corresponds to excited DFT state,
strictly speaking not physically valid in the DFT formalism, but in practice
this approach is often used. One can also prescribe fractional occupation
numbers (in the Dirac case).</p>
</div>
<div class="section" id="poisson-equation">
<h3>Poisson Equation<a class="headerlink" href="#poisson-equation" title="Permalink to this headline">¶</a></h3>
<p>Poisson equation becomes:</p>
<div class="math">
<p><img src="../../_images/math/00c6473b8d4deea7ead01a199fda1f3e5e629d69.png" alt="V_H''(r) + {2\over r} V_H'(r) = -4\pi n(r)"/></p>
</div></div>
<div class="section" id="id6">
<h3>Total Energy<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>The total energy is given by:</p>
<div class="math">
<p><img src="../../_images/math/1f6e5d401ffa4d9c41402f3a7e1f8dc8f3b4541f.png" alt="E[n]= T_s[n]+E_H[n]+E_{xc}[n]+V[n]"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../../_images/math/7b0ed3f3f12d5864f72bed4012bf08be06cfffe6.png" alt="T_s[n] = \sum_{nl} f_{nl}\epsilon_{nl}
    -\int (V_H(r) + V_{xc}(r) + v(r))_{in} n(r) \d^3 r
    =

    = \sum_{nl} f_{nl}\epsilon_{nl}
        -\int \left(V_H(r) + V_{xc}(r) -{Z\over r}\right)_{in} n(r) \d^3 r

E_H[n] = \half\int V_H(r) n(r) \d^3r

E_{xc}[n]=\int \epsilon_{xc}(r;n) n(r) \d^3r

V[n]=\int v(r) n(r) \d^3r = -\int {Z\over r} n(r) \d^3r"/></p>
</div><p>doing the integrals a bit we get:</p>
<div class="math">
<p><img src="../../_images/math/d5e6c4faf8a8b0efd099154bffa9d3e1c2dfba2c.png" alt="T_s[n] = \sum_{nl} f_{nl}\epsilon_{nl}
        -4\pi\int \left(V_H(r) + V_{xc}(r) -{Z\over r}\right)_{in} n(r)
            r^2\,\d r

E_H[n] = 2\pi\int V_H(r) n(r)r^2\, \d r

E_{xc}[n]=4\pi\int \epsilon_{xc}(r;n) n(r)r^2\, \d r

V[n]=-4\pi \int {Z\over r} n(r)r^2\, \d r
    =-4\pi Z \int n(r)r\, \d r"/></p>
</div><p>We can also express everything using the charge density <img class="math" src="../../_images/math/66b7874e970825592ee43dc0c406f887c89c77f2.png" alt="\rho(r) = -n(r)"/>:</p>
<div class="math">
<p><img src="../../_images/math/f838e1f3bf417a4c3466a824cdd4ce43d3e84306.png" alt="T_s[n] = \sum_{nl} f_{nl}\epsilon_{nl}
        +4\pi\int \left(V_H(r) + V_{xc}(r) -{Z\over r}\right)_{in} \rho(r)
            r^2\,\d r

E_H[n] = -2\pi\int V_H(r) \rho(r)r^2\, \d r

E_{xc}[n]=-4\pi\int \epsilon_{xc}(r;n) \rho(r)r^2\, \d r

V[n]=4\pi \int {Z\over r} \rho(r)r^2\, \d r
    =4\pi Z \int \rho(r)r\, \d r"/></p>
</div></div>
</div>
<div class="section" id="dft-as-a-nonlinear-problem">
<h2>DFT As a Nonlinear Problem<a class="headerlink" href="#dft-as-a-nonlinear-problem" title="Permalink to this headline">¶</a></h2>
<p>The task is to find such a charge density <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>, so that all the equations below
hold (e.g. are self-consistent):</p>
<div class="math">
<p><img src="../../_images/math/3955d943553ea47efe2e7c18a910cde08612c235.png" alt="V = -{Z\over r} + V_H + V_{xc}

\left(-\nabla^2+V\right)\phi_m = \epsilon_m\phi_m,\quad\quad m = 1, 2, \dots, 4

n = \sum_{m=1}^4 \phi_m^2

V_{xc} = f(n)

\nabla^2 V_H = -4\pi n"/></p>
</div><p>This is a standard nonlinear problem, except that the Jacobian is dense, as
shown below.</p>
<div class="section" id="reformulation">
<h3>Reformulation<a class="headerlink" href="#reformulation" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s write everything in terms of <img class="math" src="../../_images/math/07aa4128847ea85c9c3b9a45d18df01edb03ccbf.png" alt="\phi_m(x)"/> explicitly:</p>
<div class="math">
<p><img src="../../_images/math/1d81fb70cd7d50ea7522d16636b7227959e0a35a.png" alt="n(x) = \sum_{m=1}^4 \phi_m^2(x)

V_{xc}(x) = f(n(x)) = f\left( \sum_{m=1}^4\phi_m^2(x) \right)

V_H(x) = \int_\Omega {n(x')\over|x' - x|}\d x'=
\int_\Omega {
\sum_{m=1}^4 \phi_m^2(x')
\over|x' - x|}\d x'

V(x) = -{Z\over r} + V_H(x) + V_{xc}(x)=

=-{Z\over r}+
\int_\Omega {
\sum_{m=1}^4 \phi_m^2(x')
\over|x' - x|}\d x'
+f\left( \sum_{m=1}^4\phi_m^2(x) \right)"/></p>
</div><p>Now we can write everything as just one (nonlinear)
equation:</p>
<div class="math">
<p><img src="../../_images/math/bc35a49910a85e4982701221a97fa127f88dce97.png" alt="\left(-\nabla^2
-{Z\over r}+
\int_\Omega {
\sum_{m=1}^4 \phi_m^2(x')
\over|x' - x|}\d x'
+f\left( \sum_{m=1}^4\phi_m^2(x) \right)
\right)\phi_n = \epsilon_n\phi_n,\quad\quad n = 1, 2, \dots, 4"/></p>
</div></div>
<div class="section" id="fe-discretization">
<h3>FE Discretization<a class="headerlink" href="#fe-discretization" title="Permalink to this headline">¶</a></h3>
<p>The correspondig discrete problem has the form</p>
<div class="math">
<p><img src="../../_images/math/1c48c4e069f6e50b9092e521b247f96e25d1860b.png" alt="\int_\Omega \nabla\phi_n(x)\cdot\nabla v_i(x)+\left[
-{Z\over r}+
\int_\Omega {
\sum_{m=1}^4 \phi_m^2(x')
\over|x' - x|}\d x'
+f\left( \sum_{m=1}^4\phi_m^2(x) \right)
\right]
\phi_n(x) v_i(x)  \d x=

=\int_\Omega
\epsilon_n\phi_n(x) v_i(x) \d x,\quad\quad n = 1, 2, \dots, 4;\quad
i = 1, 2, \dots, N"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../../_images/math/6bbd7733ffc2167b91fe308e22d113bfd4cf0405.png" alt="\phi_n = \phi_n({\bf Y}^{(n)}) = \sum_{j=1}^N y_j^{(n)} v_j(x)"/></p>
</div><p>Here <img class="math" src="../../_images/math/d0ea3dd33b2b0fc29b0583f997383389d1a29930.png" alt="{\bf Y}^{(n)} = (y_1^{(n)}, y_2^{(n)}, \dots, y_N^{(n)})^T"/> is the vector
of unknown coefficients for the <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>-th wavefunction <img class="math" src="../../_images/math/3039842d9e2c0ed4091c97ce04a95f5e81a8eb21.png" alt="\phi_n(x)"/>. Our equation
can then be written in the compact form</p>
<div class="math">
<p><img src="../../_images/math/c24402ab0ccec41e8829e018307868722862a67b.png" alt="{\bf F}({\bf Y}^{(n)}) = {\bf 0},\quad\quad n = 1, 2, \dots, 4"/></p>
</div><p>where <img class="math" src="../../_images/math/cef31b74ed2d81cbeecd6f9274372384dc499ef1.png" alt="{\bf F} = (F_1, F_2, \dots, F_N)^T"/> with</p>
<div class="math">
<p><img src="../../_images/math/999b49eec72c24179acca7fe1a914c1363b9b992.png" alt="F_i({\bf Y}^{(n)}) =
\int_\Omega \nabla\phi_n(x)\cdot\nabla v_i(x)+\left[
-{Z\over r}+
\int_\Omega {
\sum_{m=1}^4 \phi_m^2(x')
\over|x' - x|}\d x'
+f\left( \sum_{m=1}^4\phi_m^2(x) \right)
\right]
\phi_n(x) v_i(x)  \d x-

-\int_\Omega
\epsilon_n\phi_n(x) v_i(x) \d x"/></p>
</div></div>
<div class="section" id="jacobian">
<h3>Jacobian<a class="headerlink" href="#jacobian" title="Permalink to this headline">¶</a></h3>
<p>The Jacobi matrix has the elements:</p>
<div class="math">
<p><img src="../../_images/math/49b336cf54535827096b334ed7e78527ff2e1d73.png" alt="J_{ik} = {\partial F_i\over\partial y_k^{(s)}}"/></p>
</div><p>The only possible dense term is:</p>
<div class="math">
<p><img src="../../_images/math/7660d6ef3dcb15aca28dc580a15038f72ffc8ad5.png" alt="{\partial\over\partial y_k^{(s)}}\int_\Omega \int_\Omega {
\sum_{m=1}^4 \phi_m^2(x')
\over|x' - x|}\d x'\,\phi_n(x) v_i(x) \d x =

=
{\partial\over\partial y_k^{(s)}}\int_\Omega \int_\Omega {
\sum_{m=1}^4 \left(\sum_{j=1}^N y_j^{(m)} v_j(x')\right)^2
\over|x' - x|}\d x'\, \left(\sum_{j=1}^N y_j^{(n)} v_j(x)\right)  v_i(x) \d x =

=
\int_\Omega \int_\Omega {
2 \left(\sum_{j=1}^N y_j^{(s)} v_j(x')\right)v_k(x')
\over|x' - x|}\d x'\, \left(\sum_{j=1}^N y_j^{(n)} v_j(x)\right)  v_i(x) \d x +

+
\int_\Omega \int_\Omega {
\sum_{m=1}^4 \left(\sum_{j=1}^N y_j^{(m)} v_j(x')\right)^2
\over|x' - x|}\d x'\, \delta_{ns}v_k(x)  v_i(x) \d x"/></p>
</div><p>Now we can see that we have in there the following term:</p>
<div class="math">
<p><img src="../../_images/math/c57f57d82f0729661fda7638019e91fc065f6eaa.png" alt="\int_\Omega \int_\Omega {v_k(x') v_i(x)\over |x'-x|}\d x'\d x"/></p>
</div><p>which is dense in <img class="math" src="../../_images/math/c9eb748e4580dc3fe1d557106b2132a9a3310ad3.png" alt="(ki)"/>, as can be easily seen be fixing <img class="math" src="../../_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/> and writing</p>
<div class="math">
<p><img src="../../_images/math/c3be6752159b08cece77999a71c0fc6611015df2.png" alt="\int_\Omega \int_\Omega {v_k(x')\over |x'-x|}\d x' v_i(x)\d x"/></p>
</div><p>so for each <img class="math" src="../../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> there is some contribution from the integral <img class="math" src="../../_images/math/85a762e8487c471686f9348b5eb2effafdb94614.png" alt="\int_\Omega
{v_k(x')\over |x'-x|}\d x'"/> for such <img class="math" src="../../_images/math/26eeb5258ca5099acf8fe96b2a1049c48c89a5e6.png" alt="x"/> where <img class="math" src="../../_images/math/da18107b9d4f56efadd92705e656501ed6d942f2.png" alt="v_i(x)"/> is nonzero, thus
making the Jacobian <img class="math" src="../../_images/math/f54abaaa7e2a86fbbd85f9710538c2f68965e650.png" alt="J_{ik}"/> dense.</p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="dft" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[DFT]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>, <a class="fn-backref" href="#id3">3</a>)</em> <ol class="last upperalpha simple" start="18">
<li><ol class="first upperalpha" start="13">
<li>Dreizler, E. K. U. Gross: Density functional theory: an approach to the quantum many-body problem</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="pickett" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[pickett]</td><td><em>(<a class="fn-backref" href="#id4">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> <ol class="last upperalpha simple" start="23">
<li><ol class="first upperalpha" start="5">
<li>Pickett, Pseudopotential methods in condensed matter applications, Computer Physics reports, Volume 9, Issue 3, April 1989, Pages 115-197, ISSN 0167-7977, DOI: 10.1016/0167-7977(89)90002-6. (<a class="reference external" href="http://www.sciencedirect.com/science/article/B6X3V-46R02CR-1J/2/804d9ecaa49469aa5e1050dc007f4a61">http://www.sciencedirect.com/science/article/B6X3V-46R02CR-1J/2/804d9ecaa49469aa5e1050dc007f4a61</a>)</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Density Functional Theory (DFT)</a><ul>
<li><a class="reference internal" href="#many-body-schrodinger-equation">Many Body Schrödinger Equation</a></li>
<li><a class="reference internal" href="#the-hohenberg-kohn-theorem">The Hohenberg-Kohn Theorem</a></li>
<li><a class="reference internal" href="#the-kohn-sham-equations">The Kohn-Sham Equations</a></li>
<li><a class="reference internal" href="#the-xc-term">The XC Term</a></li>
<li><a class="reference internal" href="#total-energy">Total Energy</a></li>
<li><a class="reference internal" href="#xc-approximations">XC Approximations</a><ul>
<li><a class="reference internal" href="#lda">LDA</a></li>
<li><a class="reference internal" href="#rlda">RLDA</a></li>
</ul>
</li>
<li><a class="reference internal" href="#radial-dft-problem">Radial DFT Problem</a><ul>
<li><a class="reference internal" href="#kohn-sham-equations">Kohn-Sham Equations</a></li>
<li><a class="reference internal" href="#poisson-equation">Poisson Equation</a></li>
<li><a class="reference internal" href="#id6">Total Energy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dft-as-a-nonlinear-problem">DFT As a Nonlinear Problem</a><ul>
<li><a class="reference internal" href="#reformulation">Reformulation</a></li>
<li><a class="reference internal" href="#fe-discretization">FE Discretization</a></li>
<li><a class="reference internal" href="#jacobian">Jacobian</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="radial.html"
                        title="previous chapter">Radial Schrödinger and Dirac Equations</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="hf.html"
                        title="next chapter">Hartree-Fock (HF) Method</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/src/quantum/dft.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="hf.html" title="Hartree-Fock (HF) Method"
             >next</a> |</li>
        <li class="right" >
          <a href="radial.html" title="Radial Schrödinger and Dirac Equations"
             >previous</a> |</li>
        <li><a href="../../index.html">Theoretical Physics Reference 0.5 documentation</a> &raquo;</li>
          <li><a href="main.html" >Quantum Field Theory and Quantum Mechanics</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.
    </div>
  </body>
</html>