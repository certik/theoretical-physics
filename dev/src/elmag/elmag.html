

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Maxwell’s Equations &mdash; Theoretical Physics Reference 0.5 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Theoretical Physics Reference 0.5 documentation" href="../../index.html" />
    <link rel="up" title="Classical Electromagnetism" href="main.html" />
    <link rel="next" title="Fluid Dynamics" href="../fluid-dynamics/main.html" />
    <link rel="prev" title="Classical Electromagnetism" href="main.html" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-28893880-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
     

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../fluid-dynamics/main.html" title="Fluid Dynamics"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="main.html" title="Classical Electromagnetism"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Theoretical Physics Reference 0.5 documentation</a> &raquo;</li>
          <li><a href="main.html" accesskey="U">Classical Electromagnetism</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="maxwell-s-equations">
<h1>Maxwell&#8217;s Equations<a class="headerlink" href="#maxwell-s-equations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="electromagnetic-field">
<h2>Electromagnetic Field<a class="headerlink" href="#electromagnetic-field" title="Permalink to this headline">¶</a></h2>
<p>The electromagnetic field is fully described by a vector field called the
4-potential <img class="math" src="../../_images/math/6c1c974279e05fcbe83079cba65bfda30f23d36c.png" alt="A^\alpha"/>. It has four components that we can label any way we
want, the traditional way is to use:</p>
<div class="math">
<p><img src="../../_images/math/e4b7b8b16a5a9738e9330d34ccca2df3be0df88a.png" alt="A^\alpha = \left({\phi\over c}, {\bf A}\right)"/></p>
</div><p>where <img class="math" src="../../_images/math/2c175f60eecef1de7560c3bdea495d69f26f719d.png" alt="\phi"/> is called the electrostatic scalar potential, <img class="math" src="../../_images/math/83c3c7c699d02fb20e6cd05765b0dbfae0444c10.png" alt="{\bf A}"/> is called
the vector potential and <img class="math" src="../../_images/math/3372c1cb6d68cf97c2d231acc0b47b95a9ed04cc.png" alt="c"/> is the speed of light.
The Lagrangian density for the free (noninteracting) field is:</p>
<div class="math">
<p><img src="../../_images/math/e7f9b026936d49b1c4b83f3874832d1408a32c6f.png" alt="\L = -{1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta"/></p>
</div><p>The Lagrangian for a (charged) particle is:</p>
<div class="math">
<p><img src="../../_images/math/ee8af0edacb74b8b3f090d4205617a2296c1164b.png" alt="L(x^\mu, v^\mu) = -\half m v_\alpha v^\alpha"/></p>
</div><p>it produces the following charge density:</p>
<div class="math">
<p><img src="../../_images/math/45e131fcc2e765729a45d8d17b6f9ca2c2305591.png" alt="\rho = q \delta({\bf r} - {\bf s})"/></p>
</div><p>The interaction between the charged particle (or in general any charged body)
with some charge density and the electromagnetic field is given by the
Lagrangian density:</p>
<div class="math">
<p><img src="../../_images/math/cdc7e24d93f53c38e6e0322da10a7d648d3489a8.png" alt="\L = -j_\alpha A^\alpha"/></p>
</div><p>where:</p>
<div class="math">
<p><img src="../../_images/math/8877c510cde8d6cddb505b315e0c508aa96706e5.png" alt="j^\mu = \rho v^\mu = \gamma \rho (c, {\bf v})"/></p>
</div><p>There are several approaches how to obtain the above Lagrangians from some
other assumptions, but ultimately the exact form of the Lagrangians has to be
given by experiment. It is our only assumption and we derive everything else
from it.
All together, the Lagrangian of a charged particle and an electromagnetic field
is:</p>
<div class="math" id="equation-lagem">
<p><span class="eqno">(1)</span><img src="../../_images/math/aedffa2badee84805d7c24f6b0248e6f638c353f.png" alt="L(x^\mu, v^\mu, A^\mu, \partial_\nu A^\mu)
  =-\half m v_\alpha v^\alpha
    -\int {1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
        \d^3 x
        - \int j_\alpha A^\alpha \d^3 x =

  =-\half m v_\alpha v^\alpha
    -\int {1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
        \d^3 x
        - \int \rho v_\alpha A^\alpha \d^3 x =

  =-\half m v_\alpha v^\alpha
    -\int {1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
        \d^3 x
        - q v_\alpha A^\alpha"/></p>
</div><p>Note that:</p>
<div class="math">
<p><img src="../../_images/math/3091fa7765be1ffc068fe28158583fc4eb2c4a0f.png" alt="v_\alpha A^\alpha = - \gamma \phi + \gamma {\bf v} \cdot {\bf A}"/></p>
</div><p>The Euler-Lagrange equations for the electromagnetic field (in terms of <img class="math" src="../../_images/math/806aa7b68a2b78ed6ae1adb79b77c8f5f4297ee2.png" alt="A^\mu"/>
and <img class="math" src="../../_images/math/7ee00982b319b339048f5b48c65b78a27cecf64c.png" alt="\partial_\nu A^\mu"/>) are:</p>
<div class="math">
<p><img src="../../_images/math/d46ede9b6ab42529c8f44b874883d6994ed9afd5.png" alt="\partial^\mu {\partial\over\partial (\partial^\mu A^\nu)}
\left(
    -{1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
           - j_\alpha A^\alpha
    \right)
={\partial\over\partial A^\nu}
    \left(
    -{1\over 2\mu_0} \partial_\alpha A_\beta \partial^\alpha A^\beta
           - j_\alpha A^\alpha\right)

\partial^\mu {\partial\over\partial (\partial^\mu A^\nu)}
\left(
    {1\over 2\mu_0} g_{\delta\alpha} g_{\epsilon\beta}
    \partial^\delta A^\epsilon \partial^\alpha A^\beta
    \right)
={\partial\over\partial A^\nu} j_\alpha A^\alpha

{1\over 2\mu_0} \partial^\mu g_{\delta\alpha} g_{\epsilon\beta}
\left(
    \delta^\delta_\mu \delta^\epsilon_\nu \partial^\alpha A^\beta
    +
    \partial^\delta A^\epsilon \delta^\alpha_\mu \delta^\beta_\nu
    \right)
= j_\alpha \delta^\alpha_\nu

{1\over 2\mu_0} \partial^\mu
\left(  g_{\mu\alpha} g_{\nu\beta}
    \partial^\alpha A^\beta
    +g_{\delta\mu} g_{\epsilon\nu}
    \partial^\delta A^\epsilon
    \right)
= j_\nu

{1\over 2\mu_0} \partial^\mu
\left(\partial_\mu A_\nu + \partial_\mu A_\nu \right)
= j_\nu

{1\over \mu_0} \partial^\mu \partial_\mu A_\nu = j_\nu"/></p>
</div><div class="math" id="equation-Aeq1">
<p><span class="eqno">(2)</span><img src="../../_images/math/1bd775a81aa431c17c6bf57ea963f893953f9878.png" alt="\partial^\mu \partial_\mu A_\nu = \mu_0 j_\nu"/></p>
</div><p>Equations for the particle (in terms of <img class="math" src="../../_images/math/722f3b6277a446e566f96e31afbf7deab71d4a58.png" alt="x^\mu"/> and <img class="math" src="../../_images/math/6fa24d4711d661d6242c44024a76591970dfa5ff.png" alt="v^\mu"/>) are:</p>
<div class="math">
<p><img src="../../_images/math/18777d7a9c82f3dd2920af369d191aae70451d21.png" alt="{\d \over \d \tau} {\partial L\over \partial v_\mu}
     = {\partial L \over \partial x_\mu}

{\d \over \d \tau} {\partial \over \partial v_\mu}
    \left(\half m g^{\alpha\beta} v_\alpha v_\beta
        + q v_\alpha A^\alpha\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}

{\d \over \d \tau}
    \left(
        \half m g^{\alpha\beta} (\delta_{\alpha\mu} v_\beta
        + v_\alpha \delta_{\beta\mu})
        + q \delta_{\alpha\mu} A^\alpha\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}

{\d \over \d \tau}
    \left(
        \half m (g^{\mu\beta} v_\beta + g^{\alpha\mu} v_\alpha)
        + q A^\mu\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}

{\d \over \d \tau}
    \left(
        \half m (v^\mu + v^\mu)
        + q A^\mu\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}

{\d \over \d \tau}
    \left(m v^\mu + q A^\mu\right)
     = q v_\alpha {\partial A^\alpha \over \partial x_\mu}

m {\d v^\mu \over \d \tau}
     = q \left(-{\d A^\mu\over\d\tau}
        + v_\alpha \partial^\mu A^\alpha\right)

m {\d v^\mu \over \d \tau}
     = q \left(-v_\alpha \partial^\alpha A^\mu
        + v_\alpha \partial^\mu A^\alpha\right)

m {\d v^\mu \over \d \tau}
     = q (\partial^\mu A^\alpha - \partial^\alpha A^\mu) v_\alpha"/></p>
</div><div class="math" id="equation-lorentz_rel">
<p><span class="eqno">(3)</span><img src="../../_images/math/7c45aff2932d30b6bc183efe7c16fef9aaade9d4.png" alt="m {\d v^\mu \over \d \tau}
     = q F^{\mu\alpha} v_\alpha"/></p>
</div><p>Where <img class="math" src="../../_images/math/9c2760f2bebadae27ecc67dd087c7b3e298badf3.png" alt="F^{\mu\nu}"/> is called the electromagnetic field strength tensor:</p>
<div class="math">
<p><img src="../../_images/math/cfba61e02c5faba50ef16533da3285970f0cbb49.png" alt="F^{\mu\nu} =  \partial^\mu A^\nu - \partial^\nu A^\mu"/></p>
</div><p>The only way to measure the electric field is through its interaction with the
charge particle. As such, the actual physical field (that can be measured) is
<img class="math" src="../../_images/math/9c2760f2bebadae27ecc67dd087c7b3e298badf3.png" alt="F^{\mu\nu}"/>, which is invariant under any gauge transformation:</p>
<div class="math">
<p><img src="../../_images/math/b28a445616c68d7d5a1cd0b28390c9eb2073e9f3.png" alt="A^\alpha \to A^\alpha + \partial^\alpha \psi"/></p>
</div><p>where <img class="math" src="../../_images/math/8ada738001410f131563551fb68731e4f302048d.png" alt="\psi"/> is a gauge function:</p>
<div class="math">
<p><img src="../../_images/math/0feeec1c05997a85274f7c403e8db413aa3b6d71.png" alt="F^{\mu\nu} \to  \partial^\mu (A^\nu+\partial^\nu\psi)
     - \partial^\nu (A^\mu+\partial^\mu\psi)
    = \partial^\mu A^\nu - \partial^\nu A^\mu
        +\partial^\mu \partial^\nu\psi - \partial^\nu \partial^\mu\psi
    = \partial^\mu A^\nu - \partial^\nu A^\mu
    = F^{\mu\nu}"/></p>
</div><p>In other words, two different <img class="math" src="../../_images/math/806aa7b68a2b78ed6ae1adb79b77c8f5f4297ee2.png" alt="A^\mu"/> related by the gauge transformation
represent the exact same physical electromagnetic field (as given by the field
tensor). As such, we can modify the Lagrangian by applying the gauge
transformation to the field <img class="math" src="../../_images/math/806aa7b68a2b78ed6ae1adb79b77c8f5f4297ee2.png" alt="A^\mu"/>: this changes the equations of motion for
the field (thus the numerical values for <img class="math" src="../../_images/math/806aa7b68a2b78ed6ae1adb79b77c8f5f4297ee2.png" alt="A^\mu"/> will be different), but
doesn&#8217;t change the equation of motion for the particle, so the change will not
have any physical effect (cannot be measured).</p>
<p>By choosing <img class="math" src="../../_images/math/8ada738001410f131563551fb68731e4f302048d.png" alt="\psi"/> as a solution to the equation
<img class="math" src="../../_images/math/59a4f8ea3756468b4ae0f7e3563c21984a28eeb7.png" alt="\partial_\mu\partial^\mu\psi=-\partial_\mu A^\mu"/>, we get:</p>
<div class="math">
<p><img src="../../_images/math/2cdfa285db30ece1f84f27c3ffa5b7c95aecffe9.png" alt="\partial_\mu (A^\mu + \partial^\mu \psi)
    = \partial_\mu A^\mu + \partial_\mu\partial^\mu \psi
    = \partial_\mu A^\mu - \partial_\mu A^\mu
    = 0"/></p>
</div><p>So for any 4-potential we can find <img class="math" src="../../_images/math/8ada738001410f131563551fb68731e4f302048d.png" alt="\psi"/> such that the transformed 4-potential
<img class="math" src="../../_images/math/806aa7b68a2b78ed6ae1adb79b77c8f5f4297ee2.png" alt="A^\mu"/> obeys the Lorenz gauge condition <img class="math" src="../../_images/math/5fa4844aae5ada9c3d4c076eba2596adc79b5f49.png" alt="\partial_\mu A^\mu=0"/>.</p>
<p>In order to obtain a gauge
invariant Lagrangian, we need to express it using <img class="math" src="../../_images/math/9c2760f2bebadae27ecc67dd087c7b3e298badf3.png" alt="F^{\mu\nu}"/> using the
following identity:</p>
<div class="math">
<p><img src="../../_images/math/0c938d8094209c5845a21f9ac149a820c4c0c717.png" alt="{1\over 4} F_{\alpha\beta} F^{\alpha\beta}
    ={1\over 4}(\partial_\alpha A_\beta - \partial_\beta A_\alpha)
        (\partial^\alpha A^\beta - \partial^\beta A^\alpha) =

    ={1\over 4}(
        \partial_\alpha A_\beta
        \partial^\alpha A^\beta
         - \partial_\beta A_\alpha
        \partial^\alpha A^\beta
        -\partial_\alpha A_\beta
         \partial^\beta A^\alpha
         + \partial_\beta A_\alpha
          \partial^\beta A^\alpha
        ) =

    ={1\over 2}(
        \partial_\alpha A_\beta
        \partial^\alpha A^\beta
         - \partial_\beta A_\alpha
        \partial^\alpha A^\beta
        ) =

    =\half \partial_\alpha A_\beta \partial^\alpha A^\beta
         - \half\partial_\beta A_\alpha \partial^\alpha A^\beta =

    =\half \partial_\alpha A_\beta \partial^\alpha A^\beta
           -\half (\partial^\alpha A_\alpha)^2
         - \half\partial_\beta (A_\alpha \partial^\alpha A^\beta
           -A^\beta\partial^\alpha A_\alpha)"/></p>
</div><p>The 4-divergence
<img class="math" src="../../_images/math/4a4d3d52c76a1eea8485de2bc85f564947b7ab33.png" alt="\partial_\beta (A_\alpha \partial^\alpha A^\beta -A^\beta\partial^\alpha A_\alpha)"/>
doesn&#8217;t change Euler-Lagrange equations, so we can ignore it.
We can see, that in the Lorenz gauge <img class="math" src="../../_images/math/3f349c30e9b7c713da46cb8f193d36bffe7612e2.png" alt="\partial^\alpha A_\alpha=0"/> the term
<img class="math" src="../../_images/math/a68df2e624ed6f8362776f6e0a0fa2f16918ef9d.png" alt="{1\over 4} F_{\alpha\beta} F^{\alpha\beta}"/> (which is gauge invariant)
simplifies to the term <img class="math" src="../../_images/math/0877d9516f170adb83df68b95180165ae0e02d5c.png" alt="\partial_\alpha A_\beta \partial^\alpha A^\beta"/> in the
Lagrangian <a href="#equation-lagem">(1)</a>. The gauge invariant Lagrangian is:</p>
<div class="math" id="equation-lagem2">
<p><span class="eqno">(4)</span><img src="../../_images/math/cb2013d7b513f28914406d22980b6375dcde2ed3.png" alt="L(x^\mu, v^\mu, A^\mu, \partial_\nu A^\mu)
  =-\half m v_\alpha v^\alpha
    -\int {1\over 4\mu_0} F_{\alpha\beta} F^{\alpha\beta} \d^3 x
        - \int j_\alpha A^\alpha \d^3 x"/></p>
</div><p>The E.-L. equation for the particle doesn&#8217;t change, the equation for the field
becomes:</p>
<div class="math">
<p><img src="../../_images/math/68fa1a5e2ccf424eeece000539fa50f8655db57d.png" alt="\partial^\mu (\partial_\mu A_\nu-\partial_\nu A_\mu) = \mu_0 j_\nu"/></p>
</div><div class="math" id="equation-Feq1">
<p><span class="eqno">(5)</span><img src="../../_images/math/1bb4509eb5f6f1402ba838735aaf6051d19c0ac7.png" alt="\partial^\mu F_{\mu\nu} = \mu_0 j_\nu"/></p>
</div><p>Which in Lorenz gauge simplifies to equation <a href="#equation-Aeq1">(2)</a>.
In order to write equations of motion in terms of <img class="math" src="../../_images/math/9c2760f2bebadae27ecc67dd087c7b3e298badf3.png" alt="F^{\mu\nu}"/> only, we
need another equation for it:</p>
<div class="math" id="equation-Feq2">
<p><span class="eqno">(6)</span><img src="../../_images/math/95f80cf2d3306ff7e84ae0425a6784801d0c6a10.png" alt="\epsilon^{\alpha\beta\gamma\delta}\partial_\gamma F_{\alpha\beta}
    = \epsilon^{\alpha\beta\gamma\delta}\partial_\gamma
        (\partial_\alpha A_\beta - \partial_\beta A_\alpha) =

    = \epsilon^{\alpha\beta\gamma\delta}\partial_\gamma
        \partial_\alpha A_\beta
        -\epsilon^{\alpha\beta\gamma\delta}\partial_\gamma
        \partial_\beta A_\alpha = 0"/></p>
</div><p>We used the fact, that the partial derivatives are symmetric in the indices
<img class="math" src="../../_images/math/978f36b1ca0711daa9aa7048651fb7e056df3990.png" alt="\gamma\alpha"/> and <img class="math" src="../../_images/math/0982803833a6e37078c41f4d9293b409be828382.png" alt="\gamma\beta"/> while
<img class="math" src="../../_images/math/91c694968591caddef7fd97c09d5b0c0f07d86fc.png" alt="\epsilon^{\alpha\beta\gamma\delta}"/> is antisymmetric.</p>
</div>
<div class="section" id="id1">
<h2>Maxwell&#8217;s Equations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Maxwell&#8217;s equations are the equations for the electromagnetic field in terms of
the physical field strengh tensor, equations <a href="#equation-Feq1">(5)</a> and <a href="#equation-Feq2">(6)</a>:</p>
<div class="math">
<p><img src="../../_images/math/17d83c0d4e002fa7e88c775e24b173df4db6d237.png" alt="\partial^\mu F_{\mu\nu} = \mu_0 j_\nu

\epsilon^{\alpha\beta\gamma\delta}\partial_\gamma F_{\alpha\beta} = 0"/></p>
</div><p>The field strength tensor is antisymmetric, so it has 6 independent components
(we use metric tensor with signature -2):</p>
<div class="math">
<p><img src="../../_images/math/9722b1057f7a3daf2d2c874ea21b725dc22b6bbf.png" alt="F^{0i} = \partial^0 A^i - \partial^i A^0
    = {1\over c}{\partial A^i\over \partial t} +
        {\partial\over\partial x_i} {\phi\over c}
    = -{1\over c}\left(-{\partial\phi\over\partial x_i}
            -{\partial A^i\over \partial t} \right)


F^{ij} = \partial^i A^j - \partial^j A^i
    = -{\partial A^j\over\partial x_i} +{\partial A^i\over\partial x_j}
    = -(\delta^i{}_l\delta^j{}_m - \delta^i{}_m\delta^j{}_l)
        {\partial A^m\over\partial x_l}
    = -\epsilon^{ij}{}_k\epsilon^k{}_{lm} {\partial A^m\over\partial x_l}"/></p>
</div><p>There is freedom in how we label the components. The standard way is to express
them using physical fields <img class="math" src="../../_images/math/99ee03f3854092e4a9bc48ff28bab3ffcb9d66b7.png" alt="{\bf E}"/> and <img class="math" src="../../_images/math/e9ba51970da63dba1d7d83e26da50e420ca64544.png" alt="{\bf B}"/> that are introduced by:</p>
<div class="math">
<p><img src="../../_images/math/f51b144f52b73e76943519893131a91c028f1939.png" alt="{\bf E} = -\nabla\phi - {\partial {\bf A}\over\partial t}

{\bf B} = \nabla\times{\bf A}"/></p>
</div><p>or in components:</p>
<div class="math">
<p><img src="../../_images/math/61aa6650894ad4939a9e5b156077bcf96e76ad5f.png" alt="E^i = -{\partial\phi\over\partial x_i}
            -{\partial A^i\over \partial t}

B^k = \epsilon^k{}_{lm} \nabla^l A^m"/></p>
</div><p>Comparing to the above, we get:</p>
<div class="math">
<p><img src="../../_images/math/94a936ff1a5a95c5fd9a3caac57164508a01fd16.png" alt="F^{0i} = -{E^i\over c}

F^{ij} = -\epsilon^{ij}{}_k B^k"/></p>
</div><p>In particular:</p>
<div class="math">
<p><img src="../../_images/math/9a12a7d6201f91b5625d1c7449426e8a2a2cb8e6.png" alt="F^{12} = -\epsilon^{12}{}_k B^k = -\epsilon^{12}{}_3 B^3 = - B^3

F^{13} = -\epsilon^{13}{}_k B^k = -\epsilon^{13}{}_2 B^2 = + B^2

F^{23} = -\epsilon^{23}{}_k B^k = -\epsilon^{23}{}_1 B^1 = - B^1"/></p>
</div><p>so we get:</p>
<div class="math">
<p><img src="../../_images/math/047ff27746ad2d90d37ff8532e8f4d1be179551b.png" alt="F^{\mu\nu} = \left(\begin{array}{cccc}
0 &amp; -{E^1\over c} &amp; -{E^2\over c} &amp; -{E^3\over c} \\
{E^1\over c} &amp; 0 &amp; -B^3 &amp; B^2 \\
{E^2\over c} &amp; B^3 &amp; 0 &amp; -B^1 \\
{E^3\over c} &amp; -B^2 &amp; B^1 &amp; 0 \\
\end{array}\right)

F_{\mu\nu} = g_{\mu\alpha}g_{\nu\beta}F^{\alpha\beta}
    = \left(\begin{array}{cccc}
0 &amp; {E^1\over c} &amp; {E^2\over c} &amp; {E^3\over c} \\
-{E^1\over c} &amp; 0 &amp; -B^3 &amp; B^2 \\
-{E^2\over c} &amp; B^3 &amp; 0 &amp; -B^1 \\
-{E^3\over c} &amp; -B^2 &amp; B^1 &amp; 0 \\
\end{array}\right)"/></p>
</div><p>In terms of <img class="math" src="../../_images/math/d5d96cf1654a892505e76002c55130995667376e.png" alt="\bf E"/> and <img class="math" src="../../_images/math/0897b83a7a308a9efefd0b825dd72b875952ab91.png" alt="\bf B"/> fields, the Maxwell&#8217;s equations become:</p>
<div class="math">
<p><img src="../../_images/math/2d8197dbd960003b4a3ca48f94bf82a8b9d0f244.png" alt="\nabla\cdot{\bf E} = c^2\mu_0 \rho

\nabla\times{\bf B} = \mu_0 {\bf j} + {1\over c^2}{\partial{\bf E}
    \over \partial t}

\nabla\cdot{\bf B} = 0

\nabla\times{\bf E} = -{\partial{\bf B}\over\partial t}"/></p>
</div><p>In Lorenz gauge, the equation for the 4-potential is <a href="#equation-Aeq1">(2)</a>:</p>
<div class="math">
<p><img src="../../_images/math/1bd775a81aa431c17c6bf57ea963f893953f9878.png" alt="\partial^\mu \partial_\mu A_\nu = \mu_0 j_\nu"/></p>
</div><p>The solution to this equation is:</p>
<div class="math">
<p><img src="../../_images/math/05a3a4c2141a12c1b326b04dd98e7e0fcdfa54d1.png" alt="A^\beta({\bf x}, t) = {\mu_0\over 4\pi}\int
     {j^\beta({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div><p>For scalar potential (<img class="math" src="../../_images/math/632a65c82b0d143ac0630269ba8720846fc4c846.png" alt="\beta=0"/>) we get:</p>
<div class="math">
<p><img src="../../_images/math/b5d2ad16ce0e74833177de12fc1a8cc8340bece8.png" alt="{\phi({\bf x}, t)\over c} = {\mu_0\over 4\pi}\int
     {c \rho({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y

\phi({\bf x}, t) = {\mu_0 c^2\over 4\pi}\int
     {\rho({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y
    = {1\over 4\pi\epsilon_0}\int
     {\rho({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div><p>And for vector potential (<img class="math" src="../../_images/math/5d1a5045d2222e2db05d8f6f475bc3b46a71d12b.png" alt="\beta=i"/>) we get:</p>
<div class="math" id="equation-Avec_sol">
<p><span class="eqno">(7)</span><img src="../../_images/math/77449261caf951ae20b2657a95991bee4ae317ec.png" alt="{\bf A}({\bf x}, t) = {\mu_0\over 4\pi}\int
     {{\bf j}({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div></div>
<div class="section" id="lorentz-force">
<h2>Lorentz Force<a class="headerlink" href="#lorentz-force" title="Permalink to this headline">¶</a></h2>
<p>The equation for the charge particle <a href="#equation-lorentz_rel">(3)</a> is:</p>
<div class="math">
<p><img src="../../_images/math/7c45aff2932d30b6bc183efe7c16fef9aaade9d4.png" alt="m {\d v^\mu \over \d \tau}
     = q F^{\mu\alpha} v_\alpha"/></p>
</div><p>In components:</p>
<div class="math">
<p><img src="../../_images/math/39f384fdd0d2b96d31afaecf8c088026cd1b2ede.png" alt="m {\d v^0 \over \d \tau}
     = q F^{0\alpha} v_\alpha
     = -q {E^i\over c} \gamma v_i

m {\d v^i \over \d \tau}
     = q F^{i\alpha} v_\alpha
     = q \left(-{E^i\over c} v_0 - \epsilon^{ij}{}_k B^k v_j\right)
     = q \left({E^i\over c} v^0 + \epsilon^i{}_{jk} B^k v^j\right)
     = q\gamma \left(E^i + ({\bf v}\times{\bf B})^i\right)"/></p>
</div><p>Using coordinate time <img class="math" src="../../_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/> and coordinates <img class="math" src="../../_images/math/81be9c56d3b198d87b4049cff4e32bb5c187c52d.png" alt="{\bf x}"/> instead of the proper time
<img class="math" src="../../_images/math/1dc1c0119a604b91be9142370dc3159b6a9bbcb9.png" alt="\tau"/> and 4-vector <img class="math" src="../../_images/math/722f3b6277a446e566f96e31afbf7deab71d4a58.png" alt="x^\mu"/>, we need to rewrite the action:</p>
<div class="math">
<p><img src="../../_images/math/005b0cde25524a2e0e82b5743dac3a1fb085f551.png" alt="S = \int L(x^\mu, v^\mu) \d \tau
  = \int {1\over\gamma}L(x^\mu, v^\mu) \d t
  = \int L_{coord}({\bf x}, {\bf v}) \d t"/></p>
</div><p>where <img class="math" src="../../_images/math/66d69ac9c118f7ac4c936726e31f5e8e3a9b769a.png" alt="L_{coord}({\bf x}, {\bf v})"/> is the Lagrangian expressed in coordinates
<img class="math" src="../../_images/math/81be9c56d3b198d87b4049cff4e32bb5c187c52d.png" alt="{\bf x}"/> and <img class="math" src="../../_images/math/54c725b9ffee3760029f9fc19c8783ca23da6f93.png" alt="{\bf v}"/> (and thus is not Lorentz invariant):</p>
<div class="math">
<p><img src="../../_images/math/4b3eeb80c14ff7bf063655daca56e0d5fb94e26f.png" alt="L_{coord}({\bf x}, {\bf v}) = {1\over\gamma}L(x^\mu, v^\mu) =

     = -{m c^2\over\gamma} + {e\over\gamma}v_\alpha A^\alpha =

     = -{m c^2\over\gamma} + {e\over\gamma}(-c\gamma A^0 +\gamma v_i A^i) =

     = -m c^2\sqrt{1-{v^2\over c^2}} - e\phi + e{\bf v}\cdot {\bf A}"/></p>
</div><p>the particle&#8217;s canonical momentum <img class="math" src="../../_images/math/ba345b0e1fc4db99ae1b3f33bfa31ae7c687f67a.png" alt="{\bf P}"/> is:</p>
<div class="math">
<p><img src="../../_images/math/46c03c2674045ed213a63be42f1171cdc41e8c22.png" alt="P_i = {\partial L(t)\over\partial v_i}
    =-mc^2 {1\over 2\sqrt{1-{v^2\over c^2}}}\left(-2v_i\over c^2\right)
         + e A_i
    ={m v_i\over\sqrt{1-{v^2\over c^2}}} + e A_i

{\bf P} = {m{\bf v}\over\sqrt{1-{v^2\over c^2}}} + e{\bf A}
    = \gamma m{\bf v} + e{\bf A}
    = {\bf p} + e{\bf A}"/></p>
</div><p>where <img class="math" src="../../_images/math/e3f4cb9d05fd56f0477a14e5ff9400a30ead5d56.png" alt="{\bf p} = {\bf P}-e{\bf A} = \gamma m{\bf v}"/> is the kinetic momentum.
Euler-Lagrange equations are:</p>
<div class="math">
<p><img src="../../_images/math/3a80a39d99fd335ec6ffc76e7568fb02857ce7fa.png" alt="{\d \over \d t} {\partial L_{coord}\over \partial v_i}
     = {\partial L_{coord} \over \partial x_i}

{\d \over \d t} P_i = {\partial L_{coord} \over \partial x_i}

{\d \over \d t} \left({m v_i\over\sqrt{1-{v^2\over c^2}}} + e A_i\right)
     = {\partial \over \partial x_i}\left(-m c^2\sqrt{1-{v^2\over c^2}}
         - e\phi + e{\bf v}\cdot {\bf A}\right)

{\d \over \d t} \left({m v_i\over\sqrt{1-{v^2\over c^2}}}\right)
     + e {\d A_i\over \d t}
     = -e{\partial \phi\over \partial x_i}
       +e{\bf v}\cdot{\partial {\bf A}\over \partial x_i}

{\d \over \d t} \left({m v_i\over\sqrt{1-{v^2\over c^2}}}\right)
     = e\left(-{\partial \phi\over \partial x_i}
       -{\d A_i\over \d t}
       +v_j{\partial A_j\over \partial x_i}\right)

{\d \over \d t} \left({m v_i\over\sqrt{1-{v^2\over c^2}}}\right)
     = e\left(-{\partial \phi\over \partial x_i}
       -{\partial A_i\over \partial t}-v_j{\partial A_i\over\partial x_j}
       +v_j{\partial A_j\over \partial x_i}\right)

{\d \over \d t} \left({m {\bf v}\over\sqrt{1-{v^2\over c^2}}}\right)
     = e\left({\bf E} + {\bf v}\times {\bf B}\right)"/></p>
</div><p>For continuous case (current), the force due to the magnetic field is:</p>
<div class="math">
<p><img src="../../_images/math/ae3b19695c0c0d5204c5d51dad35664e773c94f2.png" alt="{\bf F} = \int {\bf j}\times {\bf B} \d^3 x
    = I \int \d {\bf l}\times {\bf B}"/></p>
</div></div>
<div class="section" id="hamiltonian">
<h2>Hamiltonian<a class="headerlink" href="#hamiltonian" title="Permalink to this headline">¶</a></h2>
<p>Expressing <img class="math" src="../../_images/math/54c725b9ffee3760029f9fc19c8783ca23da6f93.png" alt="{\bf v}"/> in terms of <img class="math" src="../../_images/math/ba345b0e1fc4db99ae1b3f33bfa31ae7c687f67a.png" alt="{\bf P}"/> we get:</p>
<div class="math">
<p><img src="../../_images/math/c3788f7952c77253287787a1f6ac8218baeef395.png" alt="{\bf P} = {m{\bf v}\over\sqrt{1-{v^2\over c^2}}} + e{\bf A}

{\bf P} - e{\bf A} = {m{\bf v}\over\sqrt{1-{v^2\over c^2}}}

P_i - e A_i = {m v_i\over\sqrt{1-{v^2\over c^2}}}

(P_i - e A_i)^2\left(1-{v^2\over c^2}\right) = m^2 v_i^2

(P_i - e A_i)^2\left(1-{(v_1^2 + v_2^2 + v_3^3)^2\over c^2}\right)
    = m^2 v_i^2

v_i^2 = {(P_i - e A_i)^2 c^2 \over m c^2 + ({\bf P} - e{\bf A})^2}

|v_i| = {|P_i - e A_i| \over \sqrt {m + {1\over c^2 } ({\bf P} - e{\bf A})^2}}

v_i = {P_i - e A_i \over \sqrt {m + {1\over c^2 } ({\bf P} - e{\bf A})^2}}

{\bf v} = {{\bf P} - e{\bf A}\over\sqrt{m^2 +
    {1\over c^2}({\bf P} - e{\bf A})^2}}

{\bf v} = {c({\bf P} - e{\bf A})\over\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}}"/></p>
</div><p>The system of equations was solved for <img class="math" src="../../_images/math/85ffd98b4eaea58a8db38fd0047e3a1d7c5661a0.png" alt="v_i"/> using the code
(in there <img class="math" src="../../_images/math/1cb4cb9467ed9c37a60a089ad5b4897effc45b71.png" alt="v1s = v_1^2"/>, <img class="math" src="../../_images/math/c527f406455e0fdbf41696a30ce4fbe73db866be.png" alt="vs=v^2"/> and <img class="math" src="../../_images/math/c4947eea9c9dbdc8aa2cfdd672d7f42c6babddb0.png" alt="P1 = P_1 - eA_1"/>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">solve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&quot;P1 P2 P3 m c v1s v2s v3s&quot;</span><span class="p">)</span>
<span class="go">(P1, P2, P3, m, c, v1s, v2s, v3s)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vs</span> <span class="o">=</span> <span class="n">v1s</span><span class="o">+</span><span class="n">v2s</span><span class="o">+</span><span class="n">v3s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">([</span><span class="n">P1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">vs</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="n">v1s</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">P2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">vs</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="n">v2s</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">P3</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">vs</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="n">v3s</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">v1s</span><span class="p">,</span> <span class="n">v2s</span><span class="p">,</span> <span class="n">v3s</span><span class="p">])</span>
<span class="go">{v1s: P1**2*c**2/(P1**2 + P2**2 + P3**2 + c**2*m**2),</span>
<span class="go"> v2s: P2**2*c**2/(P1**2 + P2**2 + P3**2 + c**2*m**2),</span>
<span class="go"> v3s: P3**2*c**2/(P1**2 + P2**2 + P3**2 + c**2*m**2)}</span>
</pre></div>
</div>
<p>And the absolute value was removed by using the fact, that <img class="math" src="../../_images/math/85ffd98b4eaea58a8db38fd0047e3a1d7c5661a0.png" alt="v_i"/> has the same
sign as <img class="math" src="../../_images/math/e073f32abf3e0d923efbb1a1989c2d18bbb1d78e.png" alt="p_i = P_i - e A_i"/> which follows from the second equation.</p>
<p>The Hamiltonian is:</p>
<div class="math">
<p><img src="../../_images/math/d5e62e6224f6a2497152b18afe7a6497f4141cb7.png" alt="H({\bf x}, {\bf P}, t) = {\bf v} \cdot {\bf P} - L =

    = {\bf v} \cdot {\bf P}
    +m c^2\sqrt{1-{v^2\over c^2}} + e\phi - e{\bf v}\cdot {\bf A} =

    = {\bf v} \cdot ({\bf P}-e{\bf A})
    +m c^2\sqrt{1-{v^2\over c^2}} + e\phi =

    = {c({\bf P} - e{\bf A})\cdot({\bf P}-e{\bf A})\over\sqrt{m^2c^2 +
    ({\bf P} - e{\bf A})^2}}
    +m c^2\sqrt{1-{1\over c^2}\left({c({\bf P} - e{\bf A})\over\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}}\right)^2} + e\phi =

    = {c({\bf P} - e{\bf A})^2\over\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}}
    +m c^2\sqrt{1-{({\bf P} - e{\bf A})^2\over m^2c^2 + ({\bf P} - e{\bf A})^2}} + e\phi =

    = {c({\bf P} - e{\bf A})^2\over\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}}
    +m c^2\sqrt{m^2 c^2 \over m^2c^2 + ({\bf P} - e{\bf A})^2} + e\phi =

    = {c\left(({\bf P} - e{\bf A})^2+m^2c^2\right)\over
        \sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2}} + e\phi =

    = c\sqrt{m^2c^2 + ({\bf P} - e{\bf A})^2} + e\phi"/></p>
</div></div>
<div class="section" id="electromagnetic-stress-tensor">
<h2>Electromagnetic Stress Tensor<a class="headerlink" href="#electromagnetic-stress-tensor" title="Permalink to this headline">¶</a></h2>
<p>The stress tensor is calculated from the Lagrangian:</p>
<div class="math">
<p><img src="../../_images/math/6f94ada271457bdb1d631a5266c1be68b4ce43ee.png" alt="\L = -{1\over 4\mu_0} F_{\alpha\beta} F^{\alpha\beta}
    =-{1\over 2\mu_0}(\partial_\alpha A_\beta \partial^\alpha A^\beta
        -\partial_\beta A_\alpha \partial^\alpha A^\beta)"/></p>
</div><p>using the Noether formula:</p>
<div class="math">
<p><img src="../../_images/math/52b19b72986fa29ce307db888c944a8e1db6413a.png" alt="T^\mu{}_\nu = {\partial\L\over\partial(\partial_\mu A_\alpha)}
                \partial_\nu A_\alpha
                -\delta^\mu{}_\nu \L =

    = -{1\over\mu_0} F^{\mu\alpha}
        \partial_\nu A_\alpha+{1\over 4\mu_0}\delta^\mu{}_\nu
            F_{\alpha\beta} F^{\alpha\beta}"/></p>
</div><p>We raise the <img class="math" src="../../_images/math/d6a7ccf879c4a4fe694033606332cb83806db296.png" alt="\nu"/> index:</p>
<div class="math">
<p><img src="../../_images/math/de7aeed06757d2eae197061fc6b6f9ddc52ce1ab.png" alt="T^{\mu\nu} = g^{\nu\lambda} T^\mu{}_\lambda
    = -{1\over\mu_0} F^{\mu\alpha}
        \partial^\nu A_\alpha+{1\over 4\mu_0}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta}"/></p>
</div><p>This tensor is not symmetric under the exchange of the <img class="math" src="../../_images/math/e72d03b8f162910252d6170548721746617b5ec5.png" alt="\mu\nu"/> indices. To
make it symmetric, we add a total derivative term
<img class="math" src="../../_images/math/136c5f3e0953e63e8fed9800c68da9d928c095ea.png" alt="\partial_\alpha K^{\alpha\mu\nu}"/>, where <img class="math" src="../../_images/math/4d64d0b76827813584f643e7a3290a74549dbe61.png" alt="K^{\alpha\mu\nu}"/> is antisymmetric
in its first two indices. This guarantees that
<img class="math" src="../../_images/math/4849ed181536a64cbfc1e656d344ae3630fddb4e.png" alt="\partial_\mu \partial_\alpha K^{\alpha\mu\nu}=0"/> so that the new stress energy
tensor is still conserved. We choose
<img class="math" src="../../_images/math/c5a602f10bf901752c3750dfaa4bcce3de4c2d17.png" alt="K^{\alpha\mu\nu}={1\over\mu_0} F^{\mu\alpha} A^\nu"/> and get:</p>
<div class="math">
<p><img src="../../_images/math/98e61b240eca3c43a4ebe22f52b9579fae54a13f.png" alt="T^{\mu\nu} +\partial_\alpha K^{\alpha\mu\nu}
    = -{1\over\mu_0} F^{\mu\alpha}
        \partial^\nu A_\alpha+{1\over 4\mu_0}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta}
            +{1\over\mu_0}\partial_\alpha ( F^{\mu\alpha} A^\nu) =

    = {1\over\mu_0}F^{\mu\alpha}
            (\partial_\alpha A^\nu - \partial^\nu A_\alpha)
        +{1\over 4\mu_0}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta}
            +{1\over\mu_0}(\partial_\alpha F^{\mu\alpha}) A^\nu =

    = {1\over\mu_0}F^{\mu\alpha} F_\alpha{}^\nu
        +{1\over 4\mu_0}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta} =

    = -{1\over\mu_0}\left(F^{\mu\alpha} F^\nu{}_\alpha
        -{1\over 4}g^{\mu\nu}
            F_{\alpha\beta} F^{\alpha\beta}\right)"/></p>
</div><p>where we used <img class="math" src="../../_images/math/dd90ee0495c65c7816fef0c37d3c092b3a18545a.png" alt="\partial_\alpha F^{\mu\alpha} = 0"/>.</p>
<p>Another way to derive the stress energy tensor is from general relativity using
the formula:</p>
<div class="math">
<p><img src="../../_images/math/232c4a467d0cfba2983fb215f2f0a694bc1b803f.png" alt="T_{\mu\nu} = - {2\over\sqrt{ |\det g| }}{\delta S_{EM}\over
        \delta g^{\mu\nu}}"/></p>
</div><p>So we write the action:</p>
<div class="math">
<p><img src="../../_images/math/3ca001719ca7f10078bbb13f79aacf4ed20b5f76.png" alt="S_{EM} = -\int {1\over 4\mu_0} F_{\alpha\beta} F^{\alpha\beta}
    \sqrt{ |\det g| }\d^4 x
    = -\int {1\over 4\mu_0} g^{\alpha\lambda} g^{\beta\rho} F_{\alpha\beta}
        F_{\lambda\rho}
    \sqrt{ |\det g| }\d^4 x"/></p>
</div><p>And vary with respect to <img class="math" src="../../_images/math/1ec358694a495688f1ca6f376bcdf81236b7fb72.png" alt="g^{\mu\nu}"/>:</p>
<div class="math">
<p><img src="../../_images/math/92350dbe8779a0828da80bf285eb84a342fec886.png" alt="\delta S_{EM}
    = -\delta \int {1\over 4\mu_0} g^{\alpha\lambda} g^{\beta\rho}
        F_{\alpha\beta} F_{\lambda\rho} \sqrt{ |\det g| }\d^4 x =

    = -{1\over 4\mu_0} \int  \left(\delta (g^{\alpha\lambda} g^{\beta\rho})
        F_{\alpha\beta} F_{\lambda\rho} \sqrt{ |\det g| }
        + g^{\alpha\mu} g^{\beta\rho}
        F_{\alpha\beta} F_{\lambda\rho} \left(\delta \sqrt{ |\det g| }
        \right)
        \right)\d^4 x =

    = -{1\over 4\mu_0} \int  \left(2(\delta g^{\alpha\lambda}) g^{\beta\rho}
        F_{\alpha\beta} F_{\lambda\rho} \sqrt{ |\det g| }
        + g^{\alpha\lambda} g^{\beta\rho}
        F_{\alpha\beta} F_{\lambda\rho} \left(-\half \sqrt{ |\det g| }
        g_{\mu\nu} (\delta g^{\mu\nu})
        \right)
        \right)\d^4 x =

    = -{1\over 4\mu_0} \int  \left(2(\delta g^{\alpha\lambda})
        F_{\alpha\beta} F_\lambda{}^\beta
        -\half F_{\alpha\beta} F^{\alpha\beta}
        g_{\mu\nu} (\delta g^{\mu\nu})
        \right) \sqrt{ |\det g| } \d^4 x =

    = -{1\over 2\mu_0} \int  \left(
        F_{\mu\beta} F_\nu{}^\beta
        -{1\over 4} F_{\alpha\beta} F^{\alpha\beta}
        g_{\mu\nu}
        \right) (\delta g^{\mu\nu}) \sqrt{ |\det g| } \d^4 x"/></p>
</div><p>And we get:</p>
<div class="math">
<p><img src="../../_images/math/e40606fc6fe2354d566a602d019a80f3693379ed.png" alt="T_{\mu\nu} = {1\over \mu_0} \left(
        F_{\mu\beta} F_\nu{}^\beta
        -{1\over 4} F_{\alpha\beta} F^{\alpha\beta}
        g_{\mu\nu} \right)"/></p>
</div></div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="biot-savart-law">
<h3>Biot-Savart Law<a class="headerlink" href="#biot-savart-law" title="Permalink to this headline">¶</a></h3>
<p>Maxwell&#8217;s equations in Lorenz gauge <a href="#equation-Aeq1">(2)</a>:</p>
<div class="math">
<p><img src="../../_images/math/1aa54d02292c7b3039d9ecba853498959278b8ca.png" alt="\partial_\alpha\partial^\alpha A^\beta = \mu_0 j^\beta"/></p>
</div><p>have the solution for the vector potential <a href="#equation-Avec_sol">(7)</a>:</p>
<div class="math">
<p><img src="../../_images/math/77449261caf951ae20b2657a95991bee4ae317ec.png" alt="{\bf A}({\bf x}, t) = {\mu_0\over 4\pi}\int
     {{\bf j}({\bf y},t-{ |{\bf x} - {\bf y}| \over c})
        \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div><p>Assuming <img class="math" src="../../_images/math/c1b4d07742677af5288112e46f7b0fd68f360c77.png" alt="{ |{\bf x} - {\bf y}| \over c} \ll t"/>:</p>
<div class="math">
<p><img src="../../_images/math/1c5de1d2196d08c76837d31ba4228ce93197b88c.png" alt="{\bf A}({\bf x}, t) = {\mu_0\over 4\pi}\int
     {{\bf j}({\bf y},t) \over |{\bf x} - {\bf y}| }\d^3 y"/></p>
</div><p>The magnetic field is then:</p>
<div class="math">
<p><img src="../../_images/math/5a0744d218e54bf629a30a60f53c9460e56f9b29.png" alt="{\bf B}({\bf x}, t) = \nabla \times {\bf A}({\bf x}, t)
     =\nabla \times {\mu_0\over 4\pi}\int
     {{\bf j}({\bf y},t) \over |{\bf x} - {\bf y}| }\d^3 y =

     ={\mu_0\over 4\pi}\int \left(\nabla {1\over
             |{\bf x} - {\bf y}| }\right)\times {\bf j}({\bf y},t)\d^3 y =

     ={\mu_0\over 4\pi}\int \left(-{{\bf x} - {\bf y}\over
             |{\bf x} - {\bf y}|^3 }\right)\times {\bf j}({\bf y},t)\d^3 y =

     ={\mu_0\over 4\pi}\int {\bf j}({\bf y},t) \times {{\bf x} - {\bf y}
            \over |{\bf x} - {\bf y}|^3 } \d^3 y"/></p>
</div><p>If the current can be approximated by an infinitely-narrow wire, we get:</p>
<div class="math">
<p><img src="../../_images/math/4c3ce449ffcd8cc26652970fe743c4a9e0151896.png" alt="{\bf j}({\bf y},t) \d^3 y = I(t) \d {\bf l}"/></p>
</div><p>and:</p>
<div class="math">
<p><img src="../../_images/math/a5131c73f8179c3b65bb906276066aa4389d841d.png" alt="{\bf B}({\bf x}, t)
     ={\mu_0\over 4\pi}\int I(t)\d{\bf l} \times {{\bf x} - {\bf l}
            \over |{\bf x} - {\bf l}|^3 }"/></p>
</div><div class="section" id="example-straight-wire">
<h4>Example: Straight Wire<a class="headerlink" href="#example-straight-wire" title="Permalink to this headline">¶</a></h4>
<p>Let&#8217;s assume infinite straight wire carrying constant current <img class="math" src="../../_images/math/027f4a11d6090f9eac0ce2488df6384dad1263ea.png" alt="I"/>:</p>
<div class="math">
<p><img src="../../_images/math/fc020051aa8d928686f474f760d478d5f2b8da1c.png" alt="{\bf l} = (0, 0, l)

\d {\bf l} = (0, 0, 1)\d l

{\bf x} = (x, y, z)

{\bf x}-{\bf l} = (x, y, z-l)

{\bf B}({\bf x})
     ={\mu_0 I\over 4\pi}\int \d{\bf l} \times {{\bf x} - {\bf l}
            \over |{\bf x} - {\bf l}|^3 } =

     ={\mu_0 I\over 4\pi} \int_{-\infty}^\infty (0, 0, 1) \times
         {(x, y, z-l) \d l
            \over (x^2 + y^2 + (z-l)^2)^{3\over 2} } =

     =(y, -x, 0) {\mu_0 I \over 4\pi}\int_{-\infty}^\infty {\d l
            \over (x^2 + y^2 + (z-l)^2)^{3\over 2} } =

     =(y, -x, 0) {\mu_0 I \over 4\pi} {2\over x^2+y^2} =

     =(y, -x, 0) {\mu_0 I \over 2\pi} {1\over x^2+y^2}"/></p>
</div><p>Where we used the value of the folowing integral:</p>
<div class="math">
<p><img src="../../_images/math/2700a818e0cb88645a9936b21a0d10e5c6ab4f31.png" alt="\int_{-\infty}^\infty {\d l \over (x^2+y^2 + (z - l)^2)^{3\over 2} }
    = \int_{-\infty}^\infty {\d u \over (x^2+y^2 + u^2)^{3\over 2} } =

    = \left[u\over (x^2+y^2) \sqrt{x^2+y^2 + u^2}\right]_{-\infty}^\infty
    = \left[\sign u\over (x^2+y^2) \sqrt{
        \left(x\over u\right)^2 + \left(y\over u\right)^2 + 1}
        \right]_{-\infty}^\infty =

    = {1\over x^2+y^2} - \left(-{1\over x^2+y^2}\right) = {2\over x^2+y^2}"/></p>
</div><p>For <img class="math" src="../../_images/math/ec89f09c84538ec43930ca5d8e5e0957e2000822.png" alt="y=0"/>:</p>
<div class="math">
<p><img src="../../_images/math/c0bcf5f7c1148cbc5501bbfbedcd557b03413c43.png" alt="{\bf B}(x, 0, z)
     =(0, -x, 0) {\mu_0 I \over 2\pi} {1\over x^2}
     =(0, -1, 0) {\mu_0 I \over 2\pi x}"/></p>
</div></div>
<div class="section" id="example-circular-loop">
<h4>Example: Circular Loop<a class="headerlink" href="#example-circular-loop" title="Permalink to this headline">¶</a></h4>
<p>Let&#8217;s assume a circular loop:</p>
<div class="math">
<p><img src="../../_images/math/f02598e0315168a35ed5952c6843e58cef35f173.png" alt="{\bf l} = (r\cos\phi, r\sin\phi, 0)

{\d {\bf l}\over\d \phi} = (-r\sin\phi, r\cos\phi, 0)

{\bf x} = (x, y, z)

{\bf x}-{\bf l} = (x-r\cos\phi, y-r\sin\phi, z)

{\bf B}({\bf x})
     ={\mu_0 I\over 4\pi}\int \d{\bf l} \times {{\bf x} - {\bf l}
            \over |{\bf x} - {\bf l}|^3 } =

     ={\mu_0 I\over 4\pi} \int_0^{2\pi} (-r\sin\phi, r\cos\phi, 0) \times
         {(x-r\cos\phi, y-r\sin\phi, z) \d \phi
            \over ((x-r\cos\phi)^2 + (y-r\sin\phi)^2 + z^2)^{3\over 2} } =

     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, -z\sin\phi, (x-r\cos\phi)\cos\phi+
                (y-r\sin\phi)\sin\phi)
         r\d \phi
            \over ((x-r\cos\phi)^2 + (y-r\sin\phi)^2 + z^2)^{3\over 2} } =

     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, -z\sin\phi, x\cos\phi+y\sin\phi-r)
         r\d \phi
            \over (x^2+y^2+z^2+r^2-2xr\cos\phi-2yr\sin\phi)^{3\over 2} }"/></p>
</div><p>Due to the symmetry of the problem, we can set <img class="math" src="../../_images/math/ec89f09c84538ec43930ca5d8e5e0957e2000822.png" alt="y=0"/>:</p>
<div class="math">
<p><img src="../../_images/math/c38d152664c6482913a8ea35ef9791d69a4e1064.png" alt="{\bf B}(x, 0, z)
     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, -z\sin\phi, x\cos\phi-r)
         r\d \phi
            \over (x^2+z^2+r^2-2xr\cos\phi)^{3\over 2} } =

     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, 0, x\cos\phi-r)
         r\d \phi
            \over (x^2+z^2+r^2-2xr\cos\phi)^{3\over 2} }"/></p>
</div><p>In the last equation we used the fact, that <img class="math" src="../../_images/math/9983b07bdac1b799f19ac7e5614995be5a9cfa8d.png" alt="\sin\phi"/> is odd and <img class="math" src="../../_images/math/d3b7e3d30264ff7b0e87104a8bf491265598eb77.png" alt="\cos\phi"/> is
even on the interval <img class="math" src="../../_images/math/c1c4986df2f694799538d97c0ecc5371afd3baa7.png" alt="(0, 2\pi)"/>.
For <img class="math" src="../../_images/math/08cc55a3a19c9f8cf005f17391db8ed355d2909c.png" alt="x=y=0"/> we get:</p>
<div class="math">
<p><img src="../../_images/math/f4d91be06bb4917cadac88b0c2024aac1a86ac5b.png" alt="{\bf B}(0, 0, z)
     ={\mu_0 I\over 4\pi} \int_0^{2\pi} {
             (-z\cos\phi, 0, -r)
         r\d \phi
            \over (r^2 + z^2)^{3\over 2} } =

     =(0, 0, -1) {\mu_0 I\over 4\pi} \int_0^{2\pi} {
         r^2\d \phi
            \over (r^2 + z^2)^{3\over 2} } =

     =(0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + z^2)^{3\over 2} }"/></p>
</div></div>
<div class="section" id="helmholtz-coil">
<h4>Helmholtz Coil<a class="headerlink" href="#helmholtz-coil" title="Permalink to this headline">¶</a></h4>
<p>Helmholtz coil is a set of two circular loops of radius <img class="math" src="../../_images/math/b55ca7a0aa88ab7d58f4fc035317fdac39b17861.png" alt="r"/>, that are <img class="math" src="../../_images/math/96ab646de7704969b91c76a214126b45f2b07b25.png" alt="d"/>
apart, where <img class="math" src="../../_images/math/31a85b45c3b481c9c8ffffb15294be0d600c32e2.png" alt="d=r"/>. Let&#8217;s calculate the magnetic field on the axis.
Magnetic field of the first coil is (see the previous example):</p>
<div class="math">
<p><img src="../../_images/math/8477156df3c39114268fc0844aa49fa5b5008e21.png" alt="{\bf B}_1(0, 0, z) = (0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + z^2)^{3\over 2} }"/></p>
</div><p>Second coil is positioned <img class="math" src="../../_images/math/96ab646de7704969b91c76a214126b45f2b07b25.png" alt="d"/> above the first one:</p>
<div class="math">
<p><img src="../../_images/math/c2b43b327bfbc698f97b657fe5260f2bb1892105.png" alt="{\bf B}_2(0, 0, z) = (0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + (z-d)^2)^{3\over 2} }"/></p>
</div><p>The total magnetic field is:</p>
<div class="math">
<p><img src="../../_images/math/c6d92b109c33b6d9ca152b607d38c65f6d4db349.png" alt="{\bf B}(0, 0, z) = {\bf B}_1(0, 0, z) + {\bf B}_2(0, 0, z) =

= (0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + z^2)^{3\over 2} }
+ (0, 0, -1) {\mu_0 I\over 2} {
         r^2 \over (r^2 + (z-d)^2)^{3\over 2} } =

= (0, 0, -1) {\mu_0 I r^2\over 2} \left(
         {1 \over (r^2 + z^2)^{3\over 2} } +
         {1 \over (r^2 + (z-d)^2)^{3\over 2} }\right)"/></p>
</div><p>The field in the middle:</p>
<div class="math">
<p><img src="../../_images/math/5697e411484b927d33e21ac6713905eb5f23fdfb.png" alt="{\bf B}(0, 0, {d\over 2})
= (0, 0, -1) {\mu_0 I r^2\over 2} \left(
         {1 \over (r^2 + \left(d\over 2\right)^2)^{3\over 2} } +
         {1 \over (r^2 + \left(d\over 2\right)^2)^{3\over 2} }\right) =

= (0, 0, -1) {\mu_0 I r^2
         \over (r^2 + \left(d\over 2\right)^2)^{3\over 2} }"/></p>
</div><p>For <img class="math" src="../../_images/math/e227518a3710222c7d2254a00d5e1f3f404228a4.png" alt="r=d"/> we get:</p>
<div class="math">
<p><img src="../../_images/math/b248e32684fea8a07efd9c56a582cbb8dd726c21.png" alt="{\bf B}(0, 0, {d\over 2})
= (0, 0, -1) {\mu_0 I r^2
         \over (r^2 + \left(r\over 2\right)^2)^{3\over 2} } =

= (0, 0, -1) {\mu_0 I
         \over r (1 + \left(1\over 2\right)^2)^{3\over 2} } =

= (0, 0, -1) {\mu_0 I 4^{3\over 2}
         \over r 5^{3\over 2} } =

= (0, 0, -1) {8 \over 5 \sqrt 5} {\mu_0 I \over r} =

= (0, 0, -1) B"/></p>
</div><p>where the magnitude of <img class="math" src="../../_images/math/e9ba51970da63dba1d7d83e26da50e420ca64544.png" alt="{\bf B}"/> is:</p>
<div class="math">
<p><img src="../../_images/math/8729e6a4119c7e2543cd0b78deb0ff6ca0715b08.png" alt="B = {8 \over 5 \sqrt 5} {\mu_0 I \over r}"/></p>
</div><p>For <img class="math" src="../../_images/math/05f5cf3e0f97c510abf68039677b28b822dbb2fe.png" alt="r=0.15\rm\, m"/> and <img class="math" src="../../_images/math/91f876fd93913a676e6e2ced6a8a819b57a122cd.png" alt="N=130"/> turns we get the magnitude of the field as
(we use SI units, so <img class="math" src="../../_images/math/027f4a11d6090f9eac0ce2488df6384dad1263ea.png" alt="I"/> is in <img class="math" src="../../_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"/> and <img class="math" src="../../_images/math/ff5fb3d775862e2123b007eb4373ff6cc1a34d4e.png" alt="B"/> in tesla):</p>
<div class="math">
<p><img src="../../_images/math/ba109f107184e8380b6bbd7c612cdcc330b89150.png" alt="B = {8 \over 5 \sqrt 5} {\mu_0 N I \over r}
  = {8 \over 5 \sqrt 5} {4\pi 10^{-7} \cdot 130 I \over 0.15}
  = 7.79\cdot 10^{-4} I"/></p>
</div><p>Code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;</span><span class="si">%e</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e-7</span><span class="o">*</span><span class="mi">130</span> <span class="o">/</span> <span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mf">0.15</span><span class="p">))</span>
<span class="go">&#39;7.792861e-04&#39;</span>
</pre></div>
</div>
<p>Equation of motion for an electron in this field is:</p>
<div class="math">
<p><img src="../../_images/math/286604dcd09464a8e2075efd20ce6c108dcd4fd2.png" alt="m {\d^2 {\bf x}\over \d t^2} = e\left({\bf v} \times {\bf B}\right)

m {\d^2 {\bf x}\over \d t^2} = eB\, (v_y, -v_x, 0)"/></p>
</div><p>The general solution is:</p>
<div class="math">
<p><img src="../../_images/math/ccf1215465fda9e20c6714652e9bcc090491b909.png" alt="{\bf x} = {v m\over eB} \left(x + \cos {eB\over m} (t-t_0),
            y -\sin {eB\over m} (t-t_0),
            z\right)"/></p>
</div><p>So the electron is moving in a circle with a center <img class="math" src="../../_images/math/31b1e1af4531148cbc079023f68c2b0102c4ee69.png" alt="(x, y, z)"/>,
<img class="math" src="../../_images/math/10fde25257f32317828fde97047bbe76438b6305.png" alt="t_0"/> depends on the initial direction of the velocity and <img class="math" src="../../_images/math/a9f23bf124b6b2b2a993eb313c72e678664ac74a.png" alt="v"/> is the magnitude
of the initial velocity. There can also be a possible movement in the <img class="math" src="../../_images/math/b13f21416d84e13708696f34dea81026cda583c9.png" alt="z"/>
direction, but for the following initial conditions there is none:</p>
<div class="math">
<p><img src="../../_images/math/5434e7a3ca7d0a2da73b666dbec48eec3f8c68e3.png" alt="{\bf x}_0 = (0, 0, 0)

{\bf v}_0 = (0, -v, 0)"/></p>
</div><p>Then we get:</p>
<div class="math">
<p><img src="../../_images/math/1a599a4c2a51ddfc83d0b147064a2a19faef5f38.png" alt="{\bf x} = {v m\over eB} \left(-1+\cos {eB\over m} t,
            -\sin {eB\over m} t,
            0\right)

{\bf v} = v \left(-\sin {eB\over m} t,
            -\cos {eB\over m} t,
            0\right)"/></p>
</div><p>So the radius of the circle is <img class="math" src="../../_images/math/e50962807290e94da8481a2336d270a34384bda9.png" alt="R = {v m\over eB}"/>.
Let the electrons by accelerated by the electric potential <img class="math" src="../../_images/math/12d58aa29201da09d8e620f8698e3a37547f6b4a.png" alt="V"/>:</p>
<div class="math">
<p><img src="../../_images/math/bd0e6e51155207b3195468a2639893c3756f39e0.png" alt="\half m v^2 = e V"/></p>
</div><p>So the initial velocity is:</p>
<div class="math">
<p><img src="../../_images/math/029116d060e7a648f0158ae2f0a9fb0e79601921.png" alt="v = \sqrt{2eV\over m}"/></p>
</div><p>and we get for the radius:</p>
<div class="math">
<p><img src="../../_images/math/26cbba735157a1be138e5229965fb61a308675b8.png" alt="R = {v m\over eB}
    = {m\over eB} \sqrt{2eV\over m}
    = {1\over B} \sqrt{2mV\over e}"/></p>
</div><p>from which the electron charge versus mass ratio is:</p>
<div class="math">
<p><img src="../../_images/math/0e13eea9172f2e3b7b66a0ade507ef35f914ca60.png" alt="{e\over m} = {2V \over R^2 B^2}
    = {2V \over R^2\left({8 \over 5 \sqrt 5} {\mu_0 N I \over r}\right)^2}=

    = {125 V r^2 \over 32 \mu_0^2 R^2 N^2 I^2}"/></p>
</div><p>For <img class="math" src="../../_images/math/05f5cf3e0f97c510abf68039677b28b822dbb2fe.png" alt="r=0.15\rm\, m"/>, <img class="math" src="../../_images/math/91f876fd93913a676e6e2ced6a8a819b57a122cd.png" alt="N=130"/>, <img class="math" src="../../_images/math/790e8992f2877f2f6a1b7a0509920df7afe70e40.png" alt="V=300\rm\,V"/>, <img class="math" src="../../_images/math/5b98a494467c656149e84337d5d9b8e2b9d16243.png" alt="R=0.05\rm\,m"/>, <img class="math" src="../../_images/math/81a0243d14e7ec7da136bb0f024f9a4e4d947626.png" alt="I=1.48\rm\,A"/>
we get:</p>
<div class="math">
<p><img src="../../_images/math/10ec617b4d427edfc7100e972e0587dd917eb87a.png" alt="{e\over m} = 1.80 \cdot 10^{11}\rm\,C\cdot kg^{-1}"/></p>
</div><p>Code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">130</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span> <span class="o">=</span> <span class="mf">1.48</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu0</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e-7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;</span><span class="si">%e</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">125</span> <span class="o">*</span> <span class="n">V</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">32</span> <span class="o">*</span> <span class="n">mu0</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">I</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="go">&#39;1.804238e+11&#39;</span>
</pre></div>
</div>
<p>Reference value is:</p>
<div class="math">
<p><img src="../../_images/math/f9bcc940bce7afe1c972201a2b2f76e77eb6ea78.png" alt="{e\over m} = 1.7588 \cdot 10^{11}\rm\,C\cdot kg^{-1}"/></p>
</div><p>Code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="mf">1.6021766e-19</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="mi">299792458</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eV</span> <span class="o">=</span> <span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">KeV</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">eV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="mf">510.998910</span> <span class="o">*</span> <span class="n">KeV</span> <span class="o">/</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span>
<span class="go">9.109382795192204e-31</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;</span><span class="si">%e</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e</span> <span class="o">/</span> <span class="n">m</span><span class="p">)</span>
<span class="go">&#39;1.758820e+11&#39;</span>
</pre></div>
</div>
<p>or even simpler (we do not actually need the value of the electron charge
<img class="math" src="../../_images/math/a3a59bb1293ee3f6dec19de4019a7178874219ae.png" alt="e"/>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="mi">299792458</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">KeV</span> <span class="o">=</span> <span class="mf">1e3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="mf">510.998910</span> <span class="o">*</span> <span class="n">KeV</span> <span class="o">/</span> <span class="n">c</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;</span><span class="si">%e</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>
<span class="go">&#39;1.758820e+11&#39;</span>
</pre></div>
</div>
<p>We can use the experimental value to calculate the electron rest mass energy:</p>
<div class="math">
<p><img src="../../_images/math/1ab60cc351c083f92a4cb92fbb42e434d720bec4.png" alt="m c^2 = {c^2 \over 1.804238\cdot 10^{11}}{\rm\, eV}
    = 498.1356 {\rm\, KeV}"/></p>
</div></div>
</div>
<div class="section" id="ampere-s-force-law">
<h3>Ampère&#8217;s Force Law<a class="headerlink" href="#ampere-s-force-law" title="Permalink to this headline">¶</a></h3>
<p>The force on a wire 1 due to a magnetic field of a wire 2 is:</p>
<div class="math">
<p><img src="../../_images/math/6267cc4a0b42157facaba226282b09ac3bb52f9e.png" alt="{\bf F} = I_1 \int \d {\bf l}_1 \times {\bf B}({\bf l}_1)

{\bf B}({\bf x})
     ={\mu_0\over 4\pi}\int I_2(t)\d{\bf l}_2 \times {{\bf x} - {\bf l}_2
            \over |{\bf x} - {\bf l}_2|^3 }"/></p>
</div><p>Where <img class="math" src="../../_images/math/e45504db553bb0e765c649b1504273090663f1f8.png" alt="{\bf B}({\bf x})"/> is the magnetic field produced by the wire 2.
Combining these two equations we get:</p>
<div class="math">
<p><img src="../../_images/math/20f28ed9725c5d93b1f29d67b2db7ccf5d7f226b.png" alt="{\bf F} = I_1 \int \d {\bf l}_1 \times {\bf B}({\bf l}_1) =

    = I_1 \int \d {\bf l}_1 \times \left(
     {\mu_0\over 4\pi}\int I_2(t)\d{\bf l}_2 \times {{\bf l}_1 - {\bf l}_2
            \over |{\bf l}_1 - {\bf l}_2|^3 }\right) =

    = {\mu_o I_1 I_2\over 4\pi} \int \int {\d {\bf l}_1 \times (
     \d{\bf l}_2 \times ({\bf l}_1 - {\bf l}_2))
            \over |{\bf l}_1 - {\bf l}_2|^3 } =

    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        \d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
        ({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
            \over |{\bf l}_1 - {\bf l}_2|^3 }"/></p>
</div><div class="section" id="parallel-straight-wires">
<h4>Parallel Straight Wires<a class="headerlink" href="#parallel-straight-wires" title="Permalink to this headline">¶</a></h4>
<p>We calculate the force between two parallel straight infinite wires:</p>
<div class="math">
<p><img src="../../_images/math/2075daf7aa670fa31f8b57fb60f91cdb08cfc15c.png" alt="{\bf l}_1 = ({d\over 2}, 0, l_1)

\d{\bf l}_1 = (0, 0, \d l_1)

{\bf l}_2 = (-{d\over 2}, 0, l_2)

\d{\bf l}_2 = (0, 0, \d l_2)

{\bf l}_1 - {\bf l}_2 = (d, 0, l_1-l_2)

\d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
    = (0, 0, \d l_2) (l_1-l_2)\d l_1 - (d, 0, l_1-l_2)\d l_2 \d l_1
    = (-d, 0, 0)\d l_1 \d l_2

{\bf F}
    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        \d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
        ({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
            \over |{\bf l}_1 - {\bf l}_2|^3 } =

    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        (-d, 0, 0)\d l_1 \d l_2
            \over (d^2 + (l_1 - l_2)^2)^{3\over 2} } =

    = (-1, 0, 0){\mu_o I_1 I_2\over 4\pi} \int \d l_1
        \int_{-\infty}^\infty \d l_2 {
        d
            \over (d^2 + (l_1 - l_2)^2)^{3\over 2} } =

    = (-1, 0, 0){\mu_o I_1 I_2\over 4\pi} \int \d l_1
        {2\over d} =

    = (-1, 0, 0){\mu_o I_1 I_2\over 2\pi d} \int \d l_1"/></p>
</div><p>Where we used the value of the folowing integral:</p>
<div class="math">
<p><img src="../../_images/math/0ac5fb6791eab43ede18a5933fd4a552b24d2575.png" alt="\int_{-\infty}^\infty \d l_2 {d \over (d^2 + (l_1 - l_2)^2)^{3\over 2} }
    = \int_{-\infty}^\infty \d x {d \over (d^2 + x^2)^{3\over 2} } =

    = \left[x\over d \sqrt{d^2 + x^2}\right]_{-\infty}^\infty
    = \left[\sign x\over d \sqrt{\left(d\over x\right)^2 + 1}
        \right]_{-\infty}^\infty =

    = {1\over d} - \left(-{1\over d}\right) = {2\over d}"/></p>
</div><p>As such, the direction of the force on the first wire (at coordinates <img class="math" src="../../_images/math/64c633a590c15fda994c7cd9df7284edd4b35dbb.png" alt="({d\over
2}, 0, 0)"/> going in the <img class="math" src="../../_images/math/b13f21416d84e13708696f34dea81026cda583c9.png" alt="z"/> direction) will be to the left and the force per
unit length is:</p>
<div class="math">
<p><img src="../../_images/math/528c639d9d2ee832e67f6b28cbf274c60d4281fc.png" alt="F_m = {\mu_o I_1 I_2\over 2\pi d}"/></p>
</div><p>Because the second wire is at the coordinates <img class="math" src="../../_images/math/8f8816f6477c8a6917cbcaa90776772c5fbcea61.png" alt="(-{d\over
2}, 0, 0)"/> and the force on the first wire is in the direction
<img class="math" src="../../_images/math/d84c50601c566ada09aeda64a39e1f447adf602a.png" alt="(-1, 0, 0)"/>, the force between the wires is attractive, as long as <img class="math" src="../../_images/math/b267db327cda83047220f49cbb647f9cc165f1c0.png" alt="I_1"/> and
<img class="math" src="../../_images/math/41192b5d91024dbdddbdbe3cb08b0ca3b2a98159.png" alt="I_2"/> have the same sign (either both currents go up, or both down)
and repulsive if <img class="math" src="../../_images/math/b267db327cda83047220f49cbb647f9cc165f1c0.png" alt="I_1"/> and <img class="math" src="../../_images/math/41192b5d91024dbdddbdbe3cb08b0ca3b2a98159.png" alt="I_2"/> have opposite signs.</p>
<p>Let <img class="math" src="../../_images/math/ad0f9c7b88ab0772f18e355484ef6aa04c97170c.png" alt="d=1\rm\,m"/>, <img class="math" src="../../_images/math/3d92a7ad3190b2c0f561e4f3849e3755ddd22b49.png" alt="I_1 = I_2 = 1\rm\, A"/>, then the force is attractive and
(we also use <img class="math" src="../../_images/math/65e2f44d07fc18c2f65a38fa4821e35b03e41c51.png" alt="\mu_0 = 4\pi \cdot 10^{-7}"/>):</p>
<div class="math">
<p><img src="../../_images/math/9951e7ae7e0fa078b42768f92135b24d6ac2a674.png" alt="F_m = {4\pi \cdot 10^{-7} \over 2\pi} {\rm\, N \cdot m^{-1}}
    = 2 \cdot 10^{-7} {\rm\, N \cdot m^{-1}}"/></p>
</div></div>
<div class="section" id="perpendicular-straight-wires">
<h4>Perpendicular Straight Wires<a class="headerlink" href="#perpendicular-straight-wires" title="Permalink to this headline">¶</a></h4>
<p>We calculate the force between two perpendicular straight infinite wires:</p>
<div class="math">
<p><img src="../../_images/math/942cec12055492145a45fb7162d9e4283db1d1a5.png" alt="{\bf l}_1 = ({d\over 2}, 0, l_1)

\d{\bf l}_1 = (0, 0, \d l_1)

{\bf l}_2 = (-{d\over 2}, l_2, 0)

\d{\bf l}_2 = (0, \d l_2, 0)

{\bf l}_1 - {\bf l}_2 = (d, -l_2, l_1)

\d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
    = (0, \d l_2, 0) l_1\d l_1
    = (0, l_1, 0)\d l_1 \d l_2

{\bf F}
    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        \d {\bf l}_2 (\d {\bf l}_1 \cdot ({\bf l}_1 - {\bf l}_2)) -
        ({\bf l}_1 - {\bf l}_2) (\d {\bf l}_2 \cdot\d {\bf l}_1)
            \over |{\bf l}_1 - {\bf l}_2|^3 } =

    = {\mu_o I_1 I_2\over 4\pi} \int \int {
        (0, l_1, 0)\d l_1 \d l_2
            \over (d^2 + l_1^2 + l_2^2)^{3\over 2} } =

    = (0, 1, 0){\mu_o I_1 I_2\over 4\pi} \int_{-\infty}^\infty \d l_1
        \int_{-\infty}^\infty \d l_2 {
        l_1
            \over (d^2 + l_1^2 +l_2^2)^{3\over 2} } =

    = (-1, 0, 0){\mu_o I_1 I_2\over 4\pi} \int_{-\infty}^\infty \d l_1
        {2 l_1\over d^2 + l_1^2}
        =

    = 0"/></p>
</div><p>The integral is an odd functin of <img class="math" src="../../_images/math/6ee61fd6e8a1926a802b97fc99b66b8687d8f620.png" alt="l_1"/>, so it is zero.  We used the value of
the folowing integral (but in fact it is already seen before this integral is
needed that the double integral must be zero):</p>
<div class="math">
<p><img src="../../_images/math/f52fc0089fc40e5c7609eb76a41f487957edd576.png" alt="\int_{-\infty}^\infty \d l_2 {l_1 \over (d^2 + l_1^2 + l_2^2)^{3\over 2} }

    = \left[l_1 l_2\over (d^2+l_1^2) \sqrt{d^2 +l_1^2 + l_2^2}
        \right]_{-\infty}^\infty
    = \left[l_1 \sign l_2\over (d^2+l_1^2)
        \sqrt{\left(d\over l_2\right)^2 + \left(l_1\over l_2\right)^2 + 1}
        \right]_{-\infty}^\infty =

    = {l_1\over d^2+l_1^2} - \left(-{l_1\over d^2 + l_1^2}\right)
    = {2 l_1\over d^2 + l_1^2}"/></p>
</div><p>As such, there will be no net force.</p>
</div>
<div class="section" id="infinitely-long-wire-and-a-square-loop">
<h4>Infinitely Long Wire and a Square Loop<a class="headerlink" href="#infinitely-long-wire-and-a-square-loop" title="Permalink to this headline">¶</a></h4>
<p>We calculate the net force on a square loop with current <img class="math" src="../../_images/math/b267db327cda83047220f49cbb647f9cc165f1c0.png" alt="I_1"/> of side <img class="math" src="../../_images/math/c7d457e388298246adb06c587bccd419ea67f7e8.png" alt="a"/>,
whose center is <img class="math" src="../../_images/math/96ab646de7704969b91c76a214126b45f2b07b25.png" alt="d"/> far from an infinitely long wire with current <img class="math" src="../../_images/math/41192b5d91024dbdddbdbe3cb08b0ca3b2a98159.png" alt="I_2"/>:</p>
<p>The wire has coordinates <img class="math" src="../../_images/math/e0dbcd6538b10044a8f58aef2802576f7b0e852e.png" alt="(0, 0, z)"/> and the magnetic field from it is (see the
example above):</p>
<div class="math">
<p><img src="../../_images/math/007e6d3dbeb6056e0b0274f144916d464e3b23a1.png" alt="{\bf B}(x, 0, z) = (0, -1, 0) {\mu_0 I \over 2\pi x}"/></p>
</div><p>The four sides of the loop are (<img class="math" src="../../_images/math/6bd69eb6d757cef5972f6c99113a5946a21aa58c.png" alt="0 \le l_1 \le a"/>):</p>
<div class="math">
<p><img src="../../_images/math/9c33a8b3d5ff4a1751432ac5f72e43f57a38bc91.png" alt="{\bf l}_1 = (d-{a\over 2}+l_1, 0, {a\over2})

{\bf l}_1 = (d+{a\over 2}, 0, {a\over2}-l_1)

{\bf l}_1 = (d+{a\over 2}-l_1, 0, -{a\over2})

{\bf l}_1 = (d-{a\over 2}, 0, -{a\over2}+l_1)"/></p>
</div><p>and the differentials are:</p>
<div class="math">
<p><img src="../../_images/math/b70ed1fb1ffcf377eaaec8310a082f11313c1fc0.png" alt="\d {\bf l}_1 = (1, 0, 0) \d l_1

\d {\bf l}_1 = (0, 0, -1) \d l_1

\d {\bf l}_1 = (-1, 0, 0) \d l_1

\d {\bf l}_1 = (0, 0, 1) \d l_1"/></p>
</div><p>The net force on the loop is:</p>
<div class="math">
<p><img src="../../_images/math/43dc2f7277403febd2a0e0a896f1b23511ec814d.png" alt="{\bf F} = I_1 \int \d {\bf l}_1 \times {\bf B}
    = I_1 \int \d {\bf l}_1 \times (0, -1, 0) {\mu_0 I_2 \over 2\pi
        ({\bf l}_1)_x} =

    = {\mu_0 I_1 I_2\over 2\pi}\left(
        \int_0^a {(0, 0, 1)\d l_1\over d-{a\over 2} + l_1}
        +\int_0^a {(1, 0, 0)\d l_1\over d+{a\over 2}}
        +\int_0^a {(0, 0, -1)\d l_1\over d+{a\over 2}-l_1}
        +\int_0^a {(-1, 0, 0)\d l_1\over d-{a\over 2}}
        \right) =

    = {\mu_0 I_1 I_2\over 2\pi}\left(
        (0, 0, 1)\left[\log \left| d-{a\over 2} + l_1 \right|
            -\log \left|d + {a\over 2} - l_1\right| \right]_0^a
        +(1, 0, 0)\left({a\over d + {a\over 2}}-{a\over d - {a\over 2}}
            \right)\right) =

    = {\mu_0 I_1 I_2\over 2\pi}\left(
        (0, 0, 1) \cdot 0 +
        (1, 0, 0){a^2\over d^2 - \left({a\over 2}\right)^2}
            \right) =

    = (1, 0, 0){\mu_0 I_1 I_2\over 2\pi}
        {a^2\over d^2 - \left({a\over 2}\right)^2}"/></p>
</div></div>
</div>
<div class="section" id="magnetic-dipole">
<h3>Magnetic Dipole<a class="headerlink" href="#magnetic-dipole" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="../../_images/math/c9095a1bf3f765abb4491d58f47b180920c6b3f6.png" alt="{\bf A}({\bf r}) = {\mu_0\over 4\pi} {{\bf m}\times{\bf r}\over r^3}

{\bf B}({\bf r}) = \nabla\times {\bf A}
= {\mu_0\over 4\pi} \nabla\times
    \left({{\bf m}\times{\bf r}\over r^3}\right) =

= {\mu_0\over 4\pi} \left({\bf m}\nabla\cdot\left({\bf r}\over r^3\right)
    -{\bf m}\cdot\nabla\left({\bf r}\over r^3\right)
    \right) =

= {\mu_0\over 4\pi} \left({\bf m}\left(\left(\nabla{1\over r^3}\right)
        \cdot{\bf r}+{1\over r^3}\nabla\cdot{\bf r}\right)
    -{\bf m}\cdot\left(\left(\nabla{1\over r^3}\right)
        {\bf r}+{1\over r^3}\nabla{\bf r}\right)\right)
    =

= {\mu_0\over 4\pi} \left({\bf m}\left(\left(-{3{\bf r}\over r^5}\right)
        \cdot{\bf r}+{1\over r^3}3\right)
    -{\bf m}\cdot\left(\left(-{3{\bf r}\over r^5}\right)
        {\bf r}+{1\over r^3}\one\right)\right)
    =

= {\mu_0\over 4\pi} \left({\bf m}\left(-{3\over r^3}+{3\over r^3}\right)
    +{\bf m}\cdot\left({3{\bf r}{\bf r}\over r^5}-{\one\over r^3}\right)
    \right)
    =

= {\mu_0\over 4\pi} \left({3{\bf r}({\bf m}\cdot{\bf r})\over r^5}
    -{{\bf m}\over r^3}\right)"/></p>
</div></div>
<div class="section" id="bar-magnet">
<h3>Bar Magnet<a class="headerlink" href="#bar-magnet" title="Permalink to this headline">¶</a></h3>
<p>A good model of a bar magnet of the length <img class="math" src="../../_images/math/859ccf4cd60c7bc6b8fa1afc9a42dc811a826d6f.png" alt="L"/> and width <img class="math" src="../../_images/math/10cb764f88509fb1c8012366993fdbee98f31bc5.png" alt="W"/> is a combination
of two magnetic monopoles (that sit inside the magnet, so one cannot actually
see them, just their behavior outside the magnet):</p>
<div class="math">
<p><img src="../../_images/math/d729a9ffb8306b32d8e5fd2f8ab51311d6f63c5f.png" alt="{\bf B}({\bf x}) = {\mu_0 Q_m\over 4\pi} \left(
    {{\bf x}-{\bf p}_1 \over |{\bf x}-{\bf p}_1|^3}
    -
    {{\bf x}-{\bf p}_2 \over |{\bf x}-{\bf p}_2|^3}
    \right)"/></p>
</div><p>where:</p>
<div class="math">
<p><img src="../../_images/math/ff6827ca280d9bf35a9f5d390c55276a67277136.png" alt="{\bf p}_1 = (0, 0, d)

{\bf p}_2 = (0, 0, -d)

d = {L-W\over 2}"/></p>
</div><p>The magnetic moment vector is:</p>
<div class="math">
<p><img src="../../_images/math/cb79146cc971e4573aee8ac9a70d1c5cc350225f.png" alt="{\bf m} = Q_m ({\bf p}_1 - {\bf p}_2)"/></p>
</div><p>and its magnitude then is:</p>
<div class="math">
<p><img src="../../_images/math/25144ef1f9015d38ca42775dae0563c9ff1a219a.png" alt="m = 2 Q_m d"/></p>
</div><p>The permeability is:</p>
<div class="math">
<p><img src="../../_images/math/e86c6fe852d591d4cfa126b5ba244d61b001a2f1.png" alt="\mu_0 = 4\pi \cdot 10^{-7}{\rm\,H\cdot m^{-1}}
    = 4\pi \cdot 10^{-7}{\rm\,V\cdot s\cdot A^{-1}\cdot m^{-1}}"/></p>
</div><p>For a typical bar magnet, we have for example:</p>
<div class="math">
<p><img src="../../_images/math/c0bcdde5acc3cd4736a98139ac098eaf66d2a058.png" alt="L &amp;= 5{\rm\,cm} \\
W &amp;= 1{\rm\,cm} \\
Q_m &amp;= 3.3{\rm\,A\cdot m} \\
d &amp;= {L-W\over2} = 0.02{\rm\,m} \\
m &amp;= 2 Q_m d = 2\times 3.3\times 0.02{\rm\,A\cdot m^2}
    = 0.132 {\rm\,A\cdot m^2}"/></p>
</div><p>The unit of <img class="math" src="../../_images/math/e9ba51970da63dba1d7d83e26da50e420ca64544.png" alt="{\bf B}"/> is Tesla: <img class="math" src="../../_images/math/54b9208c93aaad38baa74a16ec6dd7532ee269ab.png" alt="\rm 1 T = V\cdot s \cdot m^{-2}"/>.</p>
</div>
<div class="section" id="bar-magnet-in-a-coil">
<h3>Bar Magnet in a Coil<a class="headerlink" href="#bar-magnet-in-a-coil" title="Permalink to this headline">¶</a></h3>
<p>We throw a magnet through a coil and calculate the voltage on the coil.
We use two model of the bar magnet: a magnetic dipole and two monopoles <img class="math" src="../../_images/math/808d70ce29110acbfa47228747db2e682cf103ef.png" alt="2d"/>
apart.</p>
<p>Geometry:</p>
<div class="math">
<p><img src="../../_images/math/a9ca9b2e1b52bde991cdf90282237ee2e98b6cf6.png" alt="{\bf v} = (0, 0, v)

{\bf l} = (a\cos\phi, a\sin\phi, z)

{\d{\bf l}\over \d\phi} = (-a\sin\phi, a\cos\phi, 0)"/></p>
</div><p>Field of the dipole:</p>
<div class="math">
<p><img src="../../_images/math/db4516e4a061fa66605bbb481b53967a17295e88.png" alt="{\bf E} = 0

{\bf B}({\bf r}) = {\mu_0\over 4\pi} \left({3{\bf r}({\bf m}\cdot{\bf r})\over r^5}
    -{{\bf m}\over r^3}\right)

{\bf m} = (0, 0, m)"/></p>
</div><p>we will need:</p>
<div class="math">
<p><img src="../../_images/math/6b2cb61ae6f7401e6d785244517d9f0152a6be20.png" alt="{\bf v}\times{\bf B}({\bf l})
= {\mu_0\over 4\pi}{\bf v}\times
    \left({3{\bf l}({\bf m}\cdot{\bf l})\over l^5}
-{{\bf m}\over l^3}\right) =

= {\mu_0\over 4\pi}
    \left({3({\bf v}\times{\bf l})({\bf m}\cdot{\bf l})\over l^5}
-{{\bf v}\times{\bf m}\over l^3}\right) =

= {\mu_0\over 4\pi}
    {3({\bf v}\times{\bf l})({\bf m}\cdot{\bf l})\over l^5}
    =

= {\mu_0\over 4\pi}
    {3(va\sin\theta, -va\cos\theta, 0)mz\over (a^2 + z^2)^{5\over2}} =

= {3\mu_0 m\over 4\pi}
    {a v z\over (a^2 + z^2)^{5\over2}} (\sin\theta, -\cos\theta, 0)"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../../_images/math/f977f4e20b2d7a13d9c8d6d23a44a34ee5dad57a.png" alt="{\bf v}\times{\bf B}\cdot{\d{\bf l}\over \d\phi} =

= {3\mu_0 m\over 4\pi}
    {a v z\over (a^2 + z^2)^{5\over2}} (\sin\theta, -\cos\theta, 0)
    \cdot
(-a\sin\phi, a\cos\phi, 0) =

= -{3\mu_0 m\over 4\pi}
    {a^2 v z\over (a^2 + z^2)^{5\over2}}"/></p>
</div><p>Field of two monopoles:</p>
<div class="math">
<p><img src="../../_images/math/dc889928b33d69dc1bd577c08b4cd17a0ef7f458.png" alt="{\bf E} = 0

{\bf B}({\bf x}) = {\mu_0 Q_m\over 4\pi} \left(
    {{\bf x}-{\bf p}_1 \over |{\bf x}-{\bf p}_1|^3}
    -
    {{\bf x}-{\bf p}_2 \over |{\bf x}-{\bf p}_2|^3}
    \right)

{\bf p}_1 = (0, 0, d)

{\bf p}_2 = (0, 0, -d)

d = {L-W\over 2}"/></p>
</div><p>we will need:</p>
<div class="math">
<p><img src="../../_images/math/b91a5d9532e94db2274d960090a59ccb6a522cd3.png" alt="{\bf v}\times{\bf B}({\bf l})
    = {\mu_0 Q_m\over 4\pi} \left(
    {{\bf v}\times({\bf l}-{\bf p}_1) \over |{\bf l}-{\bf p}_1|^3}
    -
    {{\bf v}\times({\bf l}-{\bf p}_2) \over |{\bf l}-{\bf p}_2|^3}
    \right) =

    = {\mu_0 Q_m\over 4\pi} \left(
    {(0, 0, v)\times(a\cos\phi, a\sin\phi, z-d) \over
        (a^2+(z-d)^2)^{3\over2}}
    -
    {(0, 0, v)\times(a\cos\phi, a\sin\phi, z+d) \over
        (a^2+(z+d)^2)^{3\over2}}
    \right) =

    = {\mu_0 Q_m a v \over 4\pi} \left(
    {1 \over (a^2+(z-d)^2)^{3\over2}}
    -
    {1 \over (a^2+(z+d)^2)^{3\over2}}
    \right) (\sin\phi, -\cos\phi, 0)"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../../_images/math/9e6ed259e13d55bffd005c585b3d8a9c9f80974d.png" alt="{\bf v}\times{\bf B}\cdot{\d{\bf l}\over \d\phi} =

= {\mu_0 Q_m a v \over 4\pi} \left(
{1 \over (a^2+(z-d)^2)^{3\over2}}
-
{1 \over (a^2+(z+d)^2)^{3\over2}}
\right) (\sin\phi, -\cos\phi, 0)
    \cdot
(-a\sin\phi, a\cos\phi, 0) =

= -{\mu_0 Q_m a^2 v \over 4\pi} \left(
{1 \over (a^2+(z-d)^2)^{3\over2}}
-
{1 \over (a^2+(z+d)^2)^{3\over2}}
\right)"/></p>
</div><p>Now we can calculate the voltage:</p>
<div class="math">
<p><img src="../../_images/math/8318a1082cbc970e017a0ef86df6789fe43363f2.png" alt="V = \oint \left({\bf E} + {\bf v}\times{\bf B}\right) \cdot {\d{\bf l}} =

    = \oint {\bf v}\times{\bf B} \cdot {\d{\bf l}} =

    = \int_0^{2\pi} {\bf v}\times{\bf B} \cdot {\d{\bf l}\over \d\phi}
        \d\phi"/></p>
</div><p>for the dipole we get</p>
<div class="math">
<p><img src="../../_images/math/7b3ec9c62d26256177bbf05be2bf624401e8e301.png" alt="V = \cdots
= -\int_0^{2\pi} {3\mu_0 m\over 4\pi}
{a^2 v z\over (a^2 + z^2)^{5\over2}}
    \d\phi =

= -{3\mu_0 m\over 2}
{a^2 v z\over (a^2 + z^2)^{5\over2}}"/></p>
</div><p>For two monopoles we get</p>
<div class="math">
<p><img src="../../_images/math/4fed6d55977d58c26ac90b1e2301b3381559716f.png" alt="V = \cdots
= -\int_0^{2\pi} {\mu_0 Q_m a^2 v \over 4\pi} \left(
    {1 \over (a^2+(z-d)^2)^{3\over2}}
    -
    {1 \over (a^2+(z+d)^2)^{3\over2}}
    \right)
    \d\phi =

= -{\mu_0 Q_m a^2 v \over 2} \left(
    {1 \over (a^2+(z-d)^2)^{3\over2}}
    -
    {1 \over (a^2+(z+d)^2)^{3\over2}}
    \right)"/></p>
</div><p>For the dipole, the function</p>
<div class="math">
<p><img src="../../_images/math/c08ce334e41b3e546dfd5eddce823a0dbec18e6d.png" alt="{z\over(a^2+z^2)^{5\over 2}}"/></p>
</div><p>has a maximum and minimum for:</p>
<div class="math">
<p><img src="../../_images/math/5a3c164d53ee2c3b67e80e8c5051dfc1ccc277bf.png" alt="z = \pm{a\over 2}"/></p>
</div><p>with the max value:</p>
<div class="math">
<p><img src="../../_images/math/7df0bfb7aa4cb98877fcb2275121c19994b3ff5d.png" alt="{z\over(a^2+z^2)^{5\over 2}} =
{{a\over 2}\over(a^2+\left({a\over 2}\right)^2)^{5\over 2}} =
{16\sqrt 5 \over 125 a^4}"/></p>
</div><p>Code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">var</span><span class="p">,</span> <span class="n">solve</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">refine</span><span class="p">,</span> <span class="n">Q</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&quot;a z&quot;</span><span class="p">)</span>
<span class="go">(a, z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">z</span><span class="p">)</span>
<span class="go">[-a/2, a/2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">16*sqrt(5)*a/(125*(a**2)**(5/2))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refine</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">Q</span><span class="o">.</span><span class="n">positive</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">16*sqrt(5)/(125*a**4)</span>
</pre></div>
</div>
<p>So the maximum voltage is:</p>
<div class="math">
<p><img src="../../_images/math/c8cc0cf1bec52c9b89cc47e6766113e70e8c9fc8.png" alt="V = {\mu_0\over 2} {3va^2mz\over (a^2 + z^2)^{5\over2}}
    = {\mu_0\over 2} {3mva^2 {16\sqrt 5 \over 125 a^4}} =

    = {24\sqrt 5\over125} {\mu_0 m v\over a^2}"/></p>
</div><p>If we drop the magnet from height <img class="math" src="../../_images/math/8189a5b5a0917b8c93350827be4038af1839139d.png" alt="h"/> above the coil into it, then its speed
will be <img class="math" src="../../_images/math/b94162e695dfc52fb3194749673e9a2223c13d62.png" alt="v_0 = \sqrt{2hg}"/> in the middle of the coil, when <img class="math" src="../../_images/math/5a607fd61885c014512c949fee18869690330407.png" alt="t=0"/>. Then:</p>
<div class="math">
<p><img src="../../_images/math/0e0d4c9be4db8e3394504bbe026a4baa5f564138.png" alt="z = v_0 t + \half g t^2

v = v_0 + g t"/></p>
</div><p>And we get for the voltage dependence for dipole:</p>
<div class="math">
<p><img src="../../_images/math/1738e40304d6ac56e7112d13856ca185c81f2210.png" alt="V = - {\mu_0\over 2} {3va^2mz\over (a^2 + z^2)^{5\over2}}
    =- {\mu_0\over 2} {3(v_0+gt)a^2m(v_0 t + \half g t^2)\over
         (a^2 + (v_0 t + \half g t^2)^2)^{5\over2}}"/></p>
</div><p>The time difference between the maximum and minimum is the time difference
between <img class="math" src="../../_images/math/eb8cc2ad231c712f0e7c45f5c809904ba05b79c8.png" alt="z=-{a\over2}"/> and <img class="math" src="../../_images/math/bfc0474bb9eb4d4600bc2611b1a69a98e190eef4.png" alt="z=+{a\over2}"/>, so:</p>
<div class="math">
<p><img src="../../_images/math/dae4359844614b88d9619b94c5f3bf7e62abcb92.png" alt="\Delta t = \sqrt{2h+a\over g} - \sqrt{2h-a\over g}"/></p>
</div><p>The total flux doesn&#8217;t depend on the particular dependence of <img class="math" src="../../_images/math/b00fc10753d7366a6919ed110df236f9a0b54f64.png" alt="z(t)"/> and
<img class="math" src="../../_images/math/0dfca47fad8dae84de1c4d7532d3bf9269f096ae.png" alt="v(t)"/>:</p>
<div class="math">
<p><img src="../../_images/math/fb17ad83f8b94e8db60fc931b69439595ccefd7a.png" alt="\Phi = \int_0^\infty V(t) \d t =

    = - {3\mu_0 m\over 2} \int_0^\infty{v(t)a^2z(t)
            \over (a^2 + z(t)^2)^{5\over2}} \d t =

    = - {3\mu_0 m\over 2} \int_0^\infty{{\d z\over\d t}a^2z(t)
            \over (a^2 + z(t)^2)^{5\over2}} \d t =

    = - {3\mu_0 m\over 2} \int_0^\infty{a^2z
            \over (a^2 + z^2)^{5\over2}} \d z =

    = - {3\mu_0 m\over 4} \int_{a^2}^\infty{a^2
            \over u^{5\over2}} \d u =

    = - {3\mu_0 m a^2\over 4} \left(-{2\over 3}\right)
        \left[1\over u^{3\over2}\right]_{a^2}^\infty =

    = - {3\mu_0 m a^2\over 4} \left(-{2\over 3}\right)
        \left[-1\over a^3\right] =

    = - {\mu_0 m \over 2a}"/></p>
</div><p>For the voltage dependence of two monopoles, we get:</p>
<div class="math">
<p><img src="../../_images/math/0aad8005cb736be30152a5434489bf20ebc91711.png" alt="V = -{\mu_0 Q_m a^2 v \over 2} \left(
        {1 \over (a^2+(z-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(z+d)^2)^{3\over2}}
        \right) =

= -{\mu_0 Q_m a^2 (v_0+gt) \over 2} \left(
        {1 \over (a^2+(v_0 t + \half g t^2-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(v_0 t + \half g t^2+d)^2)^{3\over2}}
        \right)"/></p>
</div><p>The total flux doesn&#8217;t depend on the particular dependence of <img class="math" src="../../_images/math/b00fc10753d7366a6919ed110df236f9a0b54f64.png" alt="z(t)"/> and
<img class="math" src="../../_images/math/0dfca47fad8dae84de1c4d7532d3bf9269f096ae.png" alt="v(t)"/>:</p>
<div class="math">
<p><img src="../../_images/math/6c76d4c9aacb643d92aaa6bc247761a2965b792d.png" alt="\Phi = \int_0^\infty V(t) \d t =

    =-\int_0^\infty {\mu_0 Q_m a^2 v(t) \over 2} \left(
        {1 \over (a^2+(z(t)-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(z(t)+d)^2)^{3\over2}}
        \right)
        \d t =

    =-\int_0^\infty {\mu_0 Q_m a^2 {\d z\over \d t} \over 2} \left(
        {1 \over (a^2+(z(t)-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(z(t)+d)^2)^{3\over2}}
        \right)
        \d t =

    =-\int_0^\infty {\mu_0 Q_m a^2 \over 2} \left(
        {1 \over (a^2+(z-d)^2)^{3\over2}}
        -
        {1 \over (a^2+(z+d)^2)^{3\over2}}
        \right)
        \d z =

    =- {\mu_0 Q_m a^2 \over 2} \left(
        \int_0^\infty{1 \over (a^2+(z-d)^2)^{3\over2}} \d z
        -
        \int_0^\infty{1 \over (a^2+(z+d)^2)^{3\over2}} \d z
        \right) =

    =- {\mu_0 Q_m a^2 \over 2} \left(
        {1\over a^2}\left(1 + {d\over\sqrt{a^2 + d^2}}\right)
        -
        {1\over a^2}\left(1 - {d\over\sqrt{a^2 + d^2}}\right)
        \right) =

    =- {\mu_0 Q_m d\over\sqrt{a^2 + d^2}}"/></p>
</div><p>Note that in the limit <img class="math" src="../../_images/math/258d69274d1c8011c09877627e3a0d3a12bc2f8f.png" alt="d\to 0"/>, we get the magnetic moment <img class="math" src="../../_images/math/5d945a7776780932a3d6adfa923b90b386edfa8a.png" alt="m = 2 d Q_m"/> and
the last formula for two monopoles flux becomes the dipole flux.</p>
<p>As a particular example, consider a coil with <img class="math" src="../../_images/math/1136e6caef621b12b6be59c7780c2e502f233388.png" alt="N=500"/> loops, <img class="math" src="../../_images/math/8eb716085d5d94204dd2c5d572fe5b2c0efba219.png" alt="a=1.4\rm\,cm"/>,
<img class="math" src="../../_images/math/81dc0f9768b3ab375a74590a508e85d78fbbeb8d.png" alt="d=1.8\rm\,cm"/>, <img class="math" src="../../_images/math/0c3cd9ca5b063ddc1fe5b5dda245a893c9ae85e0.png" alt="Q_m=43\rm\,A\cdot m"/>. Then the total flux from the second peak
is:</p>
<div class="math">
<p><img src="../../_images/math/537ed4183ef39bf2cf0b6c5ca3d300c719633235.png" alt="\Phi =- {N\mu_0 Q_m d\over\sqrt{a^2 + d^2}} = -0.021 \rm\, V\cdot s"/></p>
</div><p>Code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu0</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e-7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q_m</span> <span class="o">=</span> <span class="mf">43.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">1.4</span><span class="o">*</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="n">N</span><span class="o">*</span><span class="n">mu0</span><span class="o">*</span><span class="n">Q_m</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-0.02132647889395681</span>
</pre></div>
</div>
<p>For a single loop with <img class="math" src="../../_images/math/96b5908f0898b416234d0fe08611128d59f6b3d4.png" alt="a=1.25\rm\,cm"/> we get:</p>
<div class="math">
<p><img src="../../_images/math/ff2add9fac80565ff89d38c5564aabb1192782b2.png" alt="\Phi =- {\mu_0 Q_m d\over\sqrt{a^2 + d^2}} = -4.44\times 10^{-5}
    \rm\, V\cdot s"/></p>
</div><p>and for a single loop with <img class="math" src="../../_images/math/140abc4c119c6a957a4962cfb1a832757905a80a.png" alt="a=1.8\rm\,cm"/> we get:</p>
<div class="math">
<p><img src="../../_images/math/d3050c265bb3857a7883c5aab71839c8fa2ee5ac.png" alt="\Phi =- {\mu_0 Q_m d\over\sqrt{a^2 + d^2}} = -3.82\times 10^{-5}
    \rm\, V\cdot s"/></p>
</div><p>Code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">1.25</span><span class="o">*</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="n">mu0</span><span class="o">*</span><span class="n">Q_m</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-4.438304942066266e-05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="n">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="n">mu0</span><span class="o">*</span><span class="n">Q_m</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">d</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-3.820879326816195e-05</span>
</pre></div>
</div>
</div>
<div class="section" id="rc-circuit">
<h3>RC Circuit<a class="headerlink" href="#rc-circuit" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s consider resistor (with voltage <img class="math" src="../../_images/math/e8d487234c1cf44f48923a7afdf4cfa5a70d855d.png" alt="V=RI"/>) and capacitor (with voltage
<img class="math" src="../../_images/math/6b5fab197372fdc0a0c31b198aed5cc9a7da2466.png" alt="V={Q\over C}"/> and current <img class="math" src="../../_images/math/23b63f5ee955a2879418676cd79c9989b4907b68.png" alt="I(t) = Q'(t)"/>) in a series. Voltage on the battery
is <img class="math" src="../../_images/math/12d58aa29201da09d8e620f8698e3a37547f6b4a.png" alt="V"/>, then the equation for the circuit is:</p>
<div class="math">
<p><img src="../../_images/math/fb44a92c686cd5d4a1e68a175109a3cd7e5f7a30.png" alt="RI(t) + {Q(t)\over C} = V"/></p>
</div><p>with initial condition <img class="math" src="../../_images/math/ea24a4cacc8ebd47f5e8e47a80c1aa0640695cbe.png" alt="Q(0) = 0"/>. We differentiate it:</p>
<div class="math">
<p><img src="../../_images/math/aaa869a040a2854d7328874e9b8c0fc723270205.png" alt="RI'(t) + {I(t)\over C} = 0"/></p>
</div><p>and the initial condition follows from the first equation <img class="math" src="../../_images/math/6de64f1e7287d225f3be2cab75b71479b57abe38.png" alt="I(0) = {V\over R}"/>.
The solution is:</p>
<div class="math">
<p><img src="../../_images/math/9ea1d4c51549f5c00c57a7884689ceb7831014b3.png" alt="I(t) = {V\over R} e^{-{t\over RC}}"/></p>
</div><p>Now we calculate the charge (using the initial condition for the charge above
for the lower bound of the integral):</p>
<div class="math">
<p><img src="../../_images/math/0b6ebfebdf4c440c867662a9e935cb23ec07aae9.png" alt="Q(t) = \int_0^t I(t') \d t'
     = {V\over R} \int_0^t e^{-{t'\over RC}} \d t'
     = {V\over R} \left[-RC e^{-{t'\over RC}}\right]_0^t =

     = {V\over R} \left[-RC e^{-{t\over RC}}+RC\right]
     = VC \left(1-e^{-{t\over RC}}\right)"/></p>
</div><p>The voltage on the resistor is:</p>
<div class="math">
<p><img src="../../_images/math/f67ccb34170ac50574905724cbf64b0b56da7072.png" alt="R I(t) = R {V\over R} e^{-{t\over RC}} = V e^{-{t\over RC}}"/></p>
</div><p>The voltage on the capacitor is:</p>
<div class="math">
<p><img src="../../_images/math/ad28ff1fef00529d02427e0239012edba67b1b4d.png" alt="{Q(t)\over C} = {VC \left(1-e^{-{t\over RC}}\right) \over C}
    = V \left(1-e^{-{t\over RC}}\right)"/></p>
</div><p>Half life of the capacitor is defined as the time <img class="math" src="../../_images/math/1dc1c0119a604b91be9142370dc3159b6a9bbcb9.png" alt="\tau"/> so that the charge is
half of the total charge, and we get:</p>
<div class="math">
<p><img src="../../_images/math/65b5f9d9e0ce6b84c93a4759375e9b7d0ec697bb.png" alt="Q(\tau) = \half Q(\infty)

VC \left(1-e^{-{\tau\over RC}}\right) = \half VC

1-e^{-{\tau\over RC}} = \half

\half = e^{-{\tau\over RC}}

\log \half = -{\tau\over RC}

\tau = -RC \log \half = RC\log 2"/></p>
</div></div>
</div>
</div>
<div class="section" id="semiconductor-device-physics">
<h1>Semiconductor Device Physics<a class="headerlink" href="#semiconductor-device-physics" title="Permalink to this headline">¶</a></h1>
<p>In general, the task is to find the five quantities:</p>
<div class="math">
<p><img src="../../_images/math/4a2a14fb18c033eb3f812aa74f9da4d577e28b2b.png" alt="n({\bf x}, t),
p({\bf x}, t),
{\bf J}_n({\bf x}, t),
{\bf J}_h({\bf x}, t),
{\bf E}({\bf x}, t)"/></p>
</div><p>where <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/> (<img class="math" src="../../_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/>) is the electron (hole) concentration, <img class="math" src="../../_images/math/dfc37721ca1fb86dfad01ec9bfeb15e12d266af3.png" alt="{\bf J}_n"/>
(<img class="math" src="../../_images/math/b3605fb0c264d6cd98414a4dc452ba67f5fabe99.png" alt="{\bf J}_p"/>) is the electron (hole) current density, <img class="math" src="../../_images/math/99ee03f3854092e4a9bc48ff28bab3ffcb9d66b7.png" alt="{\bf E}"/> is the
electric field.</p>
<p>And we have five equations that relate them. We start with the continuity
equation:</p>
<div class="math">
<p><img src="../../_images/math/043883a5e84b7cb6121bb93e01ac48a8d1981e19.png" alt="\nabla\cdot{\bf J} +{\partial\rho\over\partial t} = 0"/></p>
</div><p>where the current density <img class="math" src="../../_images/math/acf8b78bcf615f4ed1ad4e04d91f077d86a0d1e9.png" alt="{\bf J}"/> is composed of electron and hole current
densities:</p>
<div class="math">
<p><img src="../../_images/math/fd3be05579e25e099d6b937fc5a3d84560d8ee99.png" alt="{\bf J} = {\bf J}_n + {\bf J}_p"/></p>
</div><p>and the charge density <img class="math" src="../../_images/math/0027034d8a10372a06deaf4f4084c01956587479.png" alt="\rho"/> is composed of mobile (electrons and holes) and
fixed charges (ionized donors and acceptors):</p>
<div class="math">
<p><img src="../../_images/math/6e6c38348e4e2e95cfeaaa29821aa621d66a3907.png" alt="\rho = q(p-n+C)"/></p>
</div><p>where <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/> and <img class="math" src="../../_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/> is the electron and hole concetration, <img class="math" src="../../_images/math/c3355896da590fc491a10150a50416687626d7cc.png" alt="C"/> is the net
doping concetration (<img class="math" src="../../_images/math/5e5447c335fa16346a5fb496607d88336062c45a.png" alt="C=p_D-n_A"/> where <img class="math" src="../../_images/math/8a54a97daf520a4f07f878c4703ecb0f8a4cb730.png" alt="p_D"/> is the concentration of ionized
donors, charged positive, and <img class="math" src="../../_images/math/2fdb780be66bfbfb3082563bb7e174790920da0e.png" alt="n_A"/> is the concentration of ionized acceptors,
charged negative) and <img class="math" src="../../_images/math/0615acc3725de21025457e7d6f7694dab8e2f758.png" alt="q"/> is the electron charge (positive). We get:</p>
<div class="math">
<p><img src="../../_images/math/bdde760f1ccc7e548dac124f605b29d45cded885.png" alt="\nabla\cdot{\bf J}_n + \nabla\cdot{\bf J}_p + q\left(
    {\partial p\over\partial t}
    -{\partial n\over\partial t}
    +{\partial C\over\partial t}
    \right) = 0"/></p>
</div><p>Assuming the fixed charges <img class="math" src="../../_images/math/c3355896da590fc491a10150a50416687626d7cc.png" alt="C"/> are time invariant, we get:</p>
<div class="math">
<p><img src="../../_images/math/5a56e0a0c20a4e9fb7ab2017d04c8b7fafaf0830.png" alt="\nabla\cdot{\bf J}_n - q {\partial n\over\partial t} =
    -\left( \nabla\cdot{\bf J}_p + q{\partial p\over\partial t}
    \right) \equiv qR"/></p>
</div><p>where <img class="math" src="../../_images/math/eff43e84f8a3bcf7b6965f0a3248bc4d3a9d0cd4.png" alt="R"/> is the net recombination rate for electrons and holes (a positive
value means recombination, a negative value generation of carriers). We get the
carrier continuity equations:</p>
<div class="math" id="equation-continuity">
<p><span class="eqno">(8)</span><img src="../../_images/math/f553859214c7ec09ce9847bc163cd1e124820db6.png" alt="{\partial n\over\partial t} = -R + {1\over q} \nabla\cdot {\bf J}_n

{\partial p\over\partial t} = -R - {1\over q} \nabla\cdot {\bf J}_p"/></p>
</div><p>Then we need material relations that express how the current <img class="math" src="../../_images/math/acf8b78bcf615f4ed1ad4e04d91f077d86a0d1e9.png" alt="{\bf J}"/> is
generated using <img class="math" src="../../_images/math/99ee03f3854092e4a9bc48ff28bab3ffcb9d66b7.png" alt="{\bf E}"/> and <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/> and <img class="math" src="../../_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/>. A drift-diffusion model is to assume
a drift current (<img class="math" src="../../_images/math/c100f968ad3c74575dfc8b204a4938bec1d479c1.png" alt="q\mu_n n {\bf E}"/>) and a diffusion (<img class="math" src="../../_images/math/a956eceaad82dd620cffae9fe68fad353f4cb0bb.png" alt="q D_n \nabla n"/>),
which gives:</p>
<div class="math" id="equation-drift">
<p><span class="eqno">(9)</span><img src="../../_images/math/3f1097a5331fe909142714459235ff054a0d38aa.png" alt="{\bf J}_n = q\mu_n n {\bf E} + q D_n \nabla n

{\bf J}_p = q\mu_p p {\bf E} - q D_p \nabla p"/></p>
</div><p>where <img class="math" src="../../_images/math/70edeef563162fc6212acb107a10dc7d81e7a99f.png" alt="\mu_n"/>, <img class="math" src="../../_images/math/cd3a37106c43d8f0931ee8a4da3f0aa455492221.png" alt="\mu_p"/>, <img class="math" src="../../_images/math/2eacbcb991af87d495f8689ac0e952b51317dbaa.png" alt="D_n"/>, <img class="math" src="../../_images/math/9fd0e5c87aa97864dbc938e52116649e1eef006a.png" alt="D_p"/> are the carrier mobilities and
diffusivities.</p>
<p>Final equation is the Gauss&#8217;s law:</p>
<div class="math">
<p><img src="../../_images/math/7d99fddf9ea6d5b1473e223bda36515ef7456e2d.png" alt="\nabla\cdot (\varepsilon{\bf E}) = \rho"/></p>
</div><div class="math" id="equation-gauss">
<p><span class="eqno">(10)</span><img src="../../_images/math/04adf9877fe301cf89fd671262ed40ec3a97765e.png" alt="\nabla\cdot(\varepsilon {\bf E}) = q(p-n + C)"/></p>
</div><div class="section" id="equations">
<h2>Equations<a class="headerlink" href="#equations" title="Permalink to this headline">¶</a></h2>
<p>Combining <a href="#equation-drift">(9)</a> and <a href="#equation-continuity">(8)</a> we get the following three
equations for three unknowns <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>, <img class="math" src="../../_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/> and <img class="math" src="../../_images/math/99ee03f3854092e4a9bc48ff28bab3ffcb9d66b7.png" alt="{\bf E}"/>:</p>
<div class="math">
<p><img src="../../_images/math/79f5ec3a2fbed650c1648b344f5e59a1310275ba.png" alt="{\partial n\over\partial t} = -R + \nabla\cdot (\mu_n n {\bf E})
    +\nabla\cdot (D_n \nabla n)

{\partial p\over\partial t} = -R - \nabla\cdot (\mu_p p {\bf E})
    +\nabla\cdot (D_p \nabla p)

\nabla\cdot(\varepsilon {\bf E}) = q(p-n + C)"/></p>
</div><p>And it is usually assumed that the magnetic field is time independent, so
<img class="math" src="../../_images/math/900a8e6f92c82b3ba02a3e6dfb65fe8ac9b7a168.png" alt="{\bf E}=-\nabla\phi"/> and we get:</p>
<div class="math" id="equation-semicond-eq">
<p><span class="eqno">(11)</span><img src="../../_images/math/caebfdf789e84cce77efdce81cf5e84789203e82.png" alt="{\partial n\over\partial t} = -R - \nabla\cdot (\mu_n n \nabla\phi)
    +\nabla\cdot (D_n \nabla n)

{\partial p\over\partial t} = -R + \nabla\cdot (\mu_p p \nabla\phi)
    +\nabla\cdot (D_p \nabla p)

\nabla\cdot(\varepsilon \nabla\phi) = -q(p-n + C)"/></p>
</div><p>These are three nonlinear (due to the terms <img class="math" src="../../_images/math/cf35b4253f77e68e286f0a6da51ba85974aeed4f.png" alt="\mu_n n \nabla\phi"/> and
<img class="math" src="../../_images/math/ff21d082f8aa611fc6a394d8c67fe38615a54db0.png" alt="\mu_p p \nabla\phi"/>) equations for three unknown functions <img class="math" src="../../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>, <img class="math" src="../../_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/> and <img class="math" src="../../_images/math/2c175f60eecef1de7560c3bdea495d69f26f719d.png" alt="\phi"/>.</p>
<div class="section" id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h3>
<p>We can substract the first two
equations and we get:</p>
<div class="math">
<p><img src="../../_images/math/bb54c0cae1dbe20f6510efc7ffcdbc7feaf3c8ec.png" alt="{\partial q(p-n)\over\partial t} = - q\nabla\cdot ((\mu_p p+\mu_n n){\bf E})
    +q\nabla\cdot(D_p \nabla p-D_n\nabla n)

\nabla\cdot(\varepsilon {\bf E}) = q(p-n+C)"/></p>
</div><p>and using <img class="math" src="../../_images/math/bdb3d7983385b6d0bb7de3a53f1be6c9db64c73a.png" alt="\rho=q(p-n+C)"/> and <img class="math" src="../../_images/math/de40a452ae427196077aa82b86b388ac6182cda6.png" alt="\sigma=q(\mu_p p+\mu_n n)"/>, we get:</p>
<div class="math">
<p><img src="../../_images/math/21afe86505b0a7e7cfd8bd05102000857d6404ed.png" alt="{\partial \rho\over\partial t} -q{\partial C\over\partial t} =
    - \nabla\cdot (\sigma {\bf E})
    +q\nabla\cdot(D_p \nabla p-D_n\nabla n)

\nabla\cdot(\varepsilon {\bf E}) = \rho"/></p>
</div><p>So far we didn&#8217;t make any assumptions. Most of the times the net doping
concetration <img class="math" src="../../_images/math/c3355896da590fc491a10150a50416687626d7cc.png" alt="C"/> is time independent, which gives:</p>
<div class="math">
<p><img src="../../_images/math/35032595db7b7722b15bd8b5d3f319debd7feb05.png" alt="{\partial \rho\over\partial t} =
    - \nabla\cdot (\sigma {\bf E})
    +q\nabla\cdot(D_p \nabla p-D_n\nabla n)

\nabla\cdot(\varepsilon {\bf E}) = \rho"/></p>
</div><p>Assuming further <img class="math" src="../../_images/math/0f90d98d377b5e285fedad96ee50b7e2a1d9d140.png" alt="D_p \nabla p-D_n\nabla n=0"/>, we just get the equation of
continuity and the Gauss law:</p>
<div class="math">
<p><img src="../../_images/math/da6a1966e9134ec6ac3645418e15fb286ecff013.png" alt="{\partial \rho\over\partial t} + \nabla\cdot (\sigma {\bf E}) = 0

\nabla\cdot(\varepsilon {\bf E}) = \rho"/></p>
</div><p>Finally, assuming also that that <img class="math" src="../../_images/math/0027034d8a10372a06deaf4f4084c01956587479.png" alt="\rho"/> doesn&#8217;t depend on
time, we get:</p>
<div class="math">
<p><img src="../../_images/math/5ac1475ee968fb530657169d2bf82a4031b5f8cb.png" alt="\nabla\cdot (\sigma {\bf E}) = 0

\nabla\cdot(\varepsilon {\bf E}) = \rho"/></p>
</div></div>
<div class="section" id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h3>
<p>As a simple model, assume <img class="math" src="../../_images/math/2eacbcb991af87d495f8689ac0e952b51317dbaa.png" alt="D_n"/>, <img class="math" src="../../_images/math/9fd0e5c87aa97864dbc938e52116649e1eef006a.png" alt="D_p"/>, <img class="math" src="../../_images/math/70edeef563162fc6212acb107a10dc7d81e7a99f.png" alt="\mu_n"/>, <img class="math" src="../../_images/math/cd3a37106c43d8f0931ee8a4da3f0aa455492221.png" alt="\mu_p"/> and <img class="math" src="../../_images/math/e2a63918a6fa75b62ad87ad17aaf65f782d71546.png" alt="\varepsilon"/>
are position independent and <img class="math" src="../../_images/math/7296755ef63523ef0ed2e997caae100445bbb44d.png" alt="C=0"/>, <img class="math" src="../../_images/math/7cabdac25e931867e38c2efc2e553e258984119e.png" alt="R=0"/>:</p>
<div class="math">
<p><img src="../../_images/math/62097ba5588b27d61ad5db1b364c1acf6f6185bc.png" alt="{\partial n\over\partial t} =
    +\mu_n n \nabla\cdot {\bf E}
    +\mu_n {\bf E}\cdot\nabla n
    +D_n \nabla^2 n

{\partial p\over\partial t} =
    -\mu_p p \nabla\cdot {\bf E}
    -\mu_p {\bf E}\cdot\nabla p
    +D_p \nabla^2 p

\varepsilon\nabla\cdot {\bf E} = q(p-n)"/></p>
</div><p>Using <img class="math" src="../../_images/math/7e40335fd1d57c16b5b03cceec53d04825cafacf.png" alt="{\bf E} = -\nabla \phi"/> we get:</p>
<div class="math">
<p><img src="../../_images/math/ec7487fa252d96f1d3ee9e1b1838f5b0fd5c4ca6.png" alt="{\partial n\over\partial t} =
    -\mu_n n \nabla^2\phi
    -\mu_n \nabla\phi\cdot\nabla n
    +D_n \nabla^2 n

{\partial p\over\partial t} =
    +\mu_p p \nabla^2\phi
    +\mu_p \nabla\phi\cdot\nabla p
    +D_p \nabla^2 p

\varepsilon\nabla^2\phi = -q(p-n)"/></p>
</div></div>
</div>
<div class="section" id="example-3">
<h2>Example 3<a class="headerlink" href="#example-3" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s calculate the 1D pn-junction. We take the equations <a href="#equation-semicond-eq">(11)</a> and
write them in 1D for the stationary state
(<img class="math" src="../../_images/math/01fb20e91338e18e41884c6365666e1b9eed23e7.png" alt="{\partial n\over\partial t}={\partial p\over\partial t}=0"/>):</p>
<div class="math">
<p><img src="../../_images/math/1c7401a9f7f41c6c74aed210b4da39f09eec7b37.png" alt="0 = -R - (\mu_n n \phi')' + (D_n n')'

0 = -R + (\mu_p p \phi')' + (D_p p')'

(\varepsilon \phi')' = -q(p-n + C)"/></p>
</div><p>We expand the derivatives and assume that <img class="math" src="../../_images/math/2d8c833ed800824727cd7bd2fb9de1a12ad7e674.png" alt="\mu"/> and <img class="math" src="../../_images/math/9ffb448918db29f2a72f8f87f421b3b3cad18f95.png" alt="D"/> is constant:</p>
<div class="math">
<p><img src="../../_images/math/cd1af55f23ef326c373e458f7a2d1c7f5b613c8b.png" alt="0 = -R - \mu_n n' \phi' - \mu_n n \phi'' + D_n n''

0 = -R + \mu_p p' \phi' + \mu_p p \phi'' + D_p p''

\varepsilon \phi'' = -q(p-n + C)"/></p>
</div><p>and we put the second derivatives on the left hand side:</p>
<div class="math" id="equation-1d-pn-junction1">
<p><span class="eqno">(12)</span><img src="../../_images/math/f8b3de3f823ddae2eec96d5281aeabfff158072c.png" alt="n'' = {1\over D_n}(R + \mu_n n' \phi' + \mu_n n \phi'')

p'' = {1\over D_p}(R - \mu_p p' \phi' - \mu_p p \phi'')

\phi'' = -{q\over\varepsilon} (p-n + C)"/></p>
</div><p>now we introduce the variables <img class="math" src="../../_images/math/6e6ceb79ebc4bf613298e0144eae25dd73de9be3.png" alt="y_i"/>:</p>
<div class="math">
<p><img src="../../_images/math/b45151181b8435ad255f5a209689982b72c1ef25.png" alt="y_0 = n

y_1 = y_0' = n'

y_2 = p

y_3 = y_2' = p'

y_4 = \phi

y_5 = y_4' = \phi'"/></p>
</div><p>and rewrite <a href="#equation-1d-pn-junction1">(12)</a>:</p>
<div class="math">
<p><img src="../../_images/math/2c0a205242211d42cb2f44f70f096c1de77675bd.png" alt="y_1' = {1\over D_n}(R + \mu_n y_1 y_5 + \mu_n y_0 y_5')

y_3' = {1\over D_p}(R - \mu_p y_3 y_5 - \mu_p y_2 y_5')

y_5' = -{q\over\varepsilon} (y_2-y_0 + C)"/></p>
</div><p>So we are solving the following six nonlinear first order ODE:</p>
<div class="math" id="equation-1d-pn-junction2">
<p><span class="eqno">(13)</span><img src="../../_images/math/1b0d188519ab2653ba098bd4970e7dbb88cf6c0b.png" alt="y_5' = -{q\over\varepsilon} (y_2-y_0 + C)

y_0' = y_1

y_1' = {1\over D_n}(R + \mu_n y_1 y_5 + \mu_n y_0 y_5')

y_2' = y_3

y_3' = {1\over D_p}(R - \mu_p y_3 y_5 - \mu_p y_2 y_5')

y_4' = y_5"/></p>
</div></div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Maxwell&#8217;s Equations</a><ul>
<li><a class="reference internal" href="#electromagnetic-field">Electromagnetic Field</a></li>
<li><a class="reference internal" href="#id1">Maxwell&#8217;s Equations</a></li>
<li><a class="reference internal" href="#lorentz-force">Lorentz Force</a></li>
<li><a class="reference internal" href="#hamiltonian">Hamiltonian</a></li>
<li><a class="reference internal" href="#electromagnetic-stress-tensor">Electromagnetic Stress Tensor</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#biot-savart-law">Biot-Savart Law</a><ul>
<li><a class="reference internal" href="#example-straight-wire">Example: Straight Wire</a></li>
<li><a class="reference internal" href="#example-circular-loop">Example: Circular Loop</a></li>
<li><a class="reference internal" href="#helmholtz-coil">Helmholtz Coil</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ampere-s-force-law">Ampère&#8217;s Force Law</a><ul>
<li><a class="reference internal" href="#parallel-straight-wires">Parallel Straight Wires</a></li>
<li><a class="reference internal" href="#perpendicular-straight-wires">Perpendicular Straight Wires</a></li>
<li><a class="reference internal" href="#infinitely-long-wire-and-a-square-loop">Infinitely Long Wire and a Square Loop</a></li>
</ul>
</li>
<li><a class="reference internal" href="#magnetic-dipole">Magnetic Dipole</a></li>
<li><a class="reference internal" href="#bar-magnet">Bar Magnet</a></li>
<li><a class="reference internal" href="#bar-magnet-in-a-coil">Bar Magnet in a Coil</a></li>
<li><a class="reference internal" href="#rc-circuit">RC Circuit</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#semiconductor-device-physics">Semiconductor Device Physics</a><ul>
<li><a class="reference internal" href="#equations">Equations</a><ul>
<li><a class="reference internal" href="#example-1">Example 1</a></li>
<li><a class="reference internal" href="#example-2">Example 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-3">Example 3</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="main.html"
                        title="previous chapter">Classical Electromagnetism</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../fluid-dynamics/main.html"
                        title="next chapter">Fluid Dynamics</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/src/elmag/elmag.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../fluid-dynamics/main.html" title="Fluid Dynamics"
             >next</a> |</li>
        <li class="right" >
          <a href="main.html" title="Classical Electromagnetism"
             >previous</a> |</li>
        <li><a href="../../index.html">Theoretical Physics Reference 0.5 documentation</a> &raquo;</li>
          <li><a href="main.html" >Classical Electromagnetism</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2011, Ondřej Čertík.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.
    </div>
  </body>
</html>